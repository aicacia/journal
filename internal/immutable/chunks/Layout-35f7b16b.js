import{S as Pt,i as xt,s as Ut,I as pe,P as Rt,e as ie,Q as kt,n as st,h as X,p as K,b as pt,M as et,J as me,K as ge,L as ye,f as ct,t as ht,r as At,u as St,v as ve,R as Bt,l as ut,m as lt,E as Et,o as Re,a as Ot,w as gt,c as Mt,x as yt,y as vt,g as te,d as ee,B as _t,U as _e,H as ke,C as bt,z as Jt,A as Gt,O as Ct,W as It,T as Ie,a8 as Oe,ah as Me,ai as Ce,aj as Ne,a1 as je,ak as Ue,al as De,am as Fe}from"./index-ae548d5b.js";import{w as be,d as Le,_ as Be,b as Xt}from"./preload-helper-4d4452b3.js";function ae(E){let t,i;return{c(){t=Rt("title"),i=At(E[0])},l(u){t=kt(u,"title",{});var d=st(t);i=St(d,E[0]),d.forEach(X)},m(u,d){pt(u,t,d),et(t,i)},p(u,d){d&1&&ve(i,u[0])},d(u){u&&X(t)}}}function $e(E){let t,i,u,d=E[0]&&ae(E);const l=E[3].default,g=pe(l,E,E[2],null);return{c(){t=Rt("svg"),d&&d.c(),i=ie(),g&&g.c(),this.h()},l(y){t=kt(y,"svg",{xmlns:!0,viewBox:!0,class:!0});var b=st(t);d&&d.l(b),i=ie(),g&&g.l(b),b.forEach(X),this.h()},h(){K(t,"xmlns","http://www.w3.org/2000/svg"),K(t,"viewBox",E[1]),K(t,"class","svelte-c8tyih")},m(y,b){pt(y,t,b),d&&d.m(t,null),et(t,i),g&&g.m(t,null),u=!0},p(y,[b]){y[0]?d?d.p(y,b):(d=ae(y),d.c(),d.m(t,i)):d&&(d.d(1),d=null),g&&g.p&&(!u||b&4)&&me(g,l,y,y[2],u?ye(l,y[2],b,null):ge(y[2]),null),(!u||b&2)&&K(t,"viewBox",y[1])},i(y){u||(ct(g,y),u=!0)},o(y){ht(g,y),u=!1},d(y){y&&X(t),d&&d.d(),g&&g.d(y)}}}function qe(E,t,i){let{$$slots:u={},$$scope:d}=t,{title:l=null}=t,{viewBox:g}=t;return E.$$set=y=>{"title"in y&&i(0,l=y.title),"viewBox"in y&&i(1,g=y.viewBox),"$$scope"in y&&i(2,d=y.$$scope)},[l,g,d,u]}class Vt extends Pt{constructor(t){super(),xt(this,t,qe,$e,Ut,{title:0,viewBox:1})}}function we(E,t){return E[0]=(t&4278190080)>>24,E[1]=(t&16711680)>>16,E[2]=(t&65280)>>8,E[3]=t&255,E}const ue=new Uint8Array(1),Je=new Uint8Array(4),le=new Float32Array(1);class Ge{writeByte(t){return ue[0]=t,this.write(ue)}writeInteger(t){return this.write(we(Je,t))}writeFloat(t){return le[0]=t,this.write(new Uint8Array(le.buffer))}}function Ve(E){return E>>>1&1073741824|E&3221225471}class Ye extends Ge{constructor(){super(...arguments),this.hash=0}finish(){return this.hash}write(t){let i=this.hash;for(let u=0,d=t.length;u<d;u++)i=31*i+t[u];return this.hash=Ve(i),this}}function ze(){return new Ye}const Zt=new Set;function He(E,t=ze){return We(E,t()).finish()}function We(E,t){return Yt(E,t),Zt.clear(),t}function Yt(E,t){return E!=null&&(typeof E=="string"?Lt(E,t):typeof E=="number"?$t(E,t):typeof E=="boolean"?Ke(E,t):typeof E=="symbol"?Xe(E,t):typeof E[Symbol.iterator]=="function"?Qe(E,t):typeof E=="function"?Ze(E,t):typeof E.length=="number"?tr(E,t):re(E,t)),t}function Lt(E,t){for(const i of E)t.writeInteger(i.charCodeAt(0))}function $t(E,t){E%1===0?t.writeInteger(E):t.writeFloat(E)}function Ke(E,t){t.writeInteger(E===!0?1:0)}function Xe(E,t){Lt(E.toString(),t)}function Qe(E,t){let i=0;for(const u of E)Yt(u,t),i++;$t(i,t)}function Ze(E,t){E.prototype!==null&&typeof E.prototype=="object"&&re(E.prototype,t),Lt(E.name,t),$t(E.length,t),Lt(E.toString(),t)}function tr(E,t){const i=Object.getPrototypeOf(E);i!==null&&typeof i=="object"&&typeof i.constructor=="function"&&re(i.constructor,t);for(let u=0,d=E.length;u<d;u++)Yt(E[u],t);$t(E.length,t)}function re(E,t){if(!Zt.has(E)){Zt.add(E);let i=0;for(const[u,d]of Object.entries(E))Lt(u,t),Yt(d,t),i++;$t(i,t)}}const Nt=Math.pow(2,31)-1|0,ne={},jt={};class zt{constructor(t,i){if(t!==ne)throw new TypeError("Options can only be created with the some or none functions");this._value=i}static some(t){return dt(t)}static none(){return ft()}static from(t){return t!=null?dt(t):ft()}static fromJSON(t){return zt.from(t)}isNone(){return this._value===jt}isSome(){return!this.isNone()}expect(t){if(this.isSome())return this._value;throw new Error(typeof t=="function"?t():t)}unwrap(){return this.expect("Tried to unwrap value of none Option")}unwrapOr(t){return this.isSome()?this._value:t}unwrapOrElse(t){return this.isSome()?this._value:t()}map(t){return this.isSome()?dt(t(this._value)):ft()}mapOr(t,i){return this.isSome()?dt(t(this._value)):dt(i)}mapOrElse(t,i){return this.isSome()?dt(t(this._value)):dt(i())}flatMap(t){return this.isSome()?t(this._value):ft()}flatMapOr(t,i){return this.isSome()?t(this._value):i}flatMapOrElse(t,i){return this.isSome()?t(this._value):i()}and(t){return this.isSome()?t:ft()}andThen(t){return this.isSome()?t(this._value):ft()}or(t){return this.isNone()?t:this}orElse(t){return this.isNone()?t():this}xor(t){const i=this.isSome(),u=t.isSome();return i&&!u?this:!i&&u?t:ft()}filter(t){return this.isSome()&&t(this._value)?this:ft()}getOrInsert(t){return this.isNone()&&(this._value=t),this}getOrInsertWith(t){return this.isNone()&&(this._value=t()),this}clear(){return this._value=jt,this}take(){if(this.isSome()){const t=this._value;return this._value=jt,dt(t)}else return ft()}from(t){return t!=null?this._value=t:this.clear(),this}replace(t){return this._value=t,this}ifSome(t,i){return this.isSome()?t(this._value):i&&i(),this}ifNone(t,i){return this.isNone()?t():i&&i(this._value),this}toJSON(){return this.unwrapOr(null)}toJS(){return this.unwrapOr(null)}[Symbol.iterator](){return new er(this._value)}}class er{constructor(t){this.value=t}next(){if(this.value===jt)return{done:!0,value:void 0};{const t=this.value;return this.value=jt,{done:!1,value:t}}}}const dt=E=>new zt(ne,E),ft=()=>new zt(ne,jt);class rt{constructor(t){this._index=0,this._iter=t}[Symbol.iterator](){return this}iter(){return this}next(){return this._iter.next()}nextWithIndex(){const t=this._iter.next();return t.done?t:{value:[t.value,this._index++]}}enumerate(){throw new Error("iter/Enumerate was not imported!")}peekable(){throw new Error("iter/Peekable was not imported!")}forEach(t){throw new Error("iter/ForEach was not imported!")}map(t){throw new Error("iter/Map was not imported!")}merge(t){throw new Error("iter/Merge was not imported!")}concat(t){return this.merge(t)}filter(t){throw new Error("iter/Filter was not imported!")}step(t){throw new Error("iter/Step was not imported!")}skip(t){throw new Error("iter/Skip was not imported!")}take(t){throw new Error("iter/Take was not imported!")}toMap(t,i){throw new Error("iter/ToMap was not imported!")}count(){return this.reduce(0,t=>t+1)}consume(){let t=this.next();for(;!t.done;)t=this.next();return this}toArray(){return this.reduce([],(t,i)=>(t.push(i),t))}join(t){return this.toArray().join(t)}indexOf(t){let i=this.next(),u=0;for(;!i.done;){if(i.value===t)return u;u++,i=this.next()}return-1}findIndex(t){let i=this.nextWithIndex();for(;!i.done;){const[u,d]=i.value;if(t(u,d))return d;i=this.nextWithIndex()}return-1}find(t){let i=this.nextWithIndex();for(;!i.done;){const[u,d]=i.value;if(t(u,d))return dt(u);i=this.nextWithIndex()}return ft()}findAll(t){return this.filter(t)}nth(t=0){let i=this.next();for(t<0&&(t=0);!i.done;){if(t--<=0)return dt(i.value);i=this.next()}return ft()}first(){return this.nth(0)}last(){let t=this.next();for(;!t.done;){const i=this.next();if(i.done)return dt(t.value);t=i}return ft()}any(t){return this.findIndex(t)!==-1}some(t){return this.any(t)}none(t){return this.findIndex(t)===-1}all(t){let i=this.nextWithIndex();for(;!i.done;){const[u,d]=i.value;if(!t(u,d))return!1;i=this.nextWithIndex()}return!0}flatten(t){throw new Error("iter/Flatten was not imported!")}unflatten(t){throw new Error("iter/Unflatten was not imported!")}reduce(t,i){let u=this.next();for(;!u.done;){const d=u.value;t=i(t,d,this._index-1),u=this.next()}return t}reverse(){return Ft(this.toArray().reverse())}}function Ft(E){return E!=null?typeof E[Symbol.iterator]=="function"?new rt(E[Symbol.iterator]()):typeof E.next=="function"?E instanceof rt?E:new rt(E):Ft(typeof E=="object"?Object.entries(E):[E]):Ft([])}class rr extends rt{constructor(t){super(t)}next(){const t=super.nextWithIndex();return t.done?t:{value:nr(t.value)}}}rt.prototype.enumerate=function(){return new rr(this)};function nr(E){const t=E[0],i=E;return i[0]=E[1],i[1]=t,i}class or extends rt{constructor(t,i){super(t),this._fn=i}next(){let t=super.nextWithIndex();for(;!t.done;){const[i,u]=t.value;if(this._fn(i,u))return{done:!1,value:i};t=super.nextWithIndex()}return{done:!0,value:void 0}}}rt.prototype.filter=function(t){return new or(this,t)};class sr extends rt{constructor(t,i){super(t),this._fn=([u,d])=>(i(u,d),u)}next(){const t=super.nextWithIndex();return t.done?t:{done:!1,value:this._fn(t.value)}}}rt.prototype.forEach=function(t){return new sr(this,t)};class ir extends rt{constructor(t,i){super(t),this._fn=([u,d])=>i(u,d)}next(){const t=super.nextWithIndex();return t.done?t:{done:!1,value:this._fn(t.value)}}}rt.prototype.map=function(t){return new ir(this,t)};class ar extends rt{constructor(t,i){super(t),this._other=i}next(){const t=super.next();return t.done?this._other.next():t}}rt.prototype.merge=function(t){return new ar(this,t)};class ur extends rt{constructor(){super(...arguments),this.peeked=[]}unpeekAll(){return this.peeked.length=0,this}unpeek(){return this.peeked.length>0?dt(this.peeked.shift()):ft()}peek(t=0){if(t<this.peeked.length)return dt(this.peeked[t]);{let i=this.peeked.length-t-1,u=super.next();for(;!u.done&&(this.peeked.push(u.value),!(--i<=0));)u=super.next();return u.done?ft():dt(u.value)}}next(){const t=this.unpeek();if(t.isSome())return{done:!1,value:t.unwrap()};const i=super.next();return i.done?i:{done:!1,value:i.value}}}rt.prototype.peekable=function(){return new ur(this)};class lr extends rt{constructor(t,i){super(t),this._skipped=0,this._skip=(i<=0?0:i)|0}next(){let t=super.next();for(;!t.done;)if(this._skipped<=this._skip)this._skipped+=1,t=super.next();else return t;return{done:!0,value:void 0}}}rt.prototype.skip=function(E){return new lr(this,E)};class cr extends rt{constructor(t,i){super(t),this._stepped=0,this._step=i<=0?1:i|0}next(){let t=super.next();for(;!t.done;)if(this._stepped<this._step)this._stepped+=1,t=super.next();else return this._stepped=0,t;return{done:!0,value:void 0}}}rt.prototype.step=function(E){return new cr(this,E)};class hr extends rt{constructor(t,i){super(t),this._taken=0,this._count=(i<=0?0:i)|0}next(){return this._taken<this._count?(this._taken+=1,super.next()):{done:!0,value:void 0}}}rt.prototype.take=function(t){return new hr(this,t)};const fr=E=>E,dr=E=>E;class pr extends rt{constructor(t,i=fr,u=dr){super(t),this._map=([d,l])=>[i(d,l),u(d,l)]}toObject(){return this.reduce({},(t,i)=>(t[i[0]]=i[1],t))}next(){const t=super.nextWithIndex();return t.done?t:{done:!1,value:this._map(t.value)}}}rt.prototype.toMap=function(t,i){return new pr(this,t,i)};class mr extends rt{constructor(t,i){super(t),this._fn=i}next(){return this._fn(this._iter)}}rt.prototype.unflatten=function(t){return new mr(this,t)};class gr extends rt{constructor(t,i=1){super(t),this._current=void 0,this._depth=i}next(){if(this._current!==void 0){const t=this._current.next();if(t.done)this._current=void 0;else return t}return this._nextRecur()}_nextRecur(){const t=super.next();if(t.done)return t;if(this._depth>0){const i=Ft(t.value).flatten(this._depth-1),u=i.next();return u.done?this._nextRecur():(this._current=i,u)}else return t}}rt.prototype.flatten=function(t=1){return new gr(this,t)};class yr extends rt{constructor(t){super(t),this.rng=t}iter(){return new rt(this)}next(){return{done:!1,value:this.rng.nextFloat()}}}class vr extends rt{constructor(t,i=0,u=1){super(t),this.rng=t,this.min=i,this.max=u}iter(){return new rt(this)}nextFloat(){return this.rng.nextFloatInRange(this.min,this.max)}next(){return{done:!1,value:this.nextFloat()}}}class _r extends rt{constructor(t,i=0,u=Nt){super(t),this.rng=t,this.min=i|0,this.max=u|0}iter(){return new rt(this)}nextInt(){return this.rng.nextIntInRange(this.min,this.max)}next(){return{done:!1,value:this.nextInt()}}}const br=new Uint8Array(4);class Ee{nextFloat(){return this.nextInt()/Nt}nextFloatInRange(t=0,i=1){return t+this.nextFloat()*(i-t)}nextIntInRange(t=0,i=Nt){return Math.round(this.nextFloatInRange(t,i))}shuffle(t){const i=t.length;for(let u=0;u<i;u++){const d=u+this.nextIntInRange(0,i-u-1),l=t[u];t[u]=t[d],t[d]=l}return t}fromArray(t){return t.length?dt(t[this.nextIntInRange(0,t.length-1)]):ft()}keyFromObject(t){return this.fromArray(Object.keys(t))}valueFromObject(t){return this.fromArray(Object.values(t))}fillBytes(t){const i=br;for(let u=0,d=t.length;u<d;u++){const l=u%4;l===0&&we(i,this.nextInt()),t[u]=i[l]}return t}[Symbol.iterator](){return this}iter(){return new rt(this)}next(){return{done:!1,value:this.nextInt()}}float(){return new yr(this)}uniformFloat(t=0,i=1){return new vr(this,t,i)}uniformInt(t=0,i=Nt){return new _r(this,t,i)}}class Pe extends Ee{constructor(t=423257940){super(),this.seed=t}setSeed(t=423257940){return this.seed=t,this}nextInt(){return this.seed=Math.imul(48271,this.seed)|0%Nt,this.seed&Nt}}const wr=new Pe;class Ht extends Ee{constructor(t,i,u,d){super(),this.x=423257940,this.y=2829571177,this.z=2541948421,this.w=289122235,this.set(t,i,u,d)}static fromSeed(t){return new Ht().setSeed(t)}setSeed(t){const i=wr.setSeed(t);return this.set(i.nextInt(),i.nextInt(),i.nextInt(),i.nextInt())}set(t=423257940,i=2829571177,u=2541948421,d=289122235){return this.x=t|0,this.y=i|0,this.z=u|0,this.w=d|0,this}nextInt(){const t=this.x,i=t^t<<11;this.x=this.y,this.y=this.z,this.z=this.w;const u=this.w;return this.w=u^u>>19^(i^i>>8),this.w}}new Pe;new Ht;function Er(){return Math.random().toString(36).substring(2)}function yn(E){return E.toISOString().substring(0,7)}function vn(E){return new Date(E.getFullYear(),E.getMonth()+1,0).getDate()}function _n(E,t){return t.toLocaleDateString(E,{month:"short",weekday:"short",day:"numeric"})}function bn(E,t){return t.toLocaleDateString(E,{month:"short"})}function wn(E,t){return t.toLocaleDateString(E,{weekday:"short"})}function En(E,t){return E.getFullYear()===t.getFullYear()&&E.getMonth()===t.getMonth()&&E.getDate()===t.getDate()}const qt=new Ht;function Pn(E){return qt.setSeed(He(E)),`rgb(${qt.nextFloatInRange(0,192)}, ${qt.nextFloatInRange(0,192)}, ${qt.nextFloatInRange(0,192)})`}function xn(){return new Promise((E,t)=>navigator.geolocation.getCurrentPosition(i=>E(i.coords),t))}async function Tn(E){const t=await fetch(`https://nominatim.openstreetmap.org/reverse.php?lat=${E.latitude}&lon=${E.longitude}&zoom=18&format=jsonv2`);if(!t.ok)throw new Error(await t.text());return(await t.json()).display_name}function An(E,t){return t.createdAt.getMilliseconds()-E.createdAt.getMilliseconds()}const Pr="lf5maxp3ghh4q1s",xr="220951148444-5u4fja36i0dm85hcvipq6udm9msutf7n.apps.googleusercontent.com";var Tr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ar(E){return E&&E.__esModule&&Object.prototype.hasOwnProperty.call(E,"default")?E.default:E}var xe={exports:{}};/*! remotestorage.js 2.0.0-beta.3, https://remotestorage.io, MIT licensed */(function(E,t){(function(i,u){E.exports=u()})(Tr,function(){return function(i){var u={};function d(l){if(u[l])return u[l].exports;var g=u[l]={i:l,l:!1,exports:{}};return i[l].call(g.exports,g,g.exports,d),g.l=!0,g.exports}return d.m=i,d.c=u,d.d=function(l,g,y){d.o(l,g)||Object.defineProperty(l,g,{enumerable:!0,get:y})},d.r=function(l){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})},d.t=function(l,g){if(1&g&&(l=d(l)),8&g||4&g&&typeof l=="object"&&l&&l.__esModule)return l;var y=Object.create(null);if(d.r(y),Object.defineProperty(y,"default",{enumerable:!0,value:l}),2&g&&typeof l!="string")for(var b in l)d.d(y,b,function(A){return l[A]}.bind(null,b));return y},d.n=function(l){var g=l&&l.__esModule?function(){return l.default}:function(){return l};return d.d(g,"a",g),g},d.o=function(l,g){return Object.prototype.hasOwnProperty.call(l,g)},d.p="",d(d.s=17)}([function(i,u,d){(function(l,g){Object.defineProperty(u,"__esModule",{value:!0}),u.applyMixins=u.toBase64=u.getTextFromArrayBuffer=u.shouldBeTreatedAsBinary=u.getJSONFromLocalStorage=u.localStorageAvailable=u.pathsFromRoot=u.deepClone=u.equal=u.bindAll=u.cleanPath=u.baseName=u.isDocument=u.isFolder=u.containingFolder=u.extend=u.getGlobalContext=u.globalContext=u.logError=void 0,u.logError=y=>{typeof y=="string"?console.error(y):console.error(y.message,y.stack)},u.globalContext=typeof window<"u"?window:typeof self=="object"?self:l,u.getGlobalContext=()=>typeof window<"u"?window:typeof self=="object"?self:l,u.extend=(...y)=>{const b=y[0];return Array.prototype.slice.call(y,1).forEach(function(A){for(const P in A)b[P]=A[P]}),b},u.containingFolder=y=>{if(y==="")return"/";if(!y)throw"Path not given!";return y.replace(/\/+/g,"/").replace(/[^\/]+\/?$/,"")},u.isFolder=y=>y.substr(-1)==="/",u.isDocument=y=>!u.isFolder(y),u.baseName=y=>{const b=y.split("/");return u.isFolder(y)?b[b.length-2]+"/":b[b.length-1]},u.cleanPath=y=>y.replace(/\/+/g,"/").split("/").map(encodeURIComponent).join("/").replace(/'/g,"%27"),u.bindAll=y=>{for(const b in this)typeof y[b]=="function"&&(y[b]=y[b].bind(y))},u.equal=(y,b,A=[])=>{let P;if(typeof y!=typeof b)return!1;if(typeof y=="number"||typeof y=="boolean"||typeof y=="string")return y===b;if(typeof y=="function")return y.toString()===b.toString();if(y instanceof ArrayBuffer&&b instanceof ArrayBuffer&&(y=new Uint8Array(y),b=new Uint8Array(b)),y instanceof Array){if(y.length!==b.length)return!1;for(let h=0,k=y.length;h<k;h++)if(!u.equal(y[h],b[h],A))return!1}else{for(P in y)if(y.hasOwnProperty(P)&&!(P in b))return!1;for(P in b){if(!b.hasOwnProperty(P))continue;if(!(P in y))return!1;let h;if(typeof b[P]=="object"){if(A.indexOf(b[P])>=0)continue;h=A.slice(),h.push(b[P])}if(!u.equal(y[P],b[P],h))return!1}}return!0},u.deepClone=y=>{if(y!==void 0){const b=JSON.parse(JSON.stringify(y));return function A(P,h){if(typeof P=="object"&&!Array.isArray(P)&&P!==null){for(const k in P)if(typeof P[k]=="object"&&P[k]!==null)if(P[k].toString()==="[object ArrayBuffer]"){h[k]=new ArrayBuffer(P[k].byteLength);const x=new Int8Array(P[k]);new Int8Array(h[k]).set(x)}else A(P[k],h[k])}}(y,b),b}},u.pathsFromRoot=y=>{const b=[y],A=y.replace(/\/$/,"").split("/");for(;A.length>1;)A.pop(),b.push(A.join("/")+"/");return b},u.localStorageAvailable=()=>{const y=u.getGlobalContext();if(!("localStorage"in y))return!1;try{return y.localStorage.setItem("rs-check","1"),y.localStorage.removeItem("rs-check"),!0}catch{return!1}},u.getJSONFromLocalStorage=y=>{const b=u.getGlobalContext();try{return JSON.parse(b.localStorage.getItem(y))}catch{}},u.shouldBeTreatedAsBinary=(y,b)=>!!(b&&b.match(/charset=binary/)||/[\x00-\x08\x0E-\x1F\uFFFD]/.test(y)),u.getTextFromArrayBuffer=(y,b)=>new Promise(A=>{if(typeof Blob>"u"){const P=new g(new Uint8Array(y));A(P.toString(b))}else{let P;const h=u.globalContext;if(h.BlobBuilder=h.BlobBuilder||h.WebKitBlobBuilder,h.BlobBuilder!==void 0){const x=new h.BlobBuilder;x.append(y),P=x.getBlob()}else P=new Blob([y]);const k=new FileReader;typeof k.addEventListener=="function"?k.addEventListener("loadend",function(x){A(x.target.result)}):k.onloadend=function(x){A(x.target.result)},k.readAsText(P,b)}}),u.toBase64=y=>{const b=u.getGlobalContext();return"btoa"in b?b.btoa(y):g.from(y).toString("base64")},u.applyMixins=function(y,b){b.forEach(A=>{Object.getOwnPropertyNames(A.prototype).forEach(P=>{Object.defineProperty(y.prototype,P,Object.getOwnPropertyDescriptor(A.prototype,P))})})}}).call(this,d(5),d(19).Buffer)},function(i,u,d){const l=(this&&this.__importDefault||function(g){return g&&g.__esModule?g:{default:g}})(d(3));i.exports=function(...g){l.default.logging&&console.log(...g)}},function(i,u,d){const l=(this&&this.__importDefault||function(g){return g&&g.__esModule?g:{default:g}})(d(1));i.exports=class{addEvents(g){g.forEach(y=>this._addEvent(y))}addEventListener(g,y){if(typeof g!="string")throw new Error("Argument eventName should be a string");if(typeof y!="function")throw new Error("Argument handler should be a function");l.default("[EventHandling] Adding event listener",g),this._validateEvent(g),this._handlers[g].push(y)}on(g,y){return this.addEventListener(g,y)}removeEventListener(g,y){this._validateEvent(g);const b=this._handlers[g].length;for(let A=0;A<b;A++)if(this._handlers[g][A]===y)return void this._handlers[g].splice(A,1)}_emit(g,...y){this._validateEvent(g),this._handlers[g].slice().forEach(b=>{b.apply(this,y)})}_validateEvent(g){if(!(g in this._handlers))throw new Error("Unknown event: "+g)}_delegateEvent(g,y){y.on(g,b=>{this._emit(g,b)})}_addEvent(g){this._handlers===void 0&&(this._handlers={}),this._handlers[g]=[]}}},function(i,u,d){const l={cache:!0,changeEvents:{local:!0,window:!1,remote:!0,conflict:!0},cordovaRedirectUri:void 0,logging:!1,modules:[],backgroundSyncInterval:6e4,disableFeatures:[],discoveryTimeout:1e4,isBackground:!1,requestTimeout:3e4,syncInterval:1e4};i.exports=l},function(i,u,d){class l extends Error{constructor(y,b={}){super(),this.name="Unauthorized",this.message=y===void 0?"App authorization expired or revoked.":y,b.code!==void 0&&(this.code=b.code),this.stack=new Error().stack}}i.exports=l},function(i,u){var d;d=function(){return this}();try{d=d||new Function("return this")()}catch{typeof window=="object"&&(d=window)}i.exports=d},function(i,u,d){var l=this&&this.__importDefault||function(k){return k&&k.__esModule?k:{default:k}};const g=l(d(1)),y=d(0),b=l(d(4));let A;function P(k){const x=k||h.getLocation().href,w=x.indexOf("#");if(w===-1)return;const p=x.substring(w+1);return p.includes("=")?p.split("&").reduce(function(_,m){const N=m.split("=");if(N[0]==="state"&&N[1].match(/rsDiscovery/)){let M=decodeURIComponent(N[1]);const $=M.substr(M.indexOf("rsDiscovery=")).split("&")[0].split("=")[1];_.rsDiscovery=JSON.parse(atob($)),M=M.replace(new RegExp("&?rsDiscovery="+$),""),M.length>0&&(_.state=M)}else _[decodeURIComponent(N[0])]=decodeURIComponent(N[1]);return _},{}):void 0}class h{static authorize(x,{authURL:w,scope:p,redirectUri:_,clientId:m}){if(g.default("[Authorize] authURL = ",w,"scope = ",p,"redirectUri = ",_,"clientId = ",m),!y.localStorageAvailable()&&x.backend==="remotestorage"){_+=_.indexOf("#")>0?"&":"#";const M={userAddress:x.remote.userAddress,href:x.remote.href,storageApi:x.remote.storageApi,properties:x.remote.properties};_+="rsDiscovery="+y.toBase64(JSON.stringify(M))}const N=function(M,$,C,e){const c=$.indexOf("#");let a=M;return a+=M.indexOf("?")>0?"&":"?",a+="redirect_uri="+encodeURIComponent($.replace(/#.*$/,"")),a+="&scope="+encodeURIComponent(C),a+="&client_id="+encodeURIComponent(e),c!==-1&&c+1!==$.length&&(a+="&state="+encodeURIComponent($.substring(c+1))),a+="&response_type=token",a}(w,_,p,m);y.globalContext.cordova?h.openWindow(N,_,"location=yes,clearsessioncache=yes,clearcache=yes").then(M=>{x.remote.configure({token:M.access_token})}):h.setLocation(N)}static setLocation(x){if(typeof x=="string")document.location.href=x;else{if(typeof x!="object")throw"Invalid location "+x;document.location=x}}static _rs_supported(){return typeof document<"u"}static _rs_cleanup(x){x.removeEventListener("features-loaded",A)}}h.IMPLIED_FAKE_TOKEN=!1,h.getLocation=function(){return document.location},h.openWindow=function(k,x,w){return new Promise((p,_)=>{const m=open(k,"_blank",w);if(!m||m.closed)return _("Authorization popup was blocked");function N(){return _("Authorization was canceled")}m.addEventListener("loadstart",function(M){if(M.url.indexOf(x)!==0)return;m.removeEventListener("exit",N),m.close();const $=P(M.url);return $?p($):_("Authorization error")}),m.addEventListener("exit",N)})},h._rs_init=function(k){const x=P();let w;x&&(w=h.getLocation(),w.hash=""),A=function(){let p=!1;if(x){if(x.error)throw x.error==="access_denied"?new b.default("Authorization failed: access denied",{code:"access_denied"}):new b.default("Authorization failed: "+x.error);x.rsDiscovery&&k.remote.configure(x.rsDiscovery),x.access_token&&(k.remote.configure({token:x.access_token}),p=!0),x.remotestorage&&(k.connect(x.remotestorage),p=!0),x.state&&(w=h.getLocation(),h.setLocation(w.href.split("#")[0]+"#"+x.state)),p||k.remote.stopWaitingForToken()}else k.remote.stopWaitingForToken()},k.on("features-loaded",A)},i.exports=h},function(i,u,d){var l=this&&this.__importDefault||function(x){return x&&x.__esModule?x:{default:x}};const g=l(d(23)),y=l(d(24)),b=l(d(25)),A=l(d(2)),P=l(d(3)),h=d(0);class k{constructor(w,p){if(this.schemas={configurable:!0,get:function(){return k.Types.inScope(this.moduleName)}},p[p.length-1]!=="/")throw"Not a folder: "+p;p==="/"&&(this.makePath=m=>(m[0]==="/"?"":"/")+m),this.storage=w,this.base=p;const _=this.base.split("/");_.length>2?this.moduleName=_[1]:this.moduleName="root",this.addEvents(["change"]),this.on=this.on.bind(this),w.onChange(this.base,this._fireChange.bind(this))}scope(w){return new k(this.storage,this.makePath(w))}getListing(w,p){if(typeof w!="string")w="";else if(w.length>0&&w[w.length-1]!=="/")return Promise.reject("Not a folder: "+w);return this.storage.get(this.makePath(w),p).then(function(_){return _.statusCode===404?{}:_.body})}getAll(w,p){if(typeof w!="string")w="";else if(w.length>0&&w[w.length-1]!=="/")return Promise.reject("Not a folder: "+w);return this.storage.get(this.makePath(w),p).then(_=>{if(_.statusCode===404)return{};if(typeof _.body=="object"){const m=Object.keys(_.body);if(m.length===0)return{};const N=m.map(M=>this.storage.get(this.makePath(w+M),p).then(function($){if(typeof $.body=="string")try{$.body=JSON.parse($.body)}catch{}typeof $.body=="object"&&(_.body[M]=$.body)}));return Promise.all(N).then(function(){return _.body})}})}getFile(w,p){return typeof w!="string"?Promise.reject("Argument 'path' of baseClient.getFile must be a string"):this.storage.get(this.makePath(w),p).then(function(_){return{data:_.body,contentType:_.contentType,revision:_.revision}})}storeFile(w,p,_){return typeof w!="string"?Promise.reject("Argument 'mimeType' of baseClient.storeFile must be a string"):typeof p!="string"?Promise.reject("Argument 'path' of baseClient.storeFile must be a string"):typeof _!="string"&&typeof _!="object"?Promise.reject("Argument 'body' of baseClient.storeFile must be a string, ArrayBuffer, or ArrayBufferView"):(this.storage.access.checkPathPermission(this.makePath(p),"rw")||console.warn("WARNING: Editing a document to which only read access ('r') was claimed"),this.storage.put(this.makePath(p),_,w).then(m=>m.statusCode===200||m.statusCode===201?m.revision:Promise.reject("Request (PUT "+this.makePath(p)+") failed with status: "+m.statusCode)))}getObject(w,p){return typeof w!="string"?Promise.reject("Argument 'path' of baseClient.getObject must be a string"):this.storage.get(this.makePath(w),p).then(_=>{if(typeof _.body=="object")return _.body;if(typeof _.body=="string")try{return JSON.parse(_.body)}catch{throw new Error("Not valid JSON: "+this.makePath(w))}else if(_.body!==void 0&&_.statusCode===200)return Promise.reject("Not an object: "+this.makePath(w))})}storeObject(w,p,_){if(typeof w!="string")return Promise.reject("Argument 'typeAlias' of baseClient.storeObject must be a string");if(typeof p!="string")return Promise.reject("Argument 'path' of baseClient.storeObject must be a string");if(typeof _!="object")return Promise.reject("Argument 'object' of baseClient.storeObject must be an object");this._attachType(_,w);try{const m=this.validate(_);if(!m.valid)return Promise.reject(m)}catch(m){return Promise.reject(m)}return this.storage.put(this.makePath(p),JSON.stringify(_),"application/json; charset=UTF-8").then(m=>m.statusCode===200||m.statusCode===201?m.revision:Promise.reject("Request (PUT "+this.makePath(p)+") failed with status: "+m.statusCode))}remove(w){return typeof w!="string"?Promise.reject("Argument 'path' of baseClient.remove must be a string"):(this.storage.access.checkPathPermission(this.makePath(w),"rw")||console.warn("WARNING: Removing a document to which only read access ('r') was claimed"),this.storage.delete(this.makePath(w)))}getItemURL(w){if(typeof w!="string")throw"Argument 'path' of baseClient.getItemURL must be a string";return this.storage.connected?(w=h.cleanPath(this.makePath(w)),this.storage.remote.href+w):void 0}cache(w,p="ALL"){if(typeof w!="string")throw"Argument 'path' of baseClient.cache must be a string";if(typeof p!="string")throw"Argument 'strategy' of baseClient.cache must be a string or undefined";if(p!=="FLUSH"&&p!=="SEEN"&&p!=="ALL")throw`Argument 'strategy' of baseclient.cache must be one of ["FLUSH", "SEEN", "ALL"]`;return this.storage.caching.set(this.makePath(w),p),this}flush(w){return this.storage.local.flush(w)}declareType(w,p,_){let m;_?m=p:(_=p,m=this._defaultTypeURI(w)),k.Types.declare(this.moduleName,w,m,_)}validate(w){const p=k.Types.getSchema(w["@context"]);if(p)return g.default.validateResult(w,p);throw new b.default(w["@context"])}_defaultTypeURI(w){return"http://remotestorage.io/spec/modules/"+encodeURIComponent(this.moduleName)+"/"+encodeURIComponent(w)}_attachType(w,p){w["@context"]=k.Types.resolveAlias(this.moduleName+"/"+p)||this._defaultTypeURI(p)}makePath(w){return this.base+(w||"")}_fireChange(w){P.default.changeEvents[w.origin]&&(["new","old","lastCommon"].forEach(function(p){if((!w[p+"ContentType"]||/^application\/(.*)json(.*)/.exec(w[p+"ContentType"]))&&typeof w[p+"Value"]=="string")try{w[p+"Value"]=JSON.parse(w[p+"Value"])}catch{}}),this._emit("change",w))}static _rs_init(){}}k.Types=y.default,h.applyMixins(k,[A.default]),i.exports=k},function(i,u,d){(function(l){var g=this&&this.__awaiter||function(C,e,c,a){return new(c||(c=Promise))(function(S,v){function O(B){try{J(a.next(B))}catch(R){v(R)}}function q(B){try{J(a.throw(B))}catch(R){v(R)}}function J(B){var R;B.done?S(B.value):(R=B.value,R instanceof c?R:new c(function(F){F(R)})).then(O,q)}J((a=a.apply(C,e||[])).next())})},y=this&&this.__importDefault||function(C){return C&&C.__esModule?C:{default:C}};const b=y(d(6)),A=y(d(2)),P=y(d(4)),h=y(d(3)),k=y(d(1)),x=d(0);let w;const p="remotestorage:wireclient",_={"draft-dejong-remotestorage-00":2,"draft-dejong-remotestorage-01":3,"draft-dejong-remotestorage-02":4,"https://www.w3.org/community/rww/wiki/read-write-web-00#simple":1};let m;if(typeof(l||window).ArrayBufferView=="function")m=function(C){return C&&C instanceof(l||window).ArrayBufferView};else{const C=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];m=function(e){for(let c=0;c<8;c++)if(e instanceof C[c])return!0;return!1}}function N(C){return typeof C!="string"?C:C==="*"?"*":'"'+C+'"'}function M(C){return typeof C!="string"?C:C.replace(/^["']|["']$/g,"")}class ${constructor(e){if(this._revisionCache={},w=x.localStorageAvailable(),this.rs=e,this.connected=!1,this.addEvents(["connected","not-connected"]),w){const c=function(){const a=x.getJSONFromLocalStorage(p)||{},{userAddress:S,href:v,storageApi:O,token:q,properties:J}=a;return{userAddress:S,href:v,storageApi:O,token:q,properties:J}}();c&&setTimeout(()=>{this.configure(c)},0)}this.connected&&setTimeout(this._emit.bind(this),0,"connected")}get storageType(){if(this.storageApi){const e=this.storageApi.match(/draft-dejong-(remotestorage-\d\d)/);return e?e[1]:"2012.04"}}_request(e,c,a,S,v,O,q){return g(this,void 0,void 0,function*(){if(function(B,R){return(B==="PUT"||B==="DELETE")&&x.isFolder(R)}(e,c))return Promise.reject(`Don't use ${e} on directories!`);let J;return a!==b.default.IMPLIED_FAKE_TOKEN&&(S.Authorization="Bearer "+a),this.rs._emit("wire-busy",{method:e,isFolder:x.isFolder(c)}),$.request(e,c,{body:v,headers:S,responseType:"arraybuffer"}).then(B=>{if(this.online||(this.online=!0,this.rs._emit("network-online")),this.rs._emit("wire-done",{method:e,isFolder:x.isFolder(c),success:!0}),R=B.status,[401,403,404,412].indexOf(R)>=0)return k.default("[WireClient] Error response status",B.status),J=O?M(B.getResponseHeader("ETag")):void 0,B.status===401&&this.rs._emit("error",new P.default),Promise.resolve({statusCode:B.status,revision:J});if(function(F){return[201,204,304].indexOf(F)>=0}(B.status)||B.status===200&&e!=="GET")return J=M(B.getResponseHeader("ETag")),k.default("[WireClient] Successful request",J),Promise.resolve({statusCode:B.status,revision:J});{const F=B.getResponseHeader("Content-Type");J=O?M(B.getResponseHeader("ETag")):B.status===200?q:void 0;const n=function(s){let T,I="UTF-8";return s&&(T=s.match(/charset=(.+)$/),T&&(I=T[1])),I}(F);return x.shouldBeTreatedAsBinary(B.response,F)?(k.default("[WireClient] Successful request with unknown or binary mime-type",J),Promise.resolve({statusCode:B.status,body:B.response,contentType:F,revision:J})):x.getTextFromArrayBuffer(B.response,n).then(s=>(k.default("[WireClient] Successful request",J),Promise.resolve({statusCode:B.status,body:s,contentType:F,revision:J})))}var R},B=>(this.online&&(this.online=!1,this.rs._emit("network-offline")),this.rs._emit("wire-done",{method:e,isFolder:x.isFolder(c),success:!1}),Promise.reject(B)))})}configure(e){if(typeof e!="object")throw new Error("WireClient configure settings parameter should be an object");if(e.userAddress!==void 0&&(this.userAddress=e.userAddress),e.href!==void 0&&(this.href=e.href),e.storageApi!==void 0&&(this.storageApi=e.storageApi),e.token!==void 0&&(this.token=e.token),e.properties!==void 0&&(this.properties=e.properties),typeof this.storageApi=="string"){const c=_[this.storageApi]||5;this.supportsRevs=c>=2}this.href&&this.token?(this.connected=!0,this.online=!0,this._emit("connected")):this.connected=!1,w&&(localStorage[p]=JSON.stringify({userAddress:this.userAddress,href:this.href,storageApi:this.storageApi,token:this.token,properties:this.properties}))}stopWaitingForToken(){this.connected||this._emit("not-connected")}get(e,c={}){if(!this.connected)return Promise.reject("not connected (path: "+e+")");const a={};return this.supportsRevs&&c.ifNoneMatch&&(a["If-None-Match"]=N(c.ifNoneMatch)),this._request("GET",this.href+x.cleanPath(e),this.token,a,void 0,this.supportsRevs,this._revisionCache[e]).then(S=>{if(!x.isFolder(e))return Promise.resolve(S);let v={};if(S.body!==void 0)try{S.body=JSON.parse(S.body)}catch{return Promise.reject("Folder description at "+this.href+x.cleanPath(e)+" is not JSON")}if(S.statusCode===200&&typeof S.body=="object"){if(Object.keys(S.body).length===0)S.statusCode=404;else if((O=S.body)["@context"]==="http://remotestorage.io/spec/folder-description"&&typeof O.items=="object"){for(const q in S.body.items)this._revisionCache[e+q]=S.body.items[q].ETag;v=S.body.items}else Object.keys(S.body).forEach(q=>{this._revisionCache[e+q]=S.body[q],v[q]={ETag:S.body[q]}});return S.body=v,Promise.resolve(S)}return Promise.resolve(S);var O})}put(e,c,a,S={}){if(!this.connected)return Promise.reject("not connected (path: "+e+")");!a.match(/charset=/)&&(c instanceof ArrayBuffer||m(c))&&(a+="; charset=binary");const v={"Content-Type":a};return this.supportsRevs&&(S.ifMatch&&(v["If-Match"]=N(S.ifMatch)),S.ifNoneMatch&&(v["If-None-Match"]=N(S.ifNoneMatch))),this._request("PUT",this.href+x.cleanPath(e),this.token,v,c,this.supportsRevs)}delete(e,c={}){if(!this.connected)throw new Error("not connected (path: "+e+")");c||(c={});const a={};return this.supportsRevs&&c.ifMatch&&(a["If-Match"]=N(c.ifMatch)),this._request("DELETE",this.href+x.cleanPath(e),this.token,a,void 0,this.supportsRevs)}static request(e,c,a){return g(this,void 0,void 0,function*(){return typeof fetch=="function"?$._fetchRequest(e,c,a):typeof XMLHttpRequest=="function"?$._xhrRequest(e,c,a):(k.default("[WireClient] You need to add a polyfill for fetch or XMLHttpRequest"),Promise.reject("[WireClient] You need to add a polyfill for fetch or XMLHttpRequest"))})}static _fetchRequest(e,c,a){let S;const v={};let O;typeof AbortController=="function"&&(O=new AbortController);const q=fetch(c,{method:e,headers:a.headers,body:a.body,signal:O?O.signal:void 0}).then(B=>{switch(k.default("[WireClient fetch]",B),B.headers.forEach((R,F)=>{v[F.toUpperCase()]=R}),S={readyState:4,status:B.status,statusText:B.statusText,response:void 0,getResponseHeader:R=>v[R.toUpperCase()]||null,responseType:a.responseType,responseURL:c},a.responseType){case"arraybuffer":return B.arrayBuffer();case"blob":return B.blob();case"json":return B.json();case void 0:case"":case"text":return B.text();default:throw new Error("responseType 'document' is not currently supported using fetch")}}).then(B=>(S.response=B,a.responseType&&a.responseType!=="text"||(S.responseText=B),S)),J=new Promise((B,R)=>{setTimeout(()=>{R("timeout"),O&&O.abort()},h.default.requestTimeout)});return Promise.race([q,J])}static _xhrRequest(e,c,a){return new Promise((S,v)=>{k.default("[WireClient]",e,c);let O=!1;const q=setTimeout(()=>{O=!0,v("timeout")},h.default.requestTimeout),J=new XMLHttpRequest;if(J.open(e,c,!0),a.responseType&&(J.responseType=a.responseType),a.headers)for(const R in a.headers)J.setRequestHeader(R,a.headers[R]);J.onload=()=>{O||(clearTimeout(q),S(J))},J.onerror=R=>{O||(clearTimeout(q),v(R))};let B=a.body;typeof B=="object"&&!m(B)&&B instanceof ArrayBuffer&&(B=new Uint8Array(B)),J.send(B)})}static _rs_init(e){e.remote=new $(e),e.remote.online=!0}static _rs_supported(){return typeof fetch=="function"||typeof XMLHttpRequest=="function"}static _rs_cleanup(){w&&delete localStorage[p]}}$.isArrayBufferView=m,x.applyMixins($,[A.default]),i.exports=$}).call(this,d(5))},function(i,u,d){class l extends Error{constructor(y){super(),this.name="SyncError",this.message="Sync failed: ",typeof y=="string"?this.message+=y:(this.message+=y.message,this.stack=y.stack,this.originalError=y)}}i.exports=l},function(i,u,d){var l=this&&this.__importDefault||function(p){return p&&p.__esModule?p:{default:p}};const g=l(d(2)),y=l(d(3)),b=l(d(1)),A=d(0);class P{constructor(){this._updateNodesRunning=!1,this._updateNodesQueued=[]}get(_,m,N){return typeof m=="number"?this.getNodes(A.pathsFromRoot(_)).then(M=>{const $=h(M[_]);return k(M,m)?N(_):$?{statusCode:200,body:$.body||$.itemsMap,contentType:$.contentType}:{statusCode:404}}):this.getNodes([_]).then(M=>{const $=h(M[_]);if($){if(A.isFolder(_))for(const C in $.itemsMap)$.itemsMap.hasOwnProperty(C)&&$.itemsMap[C]===!1&&delete $.itemsMap[C];return{statusCode:200,body:$.body||$.itemsMap,contentType:$.contentType}}return{statusCode:404}})}put(_,m,N){const M=A.pathsFromRoot(_);return this._updateNodes(M,function($,C){try{for(let e=0,c=$.length;e<c;e++){const a=$[e];let S,v=C[a];v||(C[a]=v=x(a)),e===0?(S=h(v),v.local={body:m,contentType:N,previousBody:S?S.body:void 0,previousContentType:S?S.contentType:void 0}):v=w(v,$[e-1].substring(a.length))}return C}catch(e){throw b.default("[Cachinglayer] Error during PUT",C,e),e}})}delete(_){const m=A.pathsFromRoot(_);return this._updateNodes(m,function(N,M){for(let $=0,C=N.length;$<C;$++){const e=N[$],c=M[e];let a;if(c)if($===0)a=h(c),c.local={body:!1,previousBody:a?a.body:void 0,previousContentType:a?a.contentType:void 0};else{c.local||(c.local=A.deepClone(c.common));const S=N[$-1].substring(e.length);if(delete c.local.itemsMap[S],Object.getOwnPropertyNames(c.local.itemsMap).length>0)break}else console.error("Cannot delete non-existing node "+e)}return M})}flush(_){return this._getAllDescendentPaths(_).then(m=>this.getNodes(m)).then(m=>{for(const N in m){const M=m[N];M&&M.common&&M.local&&this._emitChange({path:M.path,origin:"local",oldValue:M.local.body===!1?void 0:M.local.body,newValue:M.common.body===!1?void 0:M.common.body}),m[N]=void 0}return this.setNodes(m)})}_emitChange(_){y.default.changeEvents[_.origin]&&this._emit("change",_)}fireInitial(){y.default.changeEvents.local&&this.forAllNodes(_=>{if(A.isDocument(_.path)){const m=h(_);m&&this._emitChange({path:_.path,origin:"local",oldValue:void 0,oldContentType:void 0,newValue:m.body,newContentType:m.contentType})}}).then(()=>{this._emit("local-events-done")})}onDiff(_){this.diffHandler=_}migrate(_){return typeof _!="object"||_.common||(_.common={},typeof _.path=="string"?_.path.substr(-1)==="/"&&typeof _.body=="object"&&(_.common.itemsMap=_.body):(_.local||(_.local={}),_.local.body=_.body,_.local.contentType=_.contentType)),_}_updateNodes(_,m){return new Promise((N,M)=>{this._doUpdateNodes(_,m,{resolve:N,reject:M})})}_doUpdateNodes(_,m,N){this._updateNodesRunning?this._updateNodesQueued.push({paths:_,cb:m,promise:N}):(this._updateNodesRunning=!0,this.getNodes(_).then(M=>{const $=A.deepClone(M),C=[];M=m(_,M);for(const e in M){const c=M[e];A.equal(c,$[e])?delete M[e]:A.isDocument(e)&&(A.equal(c.local.body,c.local.previousBody)&&c.local.contentType===c.local.previousContentType||C.push({path:e,origin:"window",oldValue:c.local.previousBody,newValue:c.local.body===!1?void 0:c.local.body,oldContentType:c.local.previousContentType,newContentType:c.local.contentType}),delete c.local.previousBody,delete c.local.previousContentType)}this.setNodes(M).then(()=>{this._emitChangeEvents(C),N.resolve({statusCode:200})})}).then(()=>Promise.resolve(),M=>{N.reject(M)}).then(()=>{this._updateNodesRunning=!1;const M=this._updateNodesQueued.shift();M&&this._doUpdateNodes(M.paths,M.cb,M.promise)}))}_emitChangeEvents(_){for(let m=0,N=_.length;m<N;m++)this._emitChange(_[m]),this.diffHandler&&this.diffHandler(_[m].path)}_getAllDescendentPaths(_){return A.isFolder(_)?this.getNodes([_]).then(m=>{const N=[_],M=h(m[_]),$=Object.keys(M.itemsMap).map(C=>this._getAllDescendentPaths(_+C).then(e=>{for(let c=0,a=e.length;c<a;c++)N.push(e[c])}));return Promise.all($).then(()=>N)}):Promise.resolve([_])}_getInternals(){return{getLatest:h,makeNode:x,isOutdated:k}}}function h(p){if(typeof p=="object"&&typeof p.path=="string")if(A.isFolder(p.path)){if(p.local&&p.local.itemsMap)return p.local;if(p.common&&p.common.itemsMap)return p.common}else{if(p.local){if(p.local.body&&p.local.contentType)return p.local;if(p.local.body===!1)return}if(p.common&&p.common.body&&p.common.contentType)return p.common;if(p.body&&p.contentType)return{body:p.body,contentType:p.contentType}}}function k(p,_){for(const m in p){if(p[m]&&p[m].remote)return!0;const N=h(p[m]);if(N&&N.timestamp&&new Date().getTime()-N.timestamp<=_)return!1;if(!N)return!0}return!0}function x(p){const _={path:p,common:{}};return A.isFolder(p)&&(_.common.itemsMap={}),_}function w(p,_){return p.common||(p.common={itemsMap:{}}),p.common.itemsMap||(p.common.itemsMap={}),p.local||(p.local=A.deepClone(p.common)),p.local.itemsMap||(p.local.itemsMap=p.common.itemsMap),p.local.itemsMap[_]=!0,p}A.applyMixins(P,[g.default]),i.exports=P},function(i,u,d){i.exports=class{constructor(){this.reset()}static _rs_init(){}get scopes(){return Object.keys(this.scopeModeMap).map(l=>({name:l,mode:this.scopeModeMap[l]}))}get scopeParameter(){return this.scopes.map(l=>`${this._scopeNameForParameter(l)}:${l.mode}`).join(" ")}claim(l,g){if(typeof l!="string"||l.indexOf("/")!==-1||l.length===0)throw new Error("Scope should be a non-empty string without forward slashes");if(!g.match(/^rw?$/))throw new Error("Mode should be either 'r' or 'rw'");this._adjustRootPaths(l),this.scopeModeMap[l]=g}get(l){return this.scopeModeMap[l]}remove(l){const g={};for(const y in this.scopeModeMap)g[y]=this.scopeModeMap[y];this.reset(),delete g[l];for(const y in g)this.claim(y,g[y])}checkPermission(l,g){const y=this.get(l);return y&&(g==="r"||y==="rw")}checkPathPermission(l,g){if(this.checkPermission("*",g))return!0;const y=this._getModuleName(l);return!!this.checkPermission(y,g)}reset(){this.rootPaths=[],this.scopeModeMap={}}_getModuleName(l){if(l[0]!=="/")throw new Error("Path should start with a slash");const g=l.replace(/^\/public/,"").match(/^\/([^/]*)\//);return g?g[1]:"*"}_adjustRootPaths(l){"*"in this.scopeModeMap||l==="*"?this.rootPaths=["/"]:l in this.scopeModeMap||(this.rootPaths.push("/"+l+"/"),this.rootPaths.push("/public/"+l+"/"))}_scopeNameForParameter(l){if(l.name==="*"&&this.storageType){if(this.storageType==="2012.04")return"";if(this.storageType.match(/remotestorage-0[01]/))return"root"}return l.name}setStorageType(l){this.storageType=l}}},function(i,u,d){var l=this&&this.__importDefault||function(b){return b&&b.__esModule?b:{default:b}};const g=d(0),y=l(d(1));i.exports=class{constructor(){this.pendingActivations=[],this.reset()}set(b,A){if(typeof b!="string")throw new Error("path should be a string");if(!g.isFolder(b))throw new Error("path should be a folder");if(!A.match(/^(FLUSH|SEEN|ALL)$/))throw new Error("strategy should be 'FLUSH', 'SEEN', or 'ALL'");this._rootPaths[b]=A,A==="ALL"&&(this.activateHandler?this.activateHandler(b):this.pendingActivations.push(b))}enable(b){this.set(b,"ALL")}disable(b){this.set(b,"FLUSH")}onActivate(b){y.default("[Caching] Setting activate handler",b,this.pendingActivations),this.activateHandler=b;for(let A=0;A<this.pendingActivations.length;A++)b(this.pendingActivations[A]);this.pendingActivations=[]}checkPath(b){return this._rootPaths[b]!==void 0?this._rootPaths[b]:b==="/"?"SEEN":this.checkPath(g.containingFolder(b))}reset(){this._rootPaths={}}static _rs_init(){}}},function(i,u,d){var l=this&&this.__importDefault||function($){return $&&$.__esModule?$:{default:$}};const g=l(d(7)),y=l(d(8)),b=l(d(2)),A=d(0),P="https://www.googleapis.com",h="remotestorage:googledrive";let k;function x($){return $.substr(-1)==="/"&&($=$.substr(0,$.length-1)),decodeURIComponent($)}function w($){return $.replace(/[^\/]+\/?$/,"")}function p($){const C=$.split("/");return $.substr(-1)==="/"?C[C.length-2]+"/":C[C.length-1]}function _($){return A.cleanPath("/remotestorage/"+$)}function m($){return $.replace(/^["'](.*)["']$/,"$1")}class N{constructor(C){this._items={},this.maxAge=C,this._items={}}get(C){const e=this._items[C],c=new Date().getTime();return e&&e.t>=c-this.maxAge?e.v:void 0}set(C,e){this._items[C]={v:e,t:new Date().getTime()}}}class M{constructor(C,e){if(this.connected=!1,this.online=!0,this.addEvents(["connected","not-connected"]),this.rs=C,this.clientId=e,this._fileIdCache=new N(300),k=A.localStorageAvailable(),k){const c=A.getJSONFromLocalStorage(h);c&&this.configure(c)}}configure(C){C.userAddress!==void 0&&(this.userAddress=C.userAddress),C.token!==void 0&&(this.token=C.token);const e=function(){k&&localStorage.setItem(h,JSON.stringify({userAddress:this.userAddress,token:this.token}))},c=function(){this.connected=!1,delete this.token,k&&localStorage.removeItem(h)};this.token?(this.connected=!0,this.userAddress?(this._emit("connected"),e.apply(this)):this.info().then(a=>{this.userAddress=a.user.emailAddress,this._emit("connected"),e.apply(this)}).catch(()=>{c.apply(this),this.rs._emit("error",new Error("Could not fetch user info."))})):c.apply(this)}connect(){this.rs.setBackend("googledrive"),this.rs.authorize({authURL:"https://accounts.google.com/o/oauth2/auth",scope:"https://www.googleapis.com/auth/drive",clientId:this.clientId})}stopWaitingForToken(){this.connected||this._emit("not-connected")}get(C,e){return A.isFolder(C)?this._getFolder(_(C)):this._getFile(_(C),e)}put(C,e,c,a){const S=_(C);function v(O){if(O.status>=200&&O.status<300){const q=JSON.parse(O.responseText),J=m(q.etag);return Promise.resolve({statusCode:200,contentType:q.mimeType,revision:J})}return O.status===412?Promise.resolve({statusCode:412,revision:"conflict"}):Promise.reject("PUT failed with status "+O.status+" ("+O.responseText+")")}return this._getFileId(S).then(O=>O?a&&a.ifNoneMatch==="*"?v({status:412}):this._updateFile(O,S,e,c,a).then(v):this._createFile(S,e,c).then(v))}delete(C,e){const c=_(C);return this._getFileId(c).then(a=>a?this._getMeta(a).then(S=>{let v;return typeof S=="object"&&typeof S.etag=="string"&&(v=m(S.etag)),e&&e.ifMatch&&e.ifMatch!==v?{statusCode:412,revision:v}:this._request("DELETE",P+"/drive/v2/files/"+a,{}).then(O=>O.status===200||O.status===204?{statusCode:200}:Promise.reject("Delete failed: "+O.status+" ("+O.responseText+")"))}):Promise.resolve({statusCode:200}))}info(){return this._request("GET","https://www.googleapis.com/drive/v2/about?fields=user",{}).then(function(C){try{const e=JSON.parse(C.responseText);return Promise.resolve(e)}catch(e){return Promise.reject(e)}})}_updateFile(C,e,c,a,S){const v={mimeType:a},O={"Content-Type":"application/json; charset=UTF-8"};return S&&S.ifMatch&&(O["If-Match"]='"'+S.ifMatch+'"'),this._request("PUT",P+"/upload/drive/v2/files/"+C+"?uploadType=resumable",{body:JSON.stringify(v),headers:O}).then(q=>q.status===412?q:this._request("PUT",q.getResponseHeader("Location"),{body:a.match(/^application\/json/)?JSON.stringify(c):c}))}_createFile(C,e,c){return this._getParentId(C).then(a=>{const S={title:x(p(C)),mimeType:c,parents:[{kind:"drive#fileLink",id:a}]};return this._request("POST",P+"/upload/drive/v2/files?uploadType=resumable",{body:JSON.stringify(S),headers:{"Content-Type":"application/json; charset=UTF-8"}}).then(v=>this._request("POST",v.getResponseHeader("Location"),{body:c.match(/^application\/json/)?JSON.stringify(e):e}))})}_getFile(C,e){return this._getFileId(C).then(c=>this._getMeta(c).then(a=>{let S;if(typeof a=="object"&&typeof a.etag=="string"&&(S=m(a.etag)),e&&e.ifNoneMatch&&S===e.ifNoneMatch)return Promise.resolve({statusCode:304});if(!a.downloadUrl){if(!a.exportLinks||!a.exportLinks["text/html"])return Promise.resolve({statusCode:200,body:"",contentType:a.mimeType,revision:S});a.mimeType+=";export=text/html",a.downloadUrl=a.exportLinks["text/html"]}return this._request("GET",a.downloadUrl,{responseType:"arraybuffer"}).then(v=>A.getTextFromArrayBuffer(v.response,"UTF-8").then(function(O){let q=O;if(a.mimeType.match(/^application\/json/))try{q=JSON.parse(q)}catch{}else A.shouldBeTreatedAsBinary(O,a.mimeType)&&(q=v.response);return{statusCode:200,body:q,contentType:a.mimeType,revision:S}}))}))}_getFolder(C){return this._getFileId(C).then(e=>{let c,a,S;if(!e)return Promise.resolve({statusCode:404});const v="'"+e+"' in parents";return this._request("GET",P+"/drive/v2/files?q="+encodeURIComponent(v)+"&fields="+encodeURIComponent("items(downloadUrl,etag,fileSize,id,mimeType,title,labels)")+"&maxResults=1000&trashed=false",{}).then(O=>{var q;if(O.status!==200)return Promise.reject("request failed or something: "+O.status);try{c=JSON.parse(O.responseText)}catch{return Promise.reject("non-JSON response from GoogleDrive")}S={};for(const J of c.items)!((q=J.labels)===null||q===void 0)&&q.trashed||(a=m(J.etag),J.mimeType==="application/vnd.google-apps.folder"?(this._fileIdCache.set(C+A.cleanPath(J.title)+"/",J.id),S[J.title+"/"]={ETag:a}):(this._fileIdCache.set(C+A.cleanPath(J.title),J.id),S[J.title]={ETag:a,"Content-Type":J.mimeType,"Content-Length":J.fileSize}));return Promise.resolve({statusCode:200,body:S,contentType:"application/json; charset=UTF-8",revision:void 0})})})}_getParentId(C){const e=w(C);return this._getFileId(e).then(c=>c?Promise.resolve(c):this._createFolder(e))}_createFolder(C){return this._getParentId(C).then(e=>this._request("POST",P+"/drive/v2/files",{body:JSON.stringify({title:x(p(C)),mimeType:"application/vnd.google-apps.folder",parents:[{id:e}]}),headers:{"Content-Type":"application/json; charset=UTF-8"}}).then(c=>{const a=JSON.parse(c.responseText);return Promise.resolve(a.id)}))}_getFileId(C){let e;return C==="/"?Promise.resolve("root"):(e=this._fileIdCache.get(C))?Promise.resolve(e):this._getFolder(w(C)).then(()=>(e=this._fileIdCache.get(C),e?Promise.resolve(e):C.substr(-1)==="/"?this._createFolder(C).then(()=>this._getFileId(C)):Promise.resolve()))}_getMeta(C){return this._request("GET",P+"/drive/v2/files/"+C,{}).then(function(e){return e.status===200?Promise.resolve(JSON.parse(e.responseText)):Promise.reject("request (getting metadata for "+C+") failed with status: "+e.status)})}_request(C,e,c){return c.headers||(c.headers={}),c.headers.Authorization="Bearer "+this.token,this.rs._emit("wire-busy",{method:C,isFolder:A.isFolder(e)}),y.default.request.call(this,C,e,c).then(a=>a&&a.status===401?void this.connect():(this.online||(this.online=!0,this.rs._emit("network-online")),this.rs._emit("wire-done",{method:C,isFolder:A.isFolder(e),success:!0}),Promise.resolve(a)),a=>(this.online&&(this.online=!1,this.rs._emit("network-offline")),this.rs._emit("wire-done",{method:C,isFolder:A.isFolder(e),success:!1}),Promise.reject(a)))}static _rs_init(C){const e=C.apiKeys.googledrive;var c;e&&(C.googledrive=new M(C,e.clientId),C.backend==="googledrive"&&(C._origRemote=C.remote,C.remote=C.googledrive,(c=C)._origBaseClientGetItemURL||(c._origBaseClientGetItemURL=g.default.prototype.getItemURL,g.default.prototype.getItemURL=function(){throw new Error("getItemURL is not implemented for Google Drive yet")})))}static _rs_supported(){return!0}static _rs_cleanup(C){var e;C.setBackend(void 0),C._origRemote&&(C.remote=C._origRemote,delete C._origRemote),(e=C)._origBaseClientGetItemURL&&(g.default.prototype.getItemURL=e._origBaseClientGetItemURL,delete e._origBaseClientGetItemURL)}}A.applyMixins(M,[b.default]),i.exports=M},function(i,u,d){var l=this&&this.__awaiter||function(c,a,S,v){return new(S||(S=Promise))(function(O,q){function J(F){try{R(v.next(F))}catch(n){q(n)}}function B(F){try{R(v.throw(F))}catch(n){q(n)}}function R(F){var n;F.done?O(F.value):(n=F.value,n instanceof S?n:new S(function(s){s(n)})).then(J,B)}R((v=v.apply(c,a||[])).next())})},g=this&&this.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};const y=g(d(2)),b=g(d(8)),A=g(d(7)),P=g(d(26)),h=g(d(9)),k=g(d(4)),x=d(0);let w;const p="remotestorage:dropbox";function _(c){return x.cleanPath("/remotestorage/"+c).replace(/\/$/,"")}function m(c,a){return new RegExp("^"+a.join("\\/")+"(\\/|$)").test(c.error_summary)}function N(c){return c instanceof ArrayBuffer||b.default.isArrayBufferView(c)}class M{constructor(a){if(this.rs=a,this.connected=!1,this.online=!0,this._initialFetchDone=!1,this.addEvents(["connected","not-connected"]),this.clientId=a.apiKeys.dropbox.appKey,this._revCache=new P.default("rev"),this._fetchDeltaCursor=null,this._fetchDeltaPromise=null,this._itemRefs={},w=x.localStorageAvailable(),w){const S=x.getJSONFromLocalStorage(p);S&&this.configure(S),this._itemRefs=x.getJSONFromLocalStorage(p+":shares")||{}}this.connected&&setTimeout(this._emit.bind(this),0,"connected")}connect(){this.rs.setBackend("dropbox"),this.token?e(this.rs):this.rs.authorize({authURL:"https://www.dropbox.com/oauth2/authorize",scope:"",clientId:this.clientId})}configure(a){a.userAddress!==void 0&&(this.userAddress=a.userAddress),a.token!==void 0&&(this.token=a.token);const S=function(){w&&localStorage.setItem(p,JSON.stringify({userAddress:this.userAddress,token:this.token}))},v=function(){this.connected=!1,w&&localStorage.removeItem(p)};this.token?(this.connected=!0,this.userAddress?(this._emit("connected"),S.apply(this)):this.info().then(function(O){this.userAddress=O.email,this._emit("connected"),S.apply(this)}.bind(this)).catch(function(){v.apply(this),this.rs._emit("error",new Error("Could not fetch user info."))}.bind(this))):v.apply(this)}stopWaitingForToken(){this.connected||this._emit("not-connected")}_getFolder(a){const S=this._revCache,v=q=>{let J;if(q.status!==200&&q.status!==409)return Promise.reject("Unexpected response status: "+q.status);try{J=JSON.parse(q.responseText)}catch(R){return Promise.reject(R)}if(q.status===409)return m(J,["path","not_found"])?Promise.resolve({}):Promise.reject(new Error("API returned an error: "+J.error_summary));const B=J.entries.reduce((R,F)=>{const n=F[".tag"]==="folder",s=F.path_lower.split("/").slice(-1)[0]+(n?"/":"");return n?R[s]={ETag:S.get(a+s)}:(R[s]={ETag:F.rev},this._revCache.set(a+s,F.rev)),R},{});return J.has_more?O(J.cursor).then(function(R){return Object.assign(B,R)}):Promise.resolve(B)},O=q=>{const J={body:{cursor:q}};return this._request("POST","https://api.dropboxapi.com/2/files/list_folder/continue",J).then(v)};return this._request("POST","https://api.dropboxapi.com/2/files/list_folder",{body:{path:_(a)}}).then(v).then(function(q){return Promise.resolve({statusCode:200,body:q,contentType:"application/json; charset=UTF-8",revision:S.get(a)})})}get(a,S){if(!this.connected)return Promise.reject("not connected (path: "+a+")");const v=this._revCache.get(a);if(v===null)return Promise.resolve({statusCode:404});if(S&&S.ifNoneMatch){if(!this._initialFetchDone)return this.fetchDelta().then(()=>this.get(a,S));if(v&&v===S.ifNoneMatch)return Promise.resolve({statusCode:304})}if(a.substr(-1)==="/")return this._getFolder(a);const O={headers:{"Dropbox-API-Arg":JSON.stringify({path:_(a)})},responseType:"arraybuffer"};return S&&S.ifNoneMatch&&(O.headers["If-None-Match"]=S.ifNoneMatch),this._request("GET","https://content.dropboxapi.com/2/files/download",O).then(q=>{const J=q.status;let B,R,F,n;return J!==200&&J!==409?Promise.resolve({statusCode:J}):(B=q.getResponseHeader("Dropbox-API-Result"),x.getTextFromArrayBuffer(q.response,"UTF-8").then(s=>{R=s,J===409&&(B=R);try{B=JSON.parse(B)}catch(T){return Promise.reject(T)}if(J===409)return m(B,["path","not_found"])?{statusCode:404}:Promise.reject(new Error('API error while downloading file ("'+a+'"): '+B.error_summary));if(F=q.getResponseHeader("Content-Type"),n=B.rev,this._revCache.set(a,n),this._shareIfNeeded(a),x.shouldBeTreatedAsBinary(s,F))R=q.response;else try{R=JSON.parse(R),F="application/json; charset=UTF-8"}catch{}return{statusCode:J,body:R,contentType:F,revision:n}}))})}put(a,S,v,O){if(!this.connected)throw new Error("not connected (path: "+a+")");const q=this._revCache.get(a);if(O&&O.ifMatch&&q&&q!==O.ifMatch)return Promise.resolve({statusCode:412,revision:q});if(O&&O.ifNoneMatch==="*"&&q&&q!=="rev")return Promise.resolve({statusCode:412,revision:q});if(!v.match(/charset=/)&&N(S)&&(v+="; charset=binary"),S.length>157286400)return Promise.reject(new Error("Cannot upload file larger than 150MB"));let J;const B=O&&(O.ifMatch||O.ifNoneMatch==="*"),R={body:S,contentType:v,path:a};return J=B?this._getMetadata(a).then(F=>O&&O.ifNoneMatch==="*"&&F||O&&O.ifMatch&&F&&F.rev!==O.ifMatch?Promise.resolve({statusCode:412,revision:F.rev}):this._uploadSimple(R)):this._uploadSimple(R),J.then(F=>(this._shareIfNeeded(a),F))}delete(a,S){if(!this.connected)throw new Error("not connected (path: "+a+")");const v=this._revCache.get(a);return S&&S.ifMatch&&v&&S.ifMatch!==v?Promise.resolve({statusCode:412,revision:v}):S&&S.ifMatch?this._getMetadata(a).then(O=>S&&S.ifMatch&&O&&O.rev!==S.ifMatch?Promise.resolve({statusCode:412,revision:O.rev}):this._deleteSimple(a)):this._deleteSimple(a)}_shareIfNeeded(a){a.match(/^\/public\/.*[^/]$/)&&this._itemRefs[a]===void 0&&this.share(a)}share(a){const S={body:{path:_(a)}};return this._request("POST","https://api.dropboxapi.com/2/sharing/create_shared_link_with_settings",S).then(v=>{if(v.status!==200&&v.status!==409)return Promise.reject(new Error("Invalid response status:"+v.status));let O;try{O=JSON.parse(v.responseText)}catch{return Promise.reject(new Error("Invalid response body: "+v.responseText))}return v.status===409?m(O,["shared_link_already_exists"])?this._getSharedLink(a):Promise.reject(new Error("API error: "+O.error_summary)):Promise.resolve(O.url)}).then(v=>(this._itemRefs[a]=v,w&&localStorage.setItem(p+":shares",JSON.stringify(this._itemRefs)),Promise.resolve(v)),v=>(v.message='Sharing Dropbox file or folder ("'+a+'") failed: '+v.message,Promise.reject(v)))}info(){return this._request("POST","https://api.dropboxapi.com/2/users/get_current_account",{}).then(function(a){let S=a.responseText;try{S=JSON.parse(S)}catch{return Promise.reject(new Error("Could not query current account info: Invalid API response: "+S))}return Promise.resolve({email:S.email})})}_request(a,S,v){return v.headers||(v.headers={}),v.headers.Authorization="Bearer "+this.token,typeof v.body!="object"||N(v.body)||(v.body=JSON.stringify(v.body),v.headers["Content-Type"]="application/json; charset=UTF-8"),this.rs._emit("wire-busy",{method:a,isFolder:x.isFolder(S)}),b.default.request.call(this,a,S,v).then(O=>O&&O.status===503?(this.online&&(this.online=!1,this.rs._emit("network-offline")),setTimeout(this._request(a,S,v),3210)):(this.online||(this.online=!0,this.rs._emit("network-online")),this.rs._emit("wire-done",{method:a,isFolder:x.isFolder(S),success:!0}),Promise.resolve(O)),O=>(this.online&&(this.online=!1,this.rs._emit("network-offline")),this.rs._emit("wire-done",{method:a,isFolder:x.isFolder(S),success:!1}),Promise.reject(O)))}fetchDelta(...a){if(this._fetchDeltaPromise)return this._fetchDeltaPromise;const S=v=>{let O,q="https://api.dropboxapi.com/2/files/list_folder";return typeof v=="string"?(q+="/continue",O={cursor:v}):O={path:"/remotestorage",recursive:!0,include_deleted:!0},this._request("POST",q,{body:O}).then(J=>{if(J.status===401)return this.rs._emit("error",new k.default),Promise.resolve(a);if(J.status!==200&&J.status!==409)return Promise.reject(new Error("Invalid response status: "+J.status));let B;try{B=JSON.parse(J.responseText)}catch{return Promise.reject(new Error("Invalid response body: "+J.responseText))}if(J.status===409){if(!m(B,["path","not_found"]))return Promise.reject(new Error("API returned an error: "+B.error_summary));B={cursor:null,entries:[],has_more:!1}}if(v||this._revCache.deactivatePropagation(),B.entries.forEach(R=>{const F=R.path_lower.substr(14);R[".tag"]==="deleted"?(this._revCache.delete(F),this._revCache.delete(F+"/")):R[".tag"]==="file"&&this._revCache.set(F,R.rev)}),this._fetchDeltaCursor=B.cursor,B.has_more)return S(B.cursor);this._revCache.activatePropagation(),this._initialFetchDone=!0}).catch(J=>J==="timeout"||J instanceof ProgressEvent?Promise.resolve():Promise.reject(J))};return this._fetchDeltaPromise=S(this._fetchDeltaCursor).catch(v=>(typeof v=="object"&&"message"in v?v.message="Dropbox: fetchDelta: "+v.message:v="Dropbox: fetchDelta: "+v,this._fetchDeltaPromise=null,Promise.reject(v))).then(()=>(this._fetchDeltaPromise=null,Promise.resolve(a))),this._fetchDeltaPromise}_getMetadata(a){const S={path:_(a)};return this._request("POST","https://api.dropboxapi.com/2/files/get_metadata",{body:S}).then(v=>{if(v.status!==200&&v.status!==409)return Promise.reject(new Error("Invalid response status:"+v.status));let O;try{O=JSON.parse(v.responseText)}catch{return Promise.reject(new Error("Invalid response body: "+v.responseText))}return v.status===409?m(O,["path","not_found"])?Promise.resolve():Promise.reject(new Error("API error: "+O.error_summary)):Promise.resolve(O)}).then(void 0,v=>(v.message='Could not load metadata for file or folder ("'+a+'"): '+v.message,Promise.reject(v)))}_uploadSimple(a){const S={path:_(a.path),mode:{".tag":"overwrite",update:void 0},mute:!0};return a.ifMatch&&(S.mode={".tag":"update",update:a.ifMatch}),this._request("POST","https://content.dropboxapi.com/2/files/upload",{body:a.body,headers:{"Content-Type":"application/octet-stream","Dropbox-API-Arg":JSON.stringify(S)}}).then(v=>{if(v.status!==200&&v.status!==409)return Promise.resolve({statusCode:v.status});let O=v.responseText;try{O=JSON.parse(O)}catch{return Promise.reject(new Error("Invalid API result: "+O))}return v.status===409?m(O,["path","conflict"])?this._getMetadata(a.path).then(function(q){return Promise.resolve({statusCode:412,revision:q.rev})}):Promise.reject(new Error("API error: "+O.error_summary)):(this._revCache.set(a.path,O.rev),Promise.resolve({statusCode:v.status,revision:O.rev}))})}_deleteSimple(a){const S={path:_(a)};return this._request("POST","https://api.dropboxapi.com/2/files/delete",{body:S}).then(v=>{if(v.status!==200&&v.status!==409)return Promise.resolve({statusCode:v.status});let O=v.responseText;try{O=JSON.parse(O)}catch{return Promise.reject(new Error("Invalid response body: "+O))}return v.status===409?m(O,["path_lookup","not_found"])?Promise.resolve({statusCode:404}):Promise.reject(new Error("API error: "+O.error_summary)):Promise.resolve({statusCode:200})}).then(v=>(v.statusCode!==200&&v.statusCode!==404||(this._revCache.delete(a),delete this._itemRefs[a]),Promise.resolve(v)),v=>(v.message='Could not delete Dropbox file or folder ("'+a+'"): '+v.message,Promise.reject(v)))}_getSharedLink(a){return l(this,void 0,void 0,function*(){const S={body:{path:_(a),direct_only:!0}};return this._request("POST","https://api.dropbox.com/2/sharing/list_shared_links",S).then(v=>{if(v.status!==200&&v.status!==409)return Promise.reject(new Error("Invalid response status: "+v.status));let O;try{O=JSON.parse(v.responseText)}catch{return Promise.reject(new Error("Invalid response body: "+v.responseText))}return v.status===409?Promise.reject(new Error("API error: "+v.error_summary)):O.links.length?Promise.resolve(O.links[0].url):Promise.reject(new Error("No links returned"))},v=>(v.message='Could not get link to a shared file or folder ("'+a+'"): '+v.message,Promise.reject(v)))})}static _rs_init(a){w=x.localStorageAvailable(),a.apiKeys.dropbox&&(a.dropbox=new M(a)),a.backend==="dropbox"&&e(a)}static _rs_supported(){return!0}static _rs_cleanup(a){(function(S){(function(v){v._origRemote&&(v.remote=v._origRemote,delete v._origRemote)})(S),function(v){!v._dropboxOrigSync||(v.sync.sync=v._dropboxOrigSync,delete v._dropboxOrigSync)}(S),function(v){!v._origBaseClientGetItemURL||(A.default.prototype.getItemURL=v._origBaseClientGetItemURL,delete v._origBaseClientGetItemURL)}(S),C(S)})(a),w&&localStorage.removeItem(p),a.setBackend(void 0)}}function $(c,...a){c._dropboxOrigSync||(c._dropboxOrigSync=c.sync.sync.bind(c.sync),c.sync.sync=function(){return this.dropbox.fetchDelta(c,...a).then(c._dropboxOrigSync,function(S){c._emit("error",new h.default(S)),c._emit("sync-done")})}.bind(c))}function C(c){c._dropboxOrigSyncCycle&&(c.syncCycle=c._dropboxOrigSyncCycle,delete c._dropboxOrigSyncCycle)}function e(c){(function(a){a._origRemote||(a._origRemote=a.remote,a.remote=a.dropbox)})(c),c.sync?$(c):function(a,...S){a._dropboxOrigSyncCycle||(a._dropboxOrigSyncCycle=a.syncCycle,a.syncCycle=()=>{if(!a.sync)throw new Error("expected sync to be initialized by now");$(a),a._dropboxOrigSyncCycle(a,...S),C(a)})}(c),function(a){a._origBaseClientGetItemURL||(a._origBaseClientGetItemURL=A.default.prototype.getItemURL,A.default.prototype.getItemURL=function(){throw new Error("getItemURL is not implemented for Dropbox yet")})}(c)}x.applyMixins(M,[y.default]),i.exports=M},function(i,u,d){var l=this&&this.__importDefault||function(x){return x&&x.__esModule?x:{default:x}};const g=l(d(27)),y=l(d(1)),b=d(0);let A,P,h={};const k=function(x){return new Promise((w,p)=>x in h?w(h[x]):new g.default({tls_only:!1,uri_fallback:!0,request_timeout:5e3}).lookup(x,function(_,m){if(_)return p(_);if(typeof m.idx.links.remotestorage!="object"||typeof m.idx.links.remotestorage.length!="number"||m.idx.links.remotestorage.length<=0)return y.default("[Discover] WebFinger record for "+x+" does not have remotestorage defined in the links section ",JSON.stringify(m.json)),p("WebFinger record for "+x+" does not have remotestorage defined in the links section.");const N=m.idx.links.remotestorage[0],M=N.properties["http://tools.ietf.org/html/rfc6749#section-4.2"]||N.properties["auth-endpoint"],$=N.properties["http://remotestorage.io/spec/version"]||N.type;return h[x]={href:N.href,storageApi:$,authURL:M,properties:N.properties},P&&(localStorage["remotestorage:discover"]=JSON.stringify({cache:h})),w(h[x])}))};(k.DiscoveryError=function(x){this.name="DiscoveryError",this.message=x,this.stack=new Error().stack}).prototype=Object.create(Error.prototype),k.DiscoveryError.prototype.constructor=k.DiscoveryError,k._rs_init=function(){if(P=b.localStorageAvailable(),P)try{h=JSON.parse(localStorage["remotestorage:discover"]).cache}catch{}},k._rs_supported=function(){return A=Object.prototype.hasOwnProperty.call(b.globalContext,"XMLHttpRequest"),A},k._rs_cleanup=function(){P&&delete localStorage["remotestorage:discover"]},i.exports=k},function(i,u,d){const l=(this&&this.__importDefault||function(b){return b&&b.__esModule?b:{default:b}})(d(2)),g=d(0);class y{constructor(){this.addEvents(["background","foreground"]),this.mode=typeof window<"u"?"browser":"node",this.mode==="browser"&&(this.setBrowserPrefixedNames(),document.addEventListener(this.visibilityChangeEvent,this.setVisibility.bind(this),!1),this.setVisibility())}setBrowserPrefixedNames(){this.mode==="browser"&&(document.hidden!==void 0?(this.hiddenProperty="hidden",this.visibilityChangeEvent="visibilitychange"):document.mozHidden!==void 0?(this.hiddenProperty="mozHidden",this.visibilityChangeEvent="mozvisibilitychange"):document.msHidden!==void 0?(this.hiddenProperty="msHidden",this.visibilityChangeEvent="msvisibilitychange"):document.webkitHidden!==void 0&&(this.hiddenProperty="webkitHidden",this.visibilityChangeEvent="webkitvisibilitychange"))}setVisibility(){document[this.hiddenProperty]?this.goBackground():this.goForeground()}isBrowser(){return this.mode==="browser"}isNode(){return this.mode==="node"}goBackground(){this._emit("background")}goForeground(){this._emit("foreground")}static _rs_init(){}static _rs_cleanup(){}}g.applyMixins(y,[l.default]),i.exports=y},function(i,u,d){i.exports=d(18)},function(i,u,d){var l=this&&this.__createBinding||(Object.create?function(B,R,F,n){n===void 0&&(n=F),Object.defineProperty(B,n,{enumerable:!0,get:function(){return R[F]}})}:function(B,R,F,n){n===void 0&&(n=F),B[n]=R[F]}),g=this&&this.__setModuleDefault||(Object.create?function(B,R){Object.defineProperty(B,"default",{enumerable:!0,value:R})}:function(B,R){B.default=R}),y=this&&this.__importStar||function(B){if(B&&B.__esModule)return B;var R={};if(B!=null)for(var F in B)F!=="default"&&Object.hasOwnProperty.call(B,F)&&l(R,B,F);return g(R,B),R},b=this&&this.__importDefault||function(B){return B&&B.__esModule?B:{default:B}};const A=b(d(3)),P=b(d(1)),h=d(0),k=b(d(11)),x=b(d(6)),w=b(d(7)),p=b(d(12)),_=b(d(2)),m=b(d(13)),N=b(d(14)),M=b(d(15)),$=b(d(9)),C=b(d(4)),e=b(d(29)),c=y(d(0)),a=h.getGlobalContext();let S;function v(B){return B.statusCode!==403&&B.statusCode!==401||this._emit("error",new C.default),Promise.resolve(B)}function O(B){return typeof B=="number"&&B>=2e3&&B<=36e5}class q{constructor(R){this._pending=[],this._cleanups=[],this._pathHandlers={change:{}},this.apiKeys={},this._init=e.default.loadFeatures,this.features=e.default.features,this.loadFeature=e.default.loadFeature,this.featureSupported=e.default.featureSupported,this.featureDone=e.default.featureDone,this.featuresDone=e.default.featuresDone,this.featuresLoaded=e.default.featuresLoaded,this.featureInitialized=e.default.featureInitialized,this.featureFailed=e.default.featureFailed,this.hasFeature=e.default.hasFeature,this._setCachingModule=e.default._setCachingModule,this._collectCleanupFunctions=e.default._collectCleanupFunctions,this._fireReady=e.default._fireReady,this.initFeature=e.default.initFeature,typeof R=="object"&&h.extend(A.default,R),this.addEvents(["ready","authing","connecting","connected","disconnected","not-connected","conflict","error","features-loaded","sync-interval-change","sync-req-done","sync-done","wire-busy","wire-done","network-offline","network-online"]),this._setGPD({get:this._pendingGPD("get"),put:this._pendingGPD("put"),delete:this._pendingGPD("delete")}),S=h.localStorageAvailable(),S&&(this.apiKeys=h.getJSONFromLocalStorage("remotestorage:api-keys")||{},this.setBackend(localStorage.getItem("remotestorage:backend")||"remotestorage"));const F=this.on;this.on=function(n,s){if(this._allLoaded)switch(n){case"features-loaded":setTimeout(s,0);break;case"ready":this.remote&&setTimeout(s,0);break;case"connected":this.remote&&this.remote.connected&&setTimeout(s,0);break;case"not-connected":this.remote&&!this.remote.connected&&setTimeout(s,0)}return F.call(this,n,s)},this._init(),this.fireInitial=function(){this.local&&setTimeout(this.local.fireInitial.bind(this.local),0)}.bind(this),this.on("ready",this.fireInitial.bind(this)),this.loadModules()}get connected(){return this.remote.connected}loadModules(){A.default.modules.forEach(this.addModule.bind(this))}authorize(R){if(this.access.setStorageType(this.remote.storageApi),R.scope===void 0&&(R.scope=this.access.scopeParameter),a.cordova)R.redirectUri=A.default.cordovaRedirectUri;else{const F=x.default.getLocation();let n=F.origin;F.pathname!=="/"&&(n+=F.pathname),R.redirectUri=n}R.clientId===void 0&&(R.clientId=R.redirectUri.match(/^(https?:\/\/[^/]+)/)[0]),x.default.authorize(this,R)}impliedauth(R,F){R=R||this.remote.storageApi,F=F||String(document.location),P.default("ImpliedAuth proceeding due to absent authURL; storageApi = "+R+" redirectUri = "+F),this.remote.configure({token:x.default.IMPLIED_FAKE_TOKEN}),document.location.href=F}connect(R,F){if(this.setBackend("remotestorage"),R.indexOf("@")<0&&!R.match(/^(https?:\/\/)?[^\s\/$\.?#]+\.[^\s]*$/))return void this._emit("error",new q.DiscoveryError("Not a valid user address or URL."));if(R.indexOf("@")<0&&!R.match(/^https?:\/\//)&&(R="https://"+R),a.cordova){if(typeof A.default.cordovaRedirectUri!="string")return void this._emit("error",new q.DiscoveryError("Please supply a custom HTTPS redirect URI for your Cordova app"));if(!a.cordova.InAppBrowser)return void this._emit("error",new q.DiscoveryError("Please include the InAppBrowser Cordova plugin to enable OAuth"))}this.remote.configure({userAddress:R}),this._emit("connecting");const n=setTimeout(()=>{this._emit("error",new q.DiscoveryError("No storage information found for this user address."))},A.default.discoveryTimeout);M.default(R).then(s=>{if(clearTimeout(n),this._emit("authing"),s.userAddress=R,this.remote.configure(s),!this.remote.connected)if(s.authURL)if(F===void 0)this.authorize({authURL:s.authURL});else{if(typeof F!="string")throw new Error("Supplied bearer token must be a string");P.default("Skipping authorization sequence and connecting with known token"),this.remote.configure({token:F})}else this.impliedauth()},()=>{clearTimeout(n),this._emit("error",new q.DiscoveryError("No storage information found for this user address."))})}reconnect(){this.remote.configure({token:null}),this.backend==="remotestorage"?this.connect(this.remote.userAddress):this.remote.connect()}disconnect(){this.remote&&this.remote.configure({userAddress:null,href:null,storageApi:null,token:null,properties:null}),this._setGPD({get:this._pendingGPD("get"),put:this._pendingGPD("put"),delete:this._pendingGPD("delete")});const R=this._cleanups.length;let F=0;const n=()=>{F++,F>=R&&(this._init(),this._emit("disconnected"))};R>0?this._cleanups.forEach(s=>{const T=s(this);typeof T=="object"&&typeof T.then=="function"?T.then(n):n()}):n()}setBackend(R){this.backend=R,S&&(R?localStorage.setItem("remotestorage:backend",R):localStorage.removeItem("remotestorage:backend"))}onChange(R,F){this._pathHandlers.change[R]||(this._pathHandlers.change[R]=[]),this._pathHandlers.change[R].push(F)}enableLog(){A.default.logging=!0}disableLog(){A.default.logging=!1}log(...R){P.default.apply(q,R)}setApiKeys(R){const F=[J.GOOGLE,J.DROPBOX];if(typeof R!="object"||!Object.keys(R).every(n=>F.includes(n)))return console.error("setApiKeys() was called with invalid arguments"),!1;Object.keys(R).forEach(n=>{const s=R[n];if(s){switch(n){case J.DROPBOX:this.apiKeys[J.DROPBOX]={appKey:s},this.dropbox!==void 0&&this.dropbox.clientId===s||N.default._rs_init(this);break;case J.GOOGLE:this.apiKeys[J.GOOGLE]={clientId:s},this.googledrive!==void 0&&this.googledrive.clientId===s||m.default._rs_init(this)}return!0}delete this.apiKeys[n]}),S&&localStorage.setItem("remotestorage:api-keys",JSON.stringify(this.apiKeys))}setCordovaRedirectUri(R){if(typeof R!="string"||!R.match(/http(s)?:\/\//))throw new Error("Cordova redirect URI must be a URI string");A.default.cordovaRedirectUri=R}_setGPD(R,F){function n(s){return function(...T){return s.apply(F,T).then(v.bind(this))}}this.get=n(R.get),this.put=n(R.put),this.delete=n(R.delete)}_pendingGPD(R){return(...F)=>{const n=Array.prototype.slice.call(F);return new Promise((s,T)=>{this._pending.push({method:R,args:n,promise:{resolve:s,reject:T}})})}}_processPending(){this._pending.forEach(R=>{try{this[R.method](...R.args).then(R.promise.resolve,R.promise.reject)}catch(F){R.promise.reject(F)}}),this._pending=[]}_bindChange(R){R.on("change",this._dispatchEvent.bind(this,"change"))}_dispatchEvent(R,F){Object.keys(this._pathHandlers[R]).forEach(n=>{const s=n.length;F.path.substr(0,s)===n&&this._pathHandlers[R][n].forEach(T=>{const I={};for(const D in F)I[D]=F[D];I.relativePath=F.path.replace(new RegExp("^"+n),"");try{T(I)}catch(D){console.error("'change' handler failed: ",D,D.stack),this._emit("error",D)}})})}scope(R){if(typeof R!="string")throw"Argument 'path' of baseClient.scope must be a string";return this.access.checkPathPermission(R,"r")||console.warn("WARNING: Please use remoteStorage.access.claim() to ask for access permissions first: https://remotestoragejs.readthedocs.io/en/latest/js-api/access.html#claim"),new w.default(this,R)}getSyncInterval(){return A.default.syncInterval}setSyncInterval(R){if(!O(R))throw R+" is not a valid sync interval";const F=A.default.syncInterval;A.default.syncInterval=R,this._emit("sync-interval-change",{oldValue:F,newValue:R})}getBackgroundSyncInterval(){return A.default.backgroundSyncInterval}setBackgroundSyncInterval(R){if(!O(R))throw R+" is not a valid sync interval";const F=A.default.backgroundSyncInterval;A.default.backgroundSyncInterval=R,this._emit("sync-interval-change",{oldValue:F,newValue:R})}getCurrentSyncInterval(){return A.default.isBackground?A.default.backgroundSyncInterval:A.default.syncInterval}getRequestTimeout(){return A.default.requestTimeout}setRequestTimeout(R){if(typeof R!="number")throw R+" is not a valid request timeout";A.default.requestTimeout=R}syncCycle(){this.sync&&!this.sync.stopped&&(this.on("sync-done",()=>{this.sync&&!this.sync.stopped&&(this._syncTimer&&(clearTimeout(this._syncTimer),this._syncTimer=void 0),this._syncTimer=setTimeout(this.sync.sync.bind(this.sync),this.getCurrentSyncInterval()))}),this.sync.sync())}startSync(){return A.default.cache?(this.sync.stopped=!1,this.syncStopped=!1,this.sync.sync()):(console.warn("Nothing to sync, because caching is disabled."),Promise.resolve())}stopSync(){clearTimeout(this._syncTimer),this._syncTimer=void 0,this.sync?this.sync.stopped=!0:this.syncStopped=!0}addModule(R){const F=R.name,n=R.builder;if(Object.defineProperty(this,F,{configurable:!0,get:function(){const s=this._loadModule(F,n);return Object.defineProperty(this,F,{value:s}),s}}),F.indexOf("-")!==-1){const s=F.replace(/\-[a-z]/g,function(T){return T[1].toUpperCase()});Object.defineProperty(this,s,{get:function(){return this[F]}})}}_loadModule(R,F){if(F)return F(new w.default(this,"/"+R+"/"),new w.default(this,"/public/"+R+"/")).exports;throw"Unknown module: "+R}}var J;q.Authorize=x.default,q.SyncError=$.default,q.Unauthorized=C.default,q.DiscoveryError=M.default.DiscoveryError,q.util=c,Object.defineProperty(q.prototype,"access",{get:function(){const B=new k.default;return Object.defineProperty(this,"access",{value:B}),B},configurable:!0}),Object.defineProperty(q.prototype,"caching",{configurable:!0,get:function(){const B=new p.default;return Object.defineProperty(this,"caching",{value:B}),B}}),h.applyMixins(q,[_.default]),function(B){B.GOOGLE="googledrive",B.DROPBOX="dropbox"}(J||(J={})),i.exports=q},function(i,u,d){(function(l){/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */var g=d(20),y=d(21),b=d(22);function A(){return h.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function P(r,o){if(A()<o)throw new RangeError("Invalid typed array length");return h.TYPED_ARRAY_SUPPORT?(r=new Uint8Array(o)).__proto__=h.prototype:(r===null&&(r=new h(o)),r.length=o),r}function h(r,o,f){if(!(h.TYPED_ARRAY_SUPPORT||this instanceof h))return new h(r,o,f);if(typeof r=="number"){if(typeof o=="string")throw new Error("If encoding is specified then the first argument must be a string");return w(this,r)}return k(this,r,o,f)}function k(r,o,f,U){if(typeof o=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer<"u"&&o instanceof ArrayBuffer?function(j,L,z,Z){if(L.byteLength,z<0||L.byteLength<z)throw new RangeError("'offset' is out of bounds");if(L.byteLength<z+(Z||0))throw new RangeError("'length' is out of bounds");return L=z===void 0&&Z===void 0?new Uint8Array(L):Z===void 0?new Uint8Array(L,z):new Uint8Array(L,z,Z),h.TYPED_ARRAY_SUPPORT?(j=L).__proto__=h.prototype:j=p(j,L),j}(r,o,f,U):typeof o=="string"?function(j,L,z){if(typeof z=="string"&&z!==""||(z="utf8"),!h.isEncoding(z))throw new TypeError('"encoding" must be a valid string encoding');var Z=0|m(L,z),it=(j=P(j,Z)).write(L,z);return it!==Z&&(j=j.slice(0,it)),j}(r,o,f):function(j,L){if(h.isBuffer(L)){var z=0|_(L.length);return(j=P(j,z)).length===0||L.copy(j,0,0,z),j}if(L){if(typeof ArrayBuffer<"u"&&L.buffer instanceof ArrayBuffer||"length"in L)return typeof L.length!="number"||(Z=L.length)!=Z?P(j,0):p(j,L);if(L.type==="Buffer"&&b(L.data))return p(j,L.data)}var Z;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(r,o)}function x(r){if(typeof r!="number")throw new TypeError('"size" argument must be a number');if(r<0)throw new RangeError('"size" argument must not be negative')}function w(r,o){if(x(o),r=P(r,o<0?0:0|_(o)),!h.TYPED_ARRAY_SUPPORT)for(var f=0;f<o;++f)r[f]=0;return r}function p(r,o){var f=o.length<0?0:0|_(o.length);r=P(r,f);for(var U=0;U<f;U+=1)r[U]=255&o[U];return r}function _(r){if(r>=A())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+A().toString(16)+" bytes");return 0|r}function m(r,o){if(h.isBuffer(r))return r.length;if(typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(r)||r instanceof ArrayBuffer))return r.byteLength;typeof r!="string"&&(r=""+r);var f=r.length;if(f===0)return 0;for(var U=!1;;)switch(o){case"ascii":case"latin1":case"binary":return f;case"utf8":case"utf-8":case void 0:return at(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*f;case"hex":return f>>>1;case"base64":return ot(r).length;default:if(U)return at(r).length;o=(""+o).toLowerCase(),U=!0}}function N(r,o,f){var U=!1;if((o===void 0||o<0)&&(o=0),o>this.length||((f===void 0||f>this.length)&&(f=this.length),f<=0)||(f>>>=0)<=(o>>>=0))return"";for(r||(r="utf8");;)switch(r){case"hex":return F(this,o,f);case"utf8":case"utf-8":return J(this,o,f);case"ascii":return B(this,o,f);case"latin1":case"binary":return R(this,o,f);case"base64":return q(this,o,f);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return n(this,o,f);default:if(U)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),U=!0}}function M(r,o,f){var U=r[o];r[o]=r[f],r[f]=U}function $(r,o,f,U,j){if(r.length===0)return-1;if(typeof f=="string"?(U=f,f=0):f>2147483647?f=2147483647:f<-2147483648&&(f=-2147483648),f=+f,isNaN(f)&&(f=j?0:r.length-1),f<0&&(f=r.length+f),f>=r.length){if(j)return-1;f=r.length-1}else if(f<0){if(!j)return-1;f=0}if(typeof o=="string"&&(o=h.from(o,U)),h.isBuffer(o))return o.length===0?-1:C(r,o,f,U,j);if(typeof o=="number")return o&=255,h.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?j?Uint8Array.prototype.indexOf.call(r,o,f):Uint8Array.prototype.lastIndexOf.call(r,o,f):C(r,[o],f,U,j);throw new TypeError("val must be string, number or Buffer")}function C(r,o,f,U,j){var L,z=1,Z=r.length,it=o.length;if(U!==void 0&&((U=String(U).toLowerCase())==="ucs2"||U==="ucs-2"||U==="utf16le"||U==="utf-16le")){if(r.length<2||o.length<2)return-1;z=2,Z/=2,it/=2,f/=2}function nt(Tt,Dt){return z===1?Tt[Dt]:Tt.readUInt16BE(Dt*z)}if(j){var W=-1;for(L=f;L<Z;L++)if(nt(r,L)===nt(o,W===-1?0:L-W)){if(W===-1&&(W=L),L-W+1===it)return W*z}else W!==-1&&(L-=L-W),W=-1}else for(f+it>Z&&(f=Z-it),L=f;L>=0;L--){for(var mt=!0,wt=0;wt<it;wt++)if(nt(r,L+wt)!==nt(o,wt)){mt=!1;break}if(mt)return L}return-1}function e(r,o,f,U){f=Number(f)||0;var j=r.length-f;U?(U=Number(U))>j&&(U=j):U=j;var L=o.length;if(L%2!=0)throw new TypeError("Invalid hex string");U>L/2&&(U=L/2);for(var z=0;z<U;++z){var Z=parseInt(o.substr(2*z,2),16);if(isNaN(Z))return z;r[f+z]=Z}return z}function c(r,o,f,U){return Q(at(o,r.length-f),r,f,U)}function a(r,o,f,U){return Q(function(j){for(var L=[],z=0;z<j.length;++z)L.push(255&j.charCodeAt(z));return L}(o),r,f,U)}function S(r,o,f,U){return a(r,o,f,U)}function v(r,o,f,U){return Q(ot(o),r,f,U)}function O(r,o,f,U){return Q(function(j,L){for(var z,Z,it,nt=[],W=0;W<j.length&&!((L-=2)<0);++W)z=j.charCodeAt(W),Z=z>>8,it=z%256,nt.push(it),nt.push(Z);return nt}(o,r.length-f),r,f,U)}function q(r,o,f){return o===0&&f===r.length?g.fromByteArray(r):g.fromByteArray(r.slice(o,f))}function J(r,o,f){f=Math.min(r.length,f);for(var U=[],j=o;j<f;){var L,z,Z,it,nt=r[j],W=null,mt=nt>239?4:nt>223?3:nt>191?2:1;if(j+mt<=f)switch(mt){case 1:nt<128&&(W=nt);break;case 2:(192&(L=r[j+1]))==128&&(it=(31&nt)<<6|63&L)>127&&(W=it);break;case 3:L=r[j+1],z=r[j+2],(192&L)==128&&(192&z)==128&&(it=(15&nt)<<12|(63&L)<<6|63&z)>2047&&(it<55296||it>57343)&&(W=it);break;case 4:L=r[j+1],z=r[j+2],Z=r[j+3],(192&L)==128&&(192&z)==128&&(192&Z)==128&&(it=(15&nt)<<18|(63&L)<<12|(63&z)<<6|63&Z)>65535&&it<1114112&&(W=it)}W===null?(W=65533,mt=1):W>65535&&(W-=65536,U.push(W>>>10&1023|55296),W=56320|1023&W),U.push(W),j+=mt}return function(wt){var Tt=wt.length;if(Tt<=4096)return String.fromCharCode.apply(String,wt);for(var Dt="",Kt=0;Kt<Tt;)Dt+=String.fromCharCode.apply(String,wt.slice(Kt,Kt+=4096));return Dt}(U)}u.Buffer=h,u.SlowBuffer=function(r){return+r!=r&&(r=0),h.alloc(+r)},u.INSPECT_MAX_BYTES=50,h.TYPED_ARRAY_SUPPORT=l.TYPED_ARRAY_SUPPORT!==void 0?l.TYPED_ARRAY_SUPPORT:function(){try{var r=new Uint8Array(1);return r.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},r.foo()===42&&typeof r.subarray=="function"&&r.subarray(1,1).byteLength===0}catch{return!1}}(),u.kMaxLength=A(),h.poolSize=8192,h._augment=function(r){return r.__proto__=h.prototype,r},h.from=function(r,o,f){return k(null,r,o,f)},h.TYPED_ARRAY_SUPPORT&&(h.prototype.__proto__=Uint8Array.prototype,h.__proto__=Uint8Array,typeof Symbol<"u"&&Symbol.species&&h[Symbol.species]===h&&Object.defineProperty(h,Symbol.species,{value:null,configurable:!0})),h.alloc=function(r,o,f){return function(U,j,L,z){return x(j),j<=0?P(U,j):L!==void 0?typeof z=="string"?P(U,j).fill(L,z):P(U,j).fill(L):P(U,j)}(null,r,o,f)},h.allocUnsafe=function(r){return w(null,r)},h.allocUnsafeSlow=function(r){return w(null,r)},h.isBuffer=function(r){return!(r==null||!r._isBuffer)},h.compare=function(r,o){if(!h.isBuffer(r)||!h.isBuffer(o))throw new TypeError("Arguments must be Buffers");if(r===o)return 0;for(var f=r.length,U=o.length,j=0,L=Math.min(f,U);j<L;++j)if(r[j]!==o[j]){f=r[j],U=o[j];break}return f<U?-1:U<f?1:0},h.isEncoding=function(r){switch(String(r).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},h.concat=function(r,o){if(!b(r))throw new TypeError('"list" argument must be an Array of Buffers');if(r.length===0)return h.alloc(0);var f;if(o===void 0)for(o=0,f=0;f<r.length;++f)o+=r[f].length;var U=h.allocUnsafe(o),j=0;for(f=0;f<r.length;++f){var L=r[f];if(!h.isBuffer(L))throw new TypeError('"list" argument must be an Array of Buffers');L.copy(U,j),j+=L.length}return U},h.byteLength=m,h.prototype._isBuffer=!0,h.prototype.swap16=function(){var r=this.length;if(r%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var o=0;o<r;o+=2)M(this,o,o+1);return this},h.prototype.swap32=function(){var r=this.length;if(r%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var o=0;o<r;o+=4)M(this,o,o+3),M(this,o+1,o+2);return this},h.prototype.swap64=function(){var r=this.length;if(r%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var o=0;o<r;o+=8)M(this,o,o+7),M(this,o+1,o+6),M(this,o+2,o+5),M(this,o+3,o+4);return this},h.prototype.toString=function(){var r=0|this.length;return r===0?"":arguments.length===0?J(this,0,r):N.apply(this,arguments)},h.prototype.equals=function(r){if(!h.isBuffer(r))throw new TypeError("Argument must be a Buffer");return this===r||h.compare(this,r)===0},h.prototype.inspect=function(){var r="",o=u.INSPECT_MAX_BYTES;return this.length>0&&(r=this.toString("hex",0,o).match(/.{2}/g).join(" "),this.length>o&&(r+=" ... ")),"<Buffer "+r+">"},h.prototype.compare=function(r,o,f,U,j){if(!h.isBuffer(r))throw new TypeError("Argument must be a Buffer");if(o===void 0&&(o=0),f===void 0&&(f=r?r.length:0),U===void 0&&(U=0),j===void 0&&(j=this.length),o<0||f>r.length||U<0||j>this.length)throw new RangeError("out of range index");if(U>=j&&o>=f)return 0;if(U>=j)return-1;if(o>=f)return 1;if(this===r)return 0;for(var L=(j>>>=0)-(U>>>=0),z=(f>>>=0)-(o>>>=0),Z=Math.min(L,z),it=this.slice(U,j),nt=r.slice(o,f),W=0;W<Z;++W)if(it[W]!==nt[W]){L=it[W],z=nt[W];break}return L<z?-1:z<L?1:0},h.prototype.includes=function(r,o,f){return this.indexOf(r,o,f)!==-1},h.prototype.indexOf=function(r,o,f){return $(this,r,o,f,!0)},h.prototype.lastIndexOf=function(r,o,f){return $(this,r,o,f,!1)},h.prototype.write=function(r,o,f,U){if(o===void 0)U="utf8",f=this.length,o=0;else if(f===void 0&&typeof o=="string")U=o,f=this.length,o=0;else{if(!isFinite(o))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");o|=0,isFinite(f)?(f|=0,U===void 0&&(U="utf8")):(U=f,f=void 0)}var j=this.length-o;if((f===void 0||f>j)&&(f=j),r.length>0&&(f<0||o<0)||o>this.length)throw new RangeError("Attempt to write outside buffer bounds");U||(U="utf8");for(var L=!1;;)switch(U){case"hex":return e(this,r,o,f);case"utf8":case"utf-8":return c(this,r,o,f);case"ascii":return a(this,r,o,f);case"latin1":case"binary":return S(this,r,o,f);case"base64":return v(this,r,o,f);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,r,o,f);default:if(L)throw new TypeError("Unknown encoding: "+U);U=(""+U).toLowerCase(),L=!0}},h.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function B(r,o,f){var U="";f=Math.min(r.length,f);for(var j=o;j<f;++j)U+=String.fromCharCode(127&r[j]);return U}function R(r,o,f){var U="";f=Math.min(r.length,f);for(var j=o;j<f;++j)U+=String.fromCharCode(r[j]);return U}function F(r,o,f){var U=r.length;(!o||o<0)&&(o=0),(!f||f<0||f>U)&&(f=U);for(var j="",L=o;L<f;++L)j+=tt(r[L]);return j}function n(r,o,f){for(var U=r.slice(o,f),j="",L=0;L<U.length;L+=2)j+=String.fromCharCode(U[L]+256*U[L+1]);return j}function s(r,o,f){if(r%1!=0||r<0)throw new RangeError("offset is not uint");if(r+o>f)throw new RangeError("Trying to access beyond buffer length")}function T(r,o,f,U,j,L){if(!h.isBuffer(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(o>j||o<L)throw new RangeError('"value" argument is out of bounds');if(f+U>r.length)throw new RangeError("Index out of range")}function I(r,o,f,U){o<0&&(o=65535+o+1);for(var j=0,L=Math.min(r.length-f,2);j<L;++j)r[f+j]=(o&255<<8*(U?j:1-j))>>>8*(U?j:1-j)}function D(r,o,f,U){o<0&&(o=4294967295+o+1);for(var j=0,L=Math.min(r.length-f,4);j<L;++j)r[f+j]=o>>>8*(U?j:3-j)&255}function Y(r,o,f,U,j,L){if(f+U>r.length)throw new RangeError("Index out of range");if(f<0)throw new RangeError("Index out of range")}function G(r,o,f,U,j){return j||Y(r,0,f,4),y.write(r,o,f,U,23,4),f+4}function V(r,o,f,U,j){return j||Y(r,0,f,8),y.write(r,o,f,U,52,8),f+8}h.prototype.slice=function(r,o){var f,U=this.length;if((r=~~r)<0?(r+=U)<0&&(r=0):r>U&&(r=U),(o=o===void 0?U:~~o)<0?(o+=U)<0&&(o=0):o>U&&(o=U),o<r&&(o=r),h.TYPED_ARRAY_SUPPORT)(f=this.subarray(r,o)).__proto__=h.prototype;else{var j=o-r;f=new h(j,void 0);for(var L=0;L<j;++L)f[L]=this[L+r]}return f},h.prototype.readUIntLE=function(r,o,f){r|=0,o|=0,f||s(r,o,this.length);for(var U=this[r],j=1,L=0;++L<o&&(j*=256);)U+=this[r+L]*j;return U},h.prototype.readUIntBE=function(r,o,f){r|=0,o|=0,f||s(r,o,this.length);for(var U=this[r+--o],j=1;o>0&&(j*=256);)U+=this[r+--o]*j;return U},h.prototype.readUInt8=function(r,o){return o||s(r,1,this.length),this[r]},h.prototype.readUInt16LE=function(r,o){return o||s(r,2,this.length),this[r]|this[r+1]<<8},h.prototype.readUInt16BE=function(r,o){return o||s(r,2,this.length),this[r]<<8|this[r+1]},h.prototype.readUInt32LE=function(r,o){return o||s(r,4,this.length),(this[r]|this[r+1]<<8|this[r+2]<<16)+16777216*this[r+3]},h.prototype.readUInt32BE=function(r,o){return o||s(r,4,this.length),16777216*this[r]+(this[r+1]<<16|this[r+2]<<8|this[r+3])},h.prototype.readIntLE=function(r,o,f){r|=0,o|=0,f||s(r,o,this.length);for(var U=this[r],j=1,L=0;++L<o&&(j*=256);)U+=this[r+L]*j;return U>=(j*=128)&&(U-=Math.pow(2,8*o)),U},h.prototype.readIntBE=function(r,o,f){r|=0,o|=0,f||s(r,o,this.length);for(var U=o,j=1,L=this[r+--U];U>0&&(j*=256);)L+=this[r+--U]*j;return L>=(j*=128)&&(L-=Math.pow(2,8*o)),L},h.prototype.readInt8=function(r,o){return o||s(r,1,this.length),128&this[r]?-1*(255-this[r]+1):this[r]},h.prototype.readInt16LE=function(r,o){o||s(r,2,this.length);var f=this[r]|this[r+1]<<8;return 32768&f?4294901760|f:f},h.prototype.readInt16BE=function(r,o){o||s(r,2,this.length);var f=this[r+1]|this[r]<<8;return 32768&f?4294901760|f:f},h.prototype.readInt32LE=function(r,o){return o||s(r,4,this.length),this[r]|this[r+1]<<8|this[r+2]<<16|this[r+3]<<24},h.prototype.readInt32BE=function(r,o){return o||s(r,4,this.length),this[r]<<24|this[r+1]<<16|this[r+2]<<8|this[r+3]},h.prototype.readFloatLE=function(r,o){return o||s(r,4,this.length),y.read(this,r,!0,23,4)},h.prototype.readFloatBE=function(r,o){return o||s(r,4,this.length),y.read(this,r,!1,23,4)},h.prototype.readDoubleLE=function(r,o){return o||s(r,8,this.length),y.read(this,r,!0,52,8)},h.prototype.readDoubleBE=function(r,o){return o||s(r,8,this.length),y.read(this,r,!1,52,8)},h.prototype.writeUIntLE=function(r,o,f,U){r=+r,o|=0,f|=0,U||T(this,r,o,f,Math.pow(2,8*f)-1,0);var j=1,L=0;for(this[o]=255&r;++L<f&&(j*=256);)this[o+L]=r/j&255;return o+f},h.prototype.writeUIntBE=function(r,o,f,U){r=+r,o|=0,f|=0,U||T(this,r,o,f,Math.pow(2,8*f)-1,0);var j=f-1,L=1;for(this[o+j]=255&r;--j>=0&&(L*=256);)this[o+j]=r/L&255;return o+f},h.prototype.writeUInt8=function(r,o,f){return r=+r,o|=0,f||T(this,r,o,1,255,0),h.TYPED_ARRAY_SUPPORT||(r=Math.floor(r)),this[o]=255&r,o+1},h.prototype.writeUInt16LE=function(r,o,f){return r=+r,o|=0,f||T(this,r,o,2,65535,0),h.TYPED_ARRAY_SUPPORT?(this[o]=255&r,this[o+1]=r>>>8):I(this,r,o,!0),o+2},h.prototype.writeUInt16BE=function(r,o,f){return r=+r,o|=0,f||T(this,r,o,2,65535,0),h.TYPED_ARRAY_SUPPORT?(this[o]=r>>>8,this[o+1]=255&r):I(this,r,o,!1),o+2},h.prototype.writeUInt32LE=function(r,o,f){return r=+r,o|=0,f||T(this,r,o,4,4294967295,0),h.TYPED_ARRAY_SUPPORT?(this[o+3]=r>>>24,this[o+2]=r>>>16,this[o+1]=r>>>8,this[o]=255&r):D(this,r,o,!0),o+4},h.prototype.writeUInt32BE=function(r,o,f){return r=+r,o|=0,f||T(this,r,o,4,4294967295,0),h.TYPED_ARRAY_SUPPORT?(this[o]=r>>>24,this[o+1]=r>>>16,this[o+2]=r>>>8,this[o+3]=255&r):D(this,r,o,!1),o+4},h.prototype.writeIntLE=function(r,o,f,U){if(r=+r,o|=0,!U){var j=Math.pow(2,8*f-1);T(this,r,o,f,j-1,-j)}var L=0,z=1,Z=0;for(this[o]=255&r;++L<f&&(z*=256);)r<0&&Z===0&&this[o+L-1]!==0&&(Z=1),this[o+L]=(r/z>>0)-Z&255;return o+f},h.prototype.writeIntBE=function(r,o,f,U){if(r=+r,o|=0,!U){var j=Math.pow(2,8*f-1);T(this,r,o,f,j-1,-j)}var L=f-1,z=1,Z=0;for(this[o+L]=255&r;--L>=0&&(z*=256);)r<0&&Z===0&&this[o+L+1]!==0&&(Z=1),this[o+L]=(r/z>>0)-Z&255;return o+f},h.prototype.writeInt8=function(r,o,f){return r=+r,o|=0,f||T(this,r,o,1,127,-128),h.TYPED_ARRAY_SUPPORT||(r=Math.floor(r)),r<0&&(r=255+r+1),this[o]=255&r,o+1},h.prototype.writeInt16LE=function(r,o,f){return r=+r,o|=0,f||T(this,r,o,2,32767,-32768),h.TYPED_ARRAY_SUPPORT?(this[o]=255&r,this[o+1]=r>>>8):I(this,r,o,!0),o+2},h.prototype.writeInt16BE=function(r,o,f){return r=+r,o|=0,f||T(this,r,o,2,32767,-32768),h.TYPED_ARRAY_SUPPORT?(this[o]=r>>>8,this[o+1]=255&r):I(this,r,o,!1),o+2},h.prototype.writeInt32LE=function(r,o,f){return r=+r,o|=0,f||T(this,r,o,4,2147483647,-2147483648),h.TYPED_ARRAY_SUPPORT?(this[o]=255&r,this[o+1]=r>>>8,this[o+2]=r>>>16,this[o+3]=r>>>24):D(this,r,o,!0),o+4},h.prototype.writeInt32BE=function(r,o,f){return r=+r,o|=0,f||T(this,r,o,4,2147483647,-2147483648),r<0&&(r=4294967295+r+1),h.TYPED_ARRAY_SUPPORT?(this[o]=r>>>24,this[o+1]=r>>>16,this[o+2]=r>>>8,this[o+3]=255&r):D(this,r,o,!1),o+4},h.prototype.writeFloatLE=function(r,o,f){return G(this,r,o,!0,f)},h.prototype.writeFloatBE=function(r,o,f){return G(this,r,o,!1,f)},h.prototype.writeDoubleLE=function(r,o,f){return V(this,r,o,!0,f)},h.prototype.writeDoubleBE=function(r,o,f){return V(this,r,o,!1,f)},h.prototype.copy=function(r,o,f,U){if(f||(f=0),U||U===0||(U=this.length),o>=r.length&&(o=r.length),o||(o=0),U>0&&U<f&&(U=f),U===f||r.length===0||this.length===0)return 0;if(o<0)throw new RangeError("targetStart out of bounds");if(f<0||f>=this.length)throw new RangeError("sourceStart out of bounds");if(U<0)throw new RangeError("sourceEnd out of bounds");U>this.length&&(U=this.length),r.length-o<U-f&&(U=r.length-o+f);var j,L=U-f;if(this===r&&f<o&&o<U)for(j=L-1;j>=0;--j)r[j+o]=this[j+f];else if(L<1e3||!h.TYPED_ARRAY_SUPPORT)for(j=0;j<L;++j)r[j+o]=this[j+f];else Uint8Array.prototype.set.call(r,this.subarray(f,f+L),o);return L},h.prototype.fill=function(r,o,f,U){if(typeof r=="string"){if(typeof o=="string"?(U=o,o=0,f=this.length):typeof f=="string"&&(U=f,f=this.length),r.length===1){var j=r.charCodeAt(0);j<256&&(r=j)}if(U!==void 0&&typeof U!="string")throw new TypeError("encoding must be a string");if(typeof U=="string"&&!h.isEncoding(U))throw new TypeError("Unknown encoding: "+U)}else typeof r=="number"&&(r&=255);if(o<0||this.length<o||this.length<f)throw new RangeError("Out of range index");if(f<=o)return this;var L;if(o>>>=0,f=f===void 0?this.length:f>>>0,r||(r=0),typeof r=="number")for(L=o;L<f;++L)this[L]=r;else{var z=h.isBuffer(r)?r:at(new h(r,U).toString()),Z=z.length;for(L=0;L<f-o;++L)this[L+o]=z[L%Z]}return this};var H=/[^+\/0-9A-Za-z-_]/g;function tt(r){return r<16?"0"+r.toString(16):r.toString(16)}function at(r,o){var f;o=o||1/0;for(var U=r.length,j=null,L=[],z=0;z<U;++z){if((f=r.charCodeAt(z))>55295&&f<57344){if(!j){if(f>56319){(o-=3)>-1&&L.push(239,191,189);continue}if(z+1===U){(o-=3)>-1&&L.push(239,191,189);continue}j=f;continue}if(f<56320){(o-=3)>-1&&L.push(239,191,189),j=f;continue}f=65536+(j-55296<<10|f-56320)}else j&&(o-=3)>-1&&L.push(239,191,189);if(j=null,f<128){if((o-=1)<0)break;L.push(f)}else if(f<2048){if((o-=2)<0)break;L.push(f>>6|192,63&f|128)}else if(f<65536){if((o-=3)<0)break;L.push(f>>12|224,f>>6&63|128,63&f|128)}else{if(!(f<1114112))throw new Error("Invalid code point");if((o-=4)<0)break;L.push(f>>18|240,f>>12&63|128,f>>6&63|128,63&f|128)}}return L}function ot(r){return g.toByteArray(function(o){if((o=function(f){return f.trim?f.trim():f.replace(/^\s+|\s+$/g,"")}(o).replace(H,"")).length<2)return"";for(;o.length%4!=0;)o+="=";return o}(r))}function Q(r,o,f,U){for(var j=0;j<U&&!(j+f>=o.length||j>=r.length);++j)o[j+f]=r[j];return j}}).call(this,d(5))},function(i,u,d){u.byteLength=function(x){var w=h(x),p=w[0],_=w[1];return 3*(p+_)/4-_},u.toByteArray=function(x){var w,p,_=h(x),m=_[0],N=_[1],M=new y(function(e,c,a){return 3*(c+a)/4-a}(0,m,N)),$=0,C=N>0?m-4:m;for(p=0;p<C;p+=4)w=g[x.charCodeAt(p)]<<18|g[x.charCodeAt(p+1)]<<12|g[x.charCodeAt(p+2)]<<6|g[x.charCodeAt(p+3)],M[$++]=w>>16&255,M[$++]=w>>8&255,M[$++]=255&w;return N===2&&(w=g[x.charCodeAt(p)]<<2|g[x.charCodeAt(p+1)]>>4,M[$++]=255&w),N===1&&(w=g[x.charCodeAt(p)]<<10|g[x.charCodeAt(p+1)]<<4|g[x.charCodeAt(p+2)]>>2,M[$++]=w>>8&255,M[$++]=255&w),M},u.fromByteArray=function(x){for(var w,p=x.length,_=p%3,m=[],N=0,M=p-_;N<M;N+=16383)m.push(k(x,N,N+16383>M?M:N+16383));return _===1?(w=x[p-1],m.push(l[w>>2]+l[w<<4&63]+"==")):_===2&&(w=(x[p-2]<<8)+x[p-1],m.push(l[w>>10]+l[w>>4&63]+l[w<<2&63]+"=")),m.join("")};for(var l=[],g=[],y=typeof Uint8Array<"u"?Uint8Array:Array,b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",A=0,P=b.length;A<P;++A)l[A]=b[A],g[b.charCodeAt(A)]=A;function h(x){var w=x.length;if(w%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var p=x.indexOf("=");return p===-1&&(p=w),[p,p===w?0:4-p%4]}function k(x,w,p){for(var _,m,N=[],M=w;M<p;M+=3)_=(x[M]<<16&16711680)+(x[M+1]<<8&65280)+(255&x[M+2]),N.push(l[(m=_)>>18&63]+l[m>>12&63]+l[m>>6&63]+l[63&m]);return N.join("")}g["-".charCodeAt(0)]=62,g["_".charCodeAt(0)]=63},function(i,u){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */u.read=function(d,l,g,y,b){var A,P,h=8*b-y-1,k=(1<<h)-1,x=k>>1,w=-7,p=g?b-1:0,_=g?-1:1,m=d[l+p];for(p+=_,A=m&(1<<-w)-1,m>>=-w,w+=h;w>0;A=256*A+d[l+p],p+=_,w-=8);for(P=A&(1<<-w)-1,A>>=-w,w+=y;w>0;P=256*P+d[l+p],p+=_,w-=8);if(A===0)A=1-x;else{if(A===k)return P?NaN:1/0*(m?-1:1);P+=Math.pow(2,y),A-=x}return(m?-1:1)*P*Math.pow(2,A-y)},u.write=function(d,l,g,y,b,A){var P,h,k,x=8*A-b-1,w=(1<<x)-1,p=w>>1,_=b===23?Math.pow(2,-24)-Math.pow(2,-77):0,m=y?0:A-1,N=y?1:-1,M=l<0||l===0&&1/l<0?1:0;for(l=Math.abs(l),isNaN(l)||l===1/0?(h=isNaN(l)?1:0,P=w):(P=Math.floor(Math.log(l)/Math.LN2),l*(k=Math.pow(2,-P))<1&&(P--,k*=2),(l+=P+p>=1?_/k:_*Math.pow(2,1-p))*k>=2&&(P++,k/=2),P+p>=w?(h=0,P=w):P+p>=1?(h=(l*k-1)*Math.pow(2,b),P+=p):(h=l*Math.pow(2,p-1)*Math.pow(2,b),P=0));b>=8;d[g+m]=255&h,m+=N,h/=256,b-=8);for(P=P<<b|h,x+=b;x>0;d[g+m]=255&P,m+=N,P/=256,x-=8);d[g+m-N]|=128*M}},function(i,u){var d={}.toString;i.exports=Array.isArray||function(l){return d.call(l)=="[object Array]"}},function(i,u,d){var l,g,y;g=[],(y=typeof(l=function(){var b,A,P,h;Object.keys||(Object.keys=(b=Object.prototype.hasOwnProperty,A=!{toString:null}.propertyIsEnumerable("toString"),h=(P=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(n){if(typeof n!="object"&&typeof n!="function"||n===null)throw new TypeError("Object.keys called on non-object");var s=[];for(var T in n)b.call(n,T)&&s.push(T);if(A)for(var I=0;I<h;I++)b.call(n,P[I])&&s.push(P[I]);return s})),Object.create||(Object.create=function(){function n(){}return function(s){if(arguments.length!==1)throw new Error("Object.create implementation only accepts one parameter.");return n.prototype=s,new n}}()),Array.isArray||(Array.isArray=function(n){return Object.prototype.toString.call(n)==="[object Array]"}),Array.prototype.indexOf||(Array.prototype.indexOf=function(n){if(this===null)throw new TypeError;var s=Object(this),T=s.length>>>0;if(T===0)return-1;var I=0;if(arguments.length>1&&((I=Number(arguments[1]))!=I?I=0:I!==0&&I!==1/0&&I!==-1/0&&(I=(I>0||-1)*Math.floor(Math.abs(I)))),I>=T)return-1;for(var D=I>=0?I:Math.max(T-Math.abs(I),0);D<T;D++)if(D in s&&s[D]===n)return D;return-1}),Object.isFrozen||(Object.isFrozen=function(n){for(var s="tv4_test_frozen_key";n.hasOwnProperty(s);)s+=Math.random();try{return n[s]=!0,delete n[s],!1}catch{return!0}});var k={"+":!0,"#":!0,".":!0,"/":!0,";":!0,"?":!0,"&":!0},x={"*":!0};function w(n){return encodeURI(n).replace(/%25[0-9][0-9]/g,function(s){return"%"+s.substring(3)})}function p(n){var s="";k[n.charAt(0)]&&(s=n.charAt(0),n=n.substring(1));var T="",I="",D=!0,Y=!1,G=!1;s==="+"?D=!1:s==="."?(I=".",T="."):s==="/"?(I="/",T="/"):s==="#"?(I="#",D=!1):s===";"?(I=";",T=";",Y=!0,G=!0):s==="?"?(I="?",T="&",Y=!0):s==="&"&&(I="&",T="&",Y=!0);for(var V=[],H=n.split(","),tt=[],at={},ot=0;ot<H.length;ot++){var Q=H[ot],r=null;if(Q.indexOf(":")!==-1){var o=Q.split(":");Q=o[0],r=parseInt(o[1],10)}for(var f={};x[Q.charAt(Q.length-1)];)f[Q.charAt(Q.length-1)]=!0,Q=Q.substring(0,Q.length-1);var U={truncate:r,name:Q,suffices:f};tt.push(U),at[Q]=U,V.push(Q)}var j=function(L){for(var z="",Z=0,it=0;it<tt.length;it++){var nt=tt[it],W=L(nt.name);if(W==null||Array.isArray(W)&&W.length===0||typeof W=="object"&&Object.keys(W).length===0)Z++;else if(z+=it===Z?I:T||",",Array.isArray(W)){Y&&(z+=nt.name+"=");for(var mt=0;mt<W.length;mt++)mt>0&&(z+=nt.suffices["*"]&&T||",",nt.suffices["*"]&&Y&&(z+=nt.name+"=")),z+=D?encodeURIComponent(W[mt]).replace(/!/g,"%21"):w(W[mt])}else if(typeof W=="object"){Y&&!nt.suffices["*"]&&(z+=nt.name+"=");var wt=!0;for(var Tt in W)wt||(z+=nt.suffices["*"]&&T||","),wt=!1,z+=D?encodeURIComponent(Tt).replace(/!/g,"%21"):w(Tt),z+=nt.suffices["*"]?"=":",",z+=D?encodeURIComponent(W[Tt]).replace(/!/g,"%21"):w(W[Tt])}else Y&&(z+=nt.name,G&&W===""||(z+="=")),nt.truncate!=null&&(W=W.substring(0,nt.truncate)),z+=D?encodeURIComponent(W).replace(/!/g,"%21"):w(W)}return z};return j.varNames=V,{prefix:I,substitution:j}}function _(n){if(!(this instanceof _))return new _(n);for(var s=n.split("{"),T=[s.shift()],I=[],D=[],Y=[];s.length>0;){var G=s.shift(),V=G.split("}")[0],H=G.substring(V.length+1),tt=p(V);D.push(tt.substitution),I.push(tt.prefix),T.push(H),Y=Y.concat(tt.substitution.varNames)}this.fill=function(at){for(var ot=T[0],Q=0;Q<D.length;Q++)ot+=(0,D[Q])(at),ot+=T[Q+1];return ot},this.varNames=Y,this.template=n}_.prototype={toString:function(){return this.template},fillFromObject:function(n){return this.fill(function(s){return n[s]})}};var m=function(n,s,T,I,D){if(this.missing=[],this.missingMap={},this.formatValidators=n?Object.create(n.formatValidators):{},this.schemas=n?Object.create(n.schemas):{},this.collectMultiple=s,this.errors=[],this.handleError=s?this.collectError:this.returnError,I&&(this.checkRecursive=!0,this.scanned=[],this.scannedFrozen=[],this.scannedFrozenSchemas=[],this.scannedFrozenValidationErrors=[],this.validatedSchemasKey="tv4_validation_id",this.validationErrorsKey="tv4_validation_errors_id"),D&&(this.trackUnknownProperties=!0,this.knownPropertyPaths={},this.unknownPropertyPaths={}),this.errorReporter=T||S("en"),typeof this.errorReporter=="string")throw new Error("debug");if(this.definedKeywords={},n)for(var Y in n.definedKeywords)this.definedKeywords[Y]=n.definedKeywords[Y].slice(0)};function N(n,s){if(n===s)return!0;if(n&&s&&typeof n=="object"&&typeof s=="object"){if(Array.isArray(n)!==Array.isArray(s))return!1;if(Array.isArray(n)){if(n.length!==s.length)return!1;for(var T=0;T<n.length;T++)if(!N(n[T],s[T]))return!1}else{var I;for(I in n)if(s[I]===void 0&&n[I]!==void 0)return!1;for(I in s)if(n[I]===void 0&&s[I]!==void 0)return!1;for(I in n)if(!N(n[I],s[I]))return!1}return!0}return!1}m.prototype.defineKeyword=function(n,s){this.definedKeywords[n]=this.definedKeywords[n]||[],this.definedKeywords[n].push(s)},m.prototype.createError=function(n,s,T,I,D,Y,G){var V=new B(n,s,T,I,D);return V.message=this.errorReporter(V,Y,G),V},m.prototype.returnError=function(n){return n},m.prototype.collectError=function(n){return n&&this.errors.push(n),null},m.prototype.prefixErrors=function(n,s,T){for(var I=n;I<this.errors.length;I++)this.errors[I]=this.errors[I].prefixWith(s,T);return this},m.prototype.banUnknownProperties=function(n,s){for(var T in this.unknownPropertyPaths){var I=this.createError(v.UNKNOWN_PROPERTY,{path:T},T,"",null,n,s),D=this.handleError(I);if(D)return D}return null},m.prototype.addFormat=function(n,s){if(typeof n=="object"){for(var T in n)this.addFormat(T,n[T]);return this}this.formatValidators[n]=s},m.prototype.resolveRefs=function(n,s){if(n.$ref!==void 0){if((s=s||{})[n.$ref])return this.createError(v.CIRCULAR_REFERENCE,{urls:Object.keys(s).join(", ")},"","",null,void 0,n);s[n.$ref]=!0,n=this.getSchema(n.$ref,s)}return n},m.prototype.getSchema=function(n,s){var T;if(this.schemas[n]!==void 0)return T=this.schemas[n],this.resolveRefs(T,s);var I=n,D="";if(n.indexOf("#")!==-1&&(D=n.substring(n.indexOf("#")+1),I=n.substring(0,n.indexOf("#"))),typeof this.schemas[I]=="object"){T=this.schemas[I];var Y=decodeURIComponent(D);if(Y==="")return this.resolveRefs(T,s);if(Y.charAt(0)!=="/")return;for(var G=Y.split("/").slice(1),V=0;V<G.length;V++){var H=G[V].replace(/~1/g,"/").replace(/~0/g,"~");if(T[H]===void 0){T=void 0;break}T=T[H]}if(T!==void 0)return this.resolveRefs(T,s)}this.missing[I]===void 0&&(this.missing.push(I),this.missing[I]=I,this.missingMap[I]=I)},m.prototype.searchSchemas=function(n,s){if(Array.isArray(n))for(var T=0;T<n.length;T++)this.searchSchemas(n[T],s);else if(n&&typeof n=="object"){for(var I in typeof n.id=="string"&&function(Y,G){if(G.substring(0,Y.length)===Y){var V=G.substring(Y.length);if(G.length>0&&G.charAt(Y.length-1)==="/"||V.charAt(0)==="#"||V.charAt(0)==="?")return!0}return!1}(s,n.id)&&this.schemas[n.id]===void 0&&(this.schemas[n.id]=n),n)if(I!=="enum"){if(typeof n[I]=="object")this.searchSchemas(n[I],s);else if(I==="$ref"){var D=c(n[I]);D&&this.schemas[D]===void 0&&this.missingMap[D]===void 0&&(this.missingMap[D]=D)}}}},m.prototype.addSchema=function(n,s){if(typeof n!="string"||s===void 0){if(typeof n!="object"||typeof n.id!="string")return;n=(s=n).id}n===c(n)+"#"&&(n=c(n)),this.schemas[n]=s,delete this.missingMap[n],a(s,n),this.searchSchemas(s,n)},m.prototype.getSchemaMap=function(){var n={};for(var s in this.schemas)n[s]=this.schemas[s];return n},m.prototype.getSchemaUris=function(n){var s=[];for(var T in this.schemas)n&&!n.test(T)||s.push(T);return s},m.prototype.getMissingUris=function(n){var s=[];for(var T in this.missingMap)n&&!n.test(T)||s.push(T);return s},m.prototype.dropSchemas=function(){this.schemas={},this.reset()},m.prototype.reset=function(){this.missing=[],this.missingMap={},this.errors=[]},m.prototype.validateAll=function(n,s,T,I,D){var Y;if(!(s=this.resolveRefs(s)))return null;if(s instanceof B)return this.errors.push(s),s;var G,V=this.errors.length,H=null,tt=null;if(this.checkRecursive&&n&&typeof n=="object"){if(Y=!this.scanned.length,n[this.validatedSchemasKey]){var at=n[this.validatedSchemasKey].indexOf(s);if(at!==-1)return this.errors=this.errors.concat(n[this.validationErrorsKey][at]),null}if(Object.isFrozen(n)&&(G=this.scannedFrozen.indexOf(n))!==-1){var ot=this.scannedFrozenSchemas[G].indexOf(s);if(ot!==-1)return this.errors=this.errors.concat(this.scannedFrozenValidationErrors[G][ot]),null}if(this.scanned.push(n),Object.isFrozen(n))G===-1&&(G=this.scannedFrozen.length,this.scannedFrozen.push(n),this.scannedFrozenSchemas.push([])),H=this.scannedFrozenSchemas[G].length,this.scannedFrozenSchemas[G][H]=s,this.scannedFrozenValidationErrors[G][H]=[];else{if(!n[this.validatedSchemasKey])try{Object.defineProperty(n,this.validatedSchemasKey,{value:[],configurable:!0}),Object.defineProperty(n,this.validationErrorsKey,{value:[],configurable:!0})}catch{n[this.validatedSchemasKey]=[],n[this.validationErrorsKey]=[]}tt=n[this.validatedSchemasKey].length,n[this.validatedSchemasKey][tt]=s,n[this.validationErrorsKey][tt]=[]}}var Q=this.errors.length,r=this.validateBasic(n,s,D)||this.validateNumeric(n,s,D)||this.validateString(n,s,D)||this.validateArray(n,s,D)||this.validateObject(n,s,D)||this.validateCombinations(n,s,D)||this.validateHypermedia(n,s,D)||this.validateFormat(n,s,D)||this.validateDefinedKeywords(n,s,D)||null;if(Y){for(;this.scanned.length;)delete this.scanned.pop()[this.validatedSchemasKey];this.scannedFrozen=[],this.scannedFrozenSchemas=[]}if(r||Q!==this.errors.length)for(;T&&T.length||I&&I.length;){var o=T&&T.length?""+T.pop():null,f=I&&I.length?""+I.pop():null;r&&(r=r.prefixWith(o,f)),this.prefixErrors(Q,o,f)}return H!==null?this.scannedFrozenValidationErrors[G][H]=this.errors.slice(V):tt!==null&&(n[this.validationErrorsKey][tt]=this.errors.slice(V)),this.handleError(r)},m.prototype.validateFormat=function(n,s){if(typeof s.format!="string"||!this.formatValidators[s.format])return null;var T=this.formatValidators[s.format].call(null,n,s);return typeof T=="string"||typeof T=="number"?this.createError(v.FORMAT_CUSTOM,{message:T},"","/format",null,n,s):T&&typeof T=="object"?this.createError(v.FORMAT_CUSTOM,{message:T.message||"?"},T.dataPath||"",T.schemaPath||"/format",null,n,s):null},m.prototype.validateDefinedKeywords=function(n,s,T){for(var I in this.definedKeywords)if(s[I]!==void 0)for(var D=this.definedKeywords[I],Y=0;Y<D.length;Y++){var G=(0,D[Y])(n,s[I],s,T);if(typeof G=="string"||typeof G=="number")return this.createError(v.KEYWORD_CUSTOM,{key:I,message:G},"","",null,n,s).prefixWith(null,I);if(G&&typeof G=="object"){var V=G.code;if(typeof V=="string"){if(!v[V])throw new Error("Undefined error code (use defineError): "+V);V=v[V]}else typeof V!="number"&&(V=v.KEYWORD_CUSTOM);var H=typeof G.message=="object"?G.message:{key:I,message:G.message||"?"},tt=G.schemaPath||"/"+I.replace(/~/g,"~0").replace(/\//g,"~1");return this.createError(V,H,G.dataPath||null,tt,null,n,s)}}return null},m.prototype.validateBasic=function(n,s,T){var I;return(I=this.validateType(n,s,T))||(I=this.validateEnum(n,s,T))?I.prefixWith(null,"type"):null},m.prototype.validateType=function(n,s){if(s.type===void 0)return null;var T=typeof n;n===null?T="null":Array.isArray(n)&&(T="array");var I=s.type;Array.isArray(I)||(I=[I]);for(var D=0;D<I.length;D++){var Y=I[D];if(Y===T||Y==="integer"&&T==="number"&&n%1==0)return null}return this.createError(v.INVALID_TYPE,{type:T,expected:I.join("/")},"","",null,n,s)},m.prototype.validateEnum=function(n,s){if(s.enum===void 0)return null;for(var T=0;T<s.enum.length;T++)if(N(n,s.enum[T]))return null;return this.createError(v.ENUM_MISMATCH,{value:typeof JSON<"u"?JSON.stringify(n):n},"","",null,n,s)},m.prototype.validateNumeric=function(n,s,T){return this.validateMultipleOf(n,s,T)||this.validateMinMax(n,s,T)||this.validateNaN(n,s,T)||null};var M=Math.pow(2,-51),$=1-M;function C(n){var s=String(n).replace(/^\s+|\s+$/g,"").match(/^([^:\/?#]+:)?(\/\/(?:[^:@]*(?::[^:@]*)?@)?(([^:\/?#]*)(?::(\d*))?))?([^?#]*)(\?[^#]*)?(#[\s\S]*)?/);return s?{href:s[0]||"",protocol:s[1]||"",authority:s[2]||"",host:s[3]||"",hostname:s[4]||"",port:s[5]||"",pathname:s[6]||"",search:s[7]||"",hash:s[8]||""}:null}function e(n,s){return s=C(s||""),n=C(n||""),s&&n?(s.protocol||n.protocol)+(s.protocol||s.authority?s.authority:n.authority)+(T=s.protocol||s.authority||s.pathname.charAt(0)==="/"?s.pathname:s.pathname?(n.authority&&!n.pathname?"/":"")+n.pathname.slice(0,n.pathname.lastIndexOf("/")+1)+s.pathname:n.pathname,I=[],T.replace(/^(\.\.?(\/|$))+/,"").replace(/\/(\.(\/|$))+/g,"/").replace(/\/\.\.$/,"/../").replace(/\/?[^\/]*/g,function(D){D==="/.."?I.pop():I.push(D)}),I.join("").replace(/^\//,T.charAt(0)==="/"?"/":""))+(s.protocol||s.authority||s.pathname?s.search:s.search||n.search)+s.hash:null;var T,I}function c(n){return n.split("#")[0]}function a(n,s){if(n&&typeof n=="object")if(s===void 0?s=n.id:typeof n.id=="string"&&(s=e(s,n.id),n.id=s),Array.isArray(n))for(var T=0;T<n.length;T++)a(n[T],s);else for(var I in typeof n.$ref=="string"&&(n.$ref=e(s,n.$ref)),n)I!=="enum"&&a(n[I],s)}function S(n){var s=R[n=n||"en"];return function(T){var I=s[T.code]||J[T.code];if(typeof I!="string")return"Unknown error code "+T.code+": "+JSON.stringify(T.messageParams);var D=T.params;return I.replace(/\{([^{}]*)\}/g,function(Y,G){var V=D[G];return typeof V=="string"||typeof V=="number"?V:Y})}}m.prototype.validateMultipleOf=function(n,s){var T=s.multipleOf||s.divisibleBy;if(T===void 0)return null;if(typeof n=="number"){var I=n/T%1;if(I>=M&&I<$)return this.createError(v.NUMBER_MULTIPLE_OF,{value:n,multipleOf:T},"","",null,n,s)}return null},m.prototype.validateMinMax=function(n,s){if(typeof n!="number")return null;if(s.minimum!==void 0){if(n<s.minimum)return this.createError(v.NUMBER_MINIMUM,{value:n,minimum:s.minimum},"","/minimum",null,n,s);if(s.exclusiveMinimum&&n===s.minimum)return this.createError(v.NUMBER_MINIMUM_EXCLUSIVE,{value:n,minimum:s.minimum},"","/exclusiveMinimum",null,n,s)}if(s.maximum!==void 0){if(n>s.maximum)return this.createError(v.NUMBER_MAXIMUM,{value:n,maximum:s.maximum},"","/maximum",null,n,s);if(s.exclusiveMaximum&&n===s.maximum)return this.createError(v.NUMBER_MAXIMUM_EXCLUSIVE,{value:n,maximum:s.maximum},"","/exclusiveMaximum",null,n,s)}return null},m.prototype.validateNaN=function(n,s){return typeof n!="number"?null:isNaN(n)===!0||n===1/0||n===-1/0?this.createError(v.NUMBER_NOT_A_NUMBER,{value:n},"","/type",null,n,s):null},m.prototype.validateString=function(n,s,T){return this.validateStringLength(n,s,T)||this.validateStringPattern(n,s,T)||null},m.prototype.validateStringLength=function(n,s){return typeof n!="string"?null:s.minLength!==void 0&&n.length<s.minLength?this.createError(v.STRING_LENGTH_SHORT,{length:n.length,minimum:s.minLength},"","/minLength",null,n,s):s.maxLength!==void 0&&n.length>s.maxLength?this.createError(v.STRING_LENGTH_LONG,{length:n.length,maximum:s.maxLength},"","/maxLength",null,n,s):null},m.prototype.validateStringPattern=function(n,s){if(typeof n!="string"||typeof s.pattern!="string"&&!(s.pattern instanceof RegExp))return null;var T;if(s.pattern instanceof RegExp)T=s.pattern;else{var I,D="",Y=s.pattern.match(/^\/(.+)\/([img]*)$/);Y?(I=Y[1],D=Y[2]):I=s.pattern,T=new RegExp(I,D)}return T.test(n)?null:this.createError(v.STRING_PATTERN,{pattern:s.pattern},"","/pattern",null,n,s)},m.prototype.validateArray=function(n,s,T){return Array.isArray(n)&&(this.validateArrayLength(n,s,T)||this.validateArrayUniqueItems(n,s,T)||this.validateArrayItems(n,s,T))||null},m.prototype.validateArrayLength=function(n,s){var T;return s.minItems!==void 0&&n.length<s.minItems&&(T=this.createError(v.ARRAY_LENGTH_SHORT,{length:n.length,minimum:s.minItems},"","/minItems",null,n,s),this.handleError(T))||s.maxItems!==void 0&&n.length>s.maxItems&&(T=this.createError(v.ARRAY_LENGTH_LONG,{length:n.length,maximum:s.maxItems},"","/maxItems",null,n,s),this.handleError(T))?T:null},m.prototype.validateArrayUniqueItems=function(n,s){if(s.uniqueItems){for(var T=0;T<n.length;T++)for(var I=T+1;I<n.length;I++)if(N(n[T],n[I])){var D=this.createError(v.ARRAY_UNIQUE,{match1:T,match2:I},"","/uniqueItems",null,n,s);if(this.handleError(D))return D}}return null},m.prototype.validateArrayItems=function(n,s,T){if(s.items===void 0)return null;var I,D;if(Array.isArray(s.items)){for(D=0;D<n.length;D++)if(D<s.items.length){if(I=this.validateAll(n[D],s.items[D],[D],["items",D],T+"/"+D))return I}else if(s.additionalItems!==void 0){if(typeof s.additionalItems=="boolean"){if(!s.additionalItems&&(I=this.createError(v.ARRAY_ADDITIONAL_ITEMS,{},"/"+D,"/additionalItems",null,n,s),this.handleError(I)))return I}else if(I=this.validateAll(n[D],s.additionalItems,[D],["additionalItems"],T+"/"+D))return I}}else for(D=0;D<n.length;D++)if(I=this.validateAll(n[D],s.items,[D],["items"],T+"/"+D))return I;return null},m.prototype.validateObject=function(n,s,T){return typeof n!="object"||n===null||Array.isArray(n)?null:this.validateObjectMinMaxProperties(n,s,T)||this.validateObjectRequiredProperties(n,s,T)||this.validateObjectProperties(n,s,T)||this.validateObjectDependencies(n,s,T)||null},m.prototype.validateObjectMinMaxProperties=function(n,s){var T,I=Object.keys(n);return s.minProperties!==void 0&&I.length<s.minProperties&&(T=this.createError(v.OBJECT_PROPERTIES_MINIMUM,{propertyCount:I.length,minimum:s.minProperties},"","/minProperties",null,n,s),this.handleError(T))||s.maxProperties!==void 0&&I.length>s.maxProperties&&(T=this.createError(v.OBJECT_PROPERTIES_MAXIMUM,{propertyCount:I.length,maximum:s.maxProperties},"","/maxProperties",null,n,s),this.handleError(T))?T:null},m.prototype.validateObjectRequiredProperties=function(n,s){if(s.required!==void 0)for(var T=0;T<s.required.length;T++){var I=s.required[T];if(n[I]===void 0){var D=this.createError(v.OBJECT_REQUIRED,{key:I},"","/required/"+T,null,n,s);if(this.handleError(D))return D}}return null},m.prototype.validateObjectProperties=function(n,s,T){var I;for(var D in n){var Y=T+"/"+D.replace(/~/g,"~0").replace(/\//g,"~1"),G=!1;if(s.properties!==void 0&&s.properties[D]!==void 0&&(G=!0,I=this.validateAll(n[D],s.properties[D],[D],["properties",D],Y)))return I;if(s.patternProperties!==void 0){for(var V in s.patternProperties)if(new RegExp(V).test(D)&&(G=!0,I=this.validateAll(n[D],s.patternProperties[V],[D],["patternProperties",V],Y)))return I}if(G)this.trackUnknownProperties&&(this.knownPropertyPaths[Y]=!0,delete this.unknownPropertyPaths[Y]);else if(s.additionalProperties!==void 0){if(this.trackUnknownProperties&&(this.knownPropertyPaths[Y]=!0,delete this.unknownPropertyPaths[Y]),typeof s.additionalProperties=="boolean"){if(!s.additionalProperties&&(I=this.createError(v.OBJECT_ADDITIONAL_PROPERTIES,{key:D},"","/additionalProperties",null,n,s).prefixWith(D,null),this.handleError(I)))return I}else if(I=this.validateAll(n[D],s.additionalProperties,[D],["additionalProperties"],Y))return I}else this.trackUnknownProperties&&!this.knownPropertyPaths[Y]&&(this.unknownPropertyPaths[Y]=!0)}return null},m.prototype.validateObjectDependencies=function(n,s,T){var I;if(s.dependencies!==void 0){for(var D in s.dependencies)if(n[D]!==void 0){var Y=s.dependencies[D];if(typeof Y=="string"){if(n[Y]===void 0&&(I=this.createError(v.OBJECT_DEPENDENCY_KEY,{key:D,missing:Y},"","",null,n,s).prefixWith(null,D).prefixWith(null,"dependencies"),this.handleError(I)))return I}else if(Array.isArray(Y))for(var G=0;G<Y.length;G++){var V=Y[G];if(n[V]===void 0&&(I=this.createError(v.OBJECT_DEPENDENCY_KEY,{key:D,missing:V},"","/"+G,null,n,s).prefixWith(null,D).prefixWith(null,"dependencies"),this.handleError(I)))return I}else if(I=this.validateAll(n,Y,[],["dependencies",D],T))return I}}return null},m.prototype.validateCombinations=function(n,s,T){return this.validateAllOf(n,s,T)||this.validateAnyOf(n,s,T)||this.validateOneOf(n,s,T)||this.validateNot(n,s,T)||null},m.prototype.validateAllOf=function(n,s,T){if(s.allOf===void 0)return null;for(var I,D=0;D<s.allOf.length;D++){var Y=s.allOf[D];if(I=this.validateAll(n,Y,[],["allOf",D],T))return I}return null},m.prototype.validateAnyOf=function(n,s,T){if(s.anyOf===void 0)return null;var I,D,Y=[],G=this.errors.length;this.trackUnknownProperties&&(I=this.unknownPropertyPaths,D=this.knownPropertyPaths);for(var V=!0,H=0;H<s.anyOf.length;H++){this.trackUnknownProperties&&(this.unknownPropertyPaths={},this.knownPropertyPaths={});var tt=s.anyOf[H],at=this.errors.length,ot=this.validateAll(n,tt,[],["anyOf",H],T);if(ot===null&&at===this.errors.length){if(this.errors=this.errors.slice(0,G),this.trackUnknownProperties){for(var Q in this.knownPropertyPaths)D[Q]=!0,delete I[Q];for(var r in this.unknownPropertyPaths)D[r]||(I[r]=!0);V=!1;continue}return null}ot&&Y.push(ot.prefixWith(null,""+H).prefixWith(null,"anyOf"))}return this.trackUnknownProperties&&(this.unknownPropertyPaths=I,this.knownPropertyPaths=D),V?(Y=Y.concat(this.errors.slice(G)),this.errors=this.errors.slice(0,G),this.createError(v.ANY_OF_MISSING,{},"","/anyOf",Y,n,s)):void 0},m.prototype.validateOneOf=function(n,s,T){if(s.oneOf===void 0)return null;var I,D,Y=null,G=[],V=this.errors.length;this.trackUnknownProperties&&(I=this.unknownPropertyPaths,D=this.knownPropertyPaths);for(var H=0;H<s.oneOf.length;H++){this.trackUnknownProperties&&(this.unknownPropertyPaths={},this.knownPropertyPaths={});var tt=s.oneOf[H],at=this.errors.length,ot=this.validateAll(n,tt,[],["oneOf",H],T);if(ot===null&&at===this.errors.length){if(Y!==null)return this.errors=this.errors.slice(0,V),this.createError(v.ONE_OF_MULTIPLE,{index1:Y,index2:H},"","/oneOf",null,n,s);if(Y=H,this.trackUnknownProperties){for(var Q in this.knownPropertyPaths)D[Q]=!0,delete I[Q];for(var r in this.unknownPropertyPaths)D[r]||(I[r]=!0)}}else ot&&G.push(ot)}return this.trackUnknownProperties&&(this.unknownPropertyPaths=I,this.knownPropertyPaths=D),Y===null?(G=G.concat(this.errors.slice(V)),this.errors=this.errors.slice(0,V),this.createError(v.ONE_OF_MISSING,{},"","/oneOf",G,n,s)):(this.errors=this.errors.slice(0,V),null)},m.prototype.validateNot=function(n,s,T){if(s.not===void 0)return null;var I,D,Y=this.errors.length;this.trackUnknownProperties&&(I=this.unknownPropertyPaths,D=this.knownPropertyPaths,this.unknownPropertyPaths={},this.knownPropertyPaths={});var G=this.validateAll(n,s.not,null,null,T),V=this.errors.slice(Y);return this.errors=this.errors.slice(0,Y),this.trackUnknownProperties&&(this.unknownPropertyPaths=I,this.knownPropertyPaths=D),G===null&&V.length===0?this.createError(v.NOT_PASSED,{},"","/not",null,n,s):null},m.prototype.validateHypermedia=function(n,s,T){if(!s.links)return null;for(var I,D=0;D<s.links.length;D++){var Y=s.links[D];if(Y.rel==="describedby"){for(var G=new _(Y.href),V=!0,H=0;H<G.varNames.length;H++)if(!(G.varNames[H]in n)){V=!1;break}if(V){var tt={$ref:G.fillFromObject(n)};if(I=this.validateAll(n,tt,[],["links",D],T))return I}}}};var v={INVALID_TYPE:0,ENUM_MISMATCH:1,ANY_OF_MISSING:10,ONE_OF_MISSING:11,ONE_OF_MULTIPLE:12,NOT_PASSED:13,NUMBER_MULTIPLE_OF:100,NUMBER_MINIMUM:101,NUMBER_MINIMUM_EXCLUSIVE:102,NUMBER_MAXIMUM:103,NUMBER_MAXIMUM_EXCLUSIVE:104,NUMBER_NOT_A_NUMBER:105,STRING_LENGTH_SHORT:200,STRING_LENGTH_LONG:201,STRING_PATTERN:202,OBJECT_PROPERTIES_MINIMUM:300,OBJECT_PROPERTIES_MAXIMUM:301,OBJECT_REQUIRED:302,OBJECT_ADDITIONAL_PROPERTIES:303,OBJECT_DEPENDENCY_KEY:304,ARRAY_LENGTH_SHORT:400,ARRAY_LENGTH_LONG:401,ARRAY_UNIQUE:402,ARRAY_ADDITIONAL_ITEMS:403,FORMAT_CUSTOM:500,KEYWORD_CUSTOM:501,CIRCULAR_REFERENCE:600,UNKNOWN_PROPERTY:1e3},O={};for(var q in v)O[v[q]]=q;var J={INVALID_TYPE:"Invalid type: {type} (expected {expected})",ENUM_MISMATCH:"No enum match for: {value}",ANY_OF_MISSING:'Data does not match any schemas from "anyOf"',ONE_OF_MISSING:'Data does not match any schemas from "oneOf"',ONE_OF_MULTIPLE:'Data is valid against more than one schema from "oneOf": indices {index1} and {index2}',NOT_PASSED:'Data matches schema from "not"',NUMBER_MULTIPLE_OF:"Value {value} is not a multiple of {multipleOf}",NUMBER_MINIMUM:"Value {value} is less than minimum {minimum}",NUMBER_MINIMUM_EXCLUSIVE:"Value {value} is equal to exclusive minimum {minimum}",NUMBER_MAXIMUM:"Value {value} is greater than maximum {maximum}",NUMBER_MAXIMUM_EXCLUSIVE:"Value {value} is equal to exclusive maximum {maximum}",NUMBER_NOT_A_NUMBER:"Value {value} is not a valid number",STRING_LENGTH_SHORT:"String is too short ({length} chars), minimum {minimum}",STRING_LENGTH_LONG:"String is too long ({length} chars), maximum {maximum}",STRING_PATTERN:"String does not match pattern: {pattern}",OBJECT_PROPERTIES_MINIMUM:"Too few properties defined ({propertyCount}), minimum {minimum}",OBJECT_PROPERTIES_MAXIMUM:"Too many properties defined ({propertyCount}), maximum {maximum}",OBJECT_REQUIRED:"Missing required property: {key}",OBJECT_ADDITIONAL_PROPERTIES:"Additional properties not allowed",OBJECT_DEPENDENCY_KEY:"Dependency failed - key must exist: {missing} (due to key: {key})",ARRAY_LENGTH_SHORT:"Array is too short ({length}), minimum {minimum}",ARRAY_LENGTH_LONG:"Array is too long ({length}), maximum {maximum}",ARRAY_UNIQUE:"Array items are not unique (indices {match1} and {match2})",ARRAY_ADDITIONAL_ITEMS:"Additional items not allowed",FORMAT_CUSTOM:"Format validation failed ({message})",KEYWORD_CUSTOM:"Keyword failed: {key} ({message})",CIRCULAR_REFERENCE:"Circular $refs: {urls}",UNKNOWN_PROPERTY:"Unknown property (not in schema)"};function B(n,s,T,I,D){if(Error.call(this),n===void 0)throw new Error("No error code supplied: "+I);this.message="",this.params=s,this.code=n,this.dataPath=T||"",this.schemaPath=I||"",this.subErrors=D||null;var Y=new Error(this.message);if(this.stack=Y.stack||Y.stacktrace,!this.stack)try{throw Y}catch(G){this.stack=G.stack||G.stacktrace}}B.prototype=Object.create(Error.prototype),B.prototype.constructor=B,B.prototype.name="ValidationError",B.prototype.prefixWith=function(n,s){if(n!==null&&(n=n.replace(/~/g,"~0").replace(/\//g,"~1"),this.dataPath="/"+n+this.dataPath),s!==null&&(s=s.replace(/~/g,"~0").replace(/\//g,"~1"),this.schemaPath="/"+s+this.schemaPath),this.subErrors!==null)for(var T=0;T<this.subErrors.length;T++)this.subErrors[T].prefixWith(n,s);return this};var R={},F=function n(s){var T,I,D=new m,Y={setErrorReporter:function(G){return typeof G=="string"?this.language(G):(I=G,!0)},addFormat:function(){D.addFormat.apply(D,arguments)},language:function(G){return G?(R[G]||(G=G.split("-")[0]),!!R[G]&&(T=G,G)):T},addLanguage:function(G,V){var H;for(H in v)V[H]&&!V[v[H]]&&(V[v[H]]=V[H]);var tt=G.split("-")[0];if(R[tt])for(H in R[G]=Object.create(R[tt]),V)R[tt][H]===void 0&&(R[tt][H]=V[H]),R[G][H]=V[H];else R[G]=V,R[tt]=V;return this},freshApi:function(G){var V=n();return G&&V.language(G),V},validate:function(G,V,H,tt){var at=S(T),ot=new m(D,!1,I?function(r,o,f){return I(r,o,f)||at(r,o,f)}:at,H,tt);typeof V=="string"&&(V={$ref:V}),ot.addSchema("",V);var Q=ot.validateAll(G,V,null,null,"");return!Q&&tt&&(Q=ot.banUnknownProperties(G,V)),this.error=Q,this.missing=ot.missing,this.valid=Q===null,this.valid},validateResult:function(){var G={toString:function(){return this.valid?"valid":this.error.message}};return this.validate.apply(G,arguments),G},validateMultiple:function(G,V,H,tt){var at=S(T),ot=new m(D,!0,I?function(r,o,f){return I(r,o,f)||at(r,o,f)}:at,H,tt);typeof V=="string"&&(V={$ref:V}),ot.addSchema("",V),ot.validateAll(G,V,null,null,""),tt&&ot.banUnknownProperties(G,V);var Q={toString:function(){return this.valid?"valid":this.error.message}};return Q.errors=ot.errors,Q.missing=ot.missing,Q.valid=Q.errors.length===0,Q},addSchema:function(){return D.addSchema.apply(D,arguments)},getSchema:function(){return D.getSchema.apply(D,arguments)},getSchemaMap:function(){return D.getSchemaMap.apply(D,arguments)},getSchemaUris:function(){return D.getSchemaUris.apply(D,arguments)},getMissingUris:function(){return D.getMissingUris.apply(D,arguments)},dropSchemas:function(){D.dropSchemas.apply(D,arguments)},defineKeyword:function(){D.defineKeyword.apply(D,arguments)},defineError:function(G,V,H){if(typeof G!="string"||!/^[A-Z]+(_[A-Z]+)*$/.test(G))throw new Error("Code name must be a string in UPPER_CASE_WITH_UNDERSCORES");if(typeof V!="number"||V%1!=0||V<1e4)throw new Error("Code number must be an integer > 10000");if(v[G]!==void 0)throw new Error("Error already defined: "+G+" as "+v[G]);if(O[V]!==void 0)throw new Error("Error code already used: "+O[V]+" as "+V);for(var tt in v[G]=V,O[V]=G,J[G]=J[V]=H,R){var at=R[tt];at[G]&&(at[V]=at[V]||at[G])}},reset:function(){D.reset(),this.error=null,this.missing=[],this.valid=!0},missing:[],error:null,valid:!0,normSchema:a,resolveUrl:e,getDocumentUri:c,errorCodes:v};return Y.language(s||"en"),Y}();return F.addLanguage("en-gb",J),F.tv4=F,F})=="function"?l.apply(u,g):l)===void 0||(i.exports=y)},function(i,u,d){Object.defineProperty(u,"__esModule",{value:!0}),u.BaseClientTypes=void 0;class l{constructor(){this.uris={},this.schemas={},this.aliases={}}declare(b,A,P,h){const k=b+"/"+A;if(h.extends){const x=h.extends.split("/"),w=x.length===1?b+"/"+x.shift():x.join("/"),p=this.uris[w];if(!p)throw"Type '"+k+"' tries to extend unknown schema '"+w+"'";h.extends=this.schemas[p]}this.uris[k]=P,this.aliases[P]=k,this.schemas[P]=h}resolveAlias(b){return this.uris[b]}getSchema(b){return this.schemas[b]}inScope(b){const A=b.length,P={};for(const h in this.uris)if(h.substr(0,A+1)===b+"/"){const k=this.uris[h];P[k]=this.schemas[k]}return P}}u.BaseClientTypes=l;const g=new l;u.default=g},function(i,u,d){class l extends Error{constructor(y){super();const b=new Error("Schema not found: "+y);return b.name="SchemaNotFound",b}}i.exports=l},function(i,u,d){i.exports=class{constructor(l){this._itemsRev={},this._storage={},this._canPropagate=!1,this.defaultValue=l,this.activatePropagation()}get(l){l=l.toLowerCase();let g=this._storage[l];return g===void 0&&(g=this.defaultValue,this._storage[l]=g),g}set(l,g){return l=l.toLowerCase(),this._storage[l]===g||(this._storage[l]=g,g||delete this._itemsRev[l],this._updateParentFolderItemRev(l,g),this._canPropagate&&this._propagate(l)),g}delete(l){return this.set(l,null)}deactivatePropagation(){return this._canPropagate=!1,!0}activatePropagation(){return this._canPropagate||(this._generateFolderRev("/"),this._canPropagate=!0),!0}_hashCode(l){let g=0;if(l.length===0)return g;for(let y=0;y<l.length;y++)g=(g<<5)-g+l.charCodeAt(y),g|=0;return g}_generateHash(l){const g=l.sort().join("|");return""+this._hashCode(g)}_updateParentFolderItemRev(l,g){if(l!=="/"){const y=this._getParentFolder(l);this._itemsRev[y]||(this._itemsRev[y]={});const b=this._itemsRev[y];g?b[l]=g:delete b[l],this._updateParentFolderItemRev(y,this.defaultValue)}}_getParentFolder(l){return l.substr(0,l.lastIndexOf("/",l.length-2)+1)}_propagate(l){if(l!=="/"){const g=this._getParentFolder(l),y=this._itemsRev[g],b=[];for(const P in y)b.push(y[P]);const A=this._generateHash(b);this.set(g,A)}}_generateFolderRev(l){const g=this._itemsRev[l];let y=this.defaultValue;if(g){const b=[];for(const A in g){let P;P=A.substr(-1)==="/"?this._generateFolderRev(A):g[A],b.push(P)}b.length>0&&(y=this._generateHash(b))}return this.set(l,y),y}}},function(i,u,d){var l;/*!
 * webfinger.js
 *   version 2.7.0
 *   http://github.com/silverbucket/webfinger.js
 *
 * Developed and Maintained by:
 *   Nick Jennings <nick@silverbucket.net> 2012
 *
 * webfinger.js is released under the AGPL (see LICENSE).
 *
 * You don't have to do anything special to choose one license or the other and you don't
 * have to notify anyone which license you are using.
 * Please see the corresponding license file for details of these licenses.
 * You are free to use, modify and distribute this software, but all copyright
 * information must remain.
 *
 */typeof fetch!="function"&&typeof XMLHttpRequest!="function"&&(XMLHttpRequest=d(28)),function(g){var y={"http://webfist.org/spec/rel":"webfist","http://webfinger.net/rel/avatar":"avatar",remotestorage:"remotestorage","http://tools.ietf.org/id/draft-dejong-remotestorage":"remotestorage",remoteStorage:"remotestorage","http://www.packetizer.com/rel/share":"share","http://webfinger.net/rel/profile-page":"profile",me:"profile",vcard:"vcard",blog:"blog","http://packetizer.com/rel/blog":"blog","http://schemas.google.com/g/2010#updates-from":"updates","https://camlistore.org/rel/server":"camilstore"},b={avatar:[],remotestorage:[],blog:[],vcard:[],updates:[],share:[],profile:[],webfist:[],camlistore:[]},A=["webfinger","host-meta","host-meta.json"];function P(k){return k.toString=function(){return this.message},k}function h(k){typeof k!="object"&&(k={}),this.config={tls_only:k.tls_only===void 0||k.tls_only,webfist_fallback:k.webfist_fallback!==void 0&&k.webfist_fallback,uri_fallback:k.uri_fallback!==void 0&&k.uri_fallback,request_timeout:k.request_timeout!==void 0?k.request_timeout:1e4}}h.prototype.__fetchJRD=function(k,x,w){if(typeof fetch=="function")return this.__fetchJRD_fetch(k,x,w);if(typeof XMLHttpRequest=="function")return this.__fetchJRD_XHR(k,x,w);throw new Error("add a polyfill for fetch or XMLHttpRequest")},h.prototype.__fetchJRD_fetch=function(k,x,w){var p,_=this;typeof AbortController=="function"&&(p=new AbortController);var m=fetch(k,{headers:{Accept:"application/jrd+json, application/json"},signal:p?p.signal:void 0}).then(function(M){if(M.ok)return M.text();throw M.status===404?P({message:"resource not found",url:k,status:M.status}):P({message:"error during request",url:k,status:M.status})},function(M){throw P({message:"error during request",url:k,status:void 0,err:M})}).then(function(M){if(_.__isValidJSON(M))return M;throw P({message:"invalid json",url:k,status:void 0})}),N=new Promise(function(M,$){setTimeout(function(){$(P({message:"request timed out",url:k,status:void 0})),p&&p.abort()},_.config.request_timeout)});Promise.race([m,N]).then(function(M){w(M)}).catch(function(M){x(M)})},h.prototype.__fetchJRD_XHR=function(k,x,w){var p=this,_=!1,m=new XMLHttpRequest;function N(){if(!_){if(_=!0,m.status===200)return p.__isValidJSON(m.responseText)?w(m.responseText):x(P({message:"invalid json",url:k,status:m.status}));if(m.status===404)return x(P({message:"resource not found",url:k,status:m.status}));if(m.status>=301&&m.status<=302){var $=m.getResponseHeader("Location");return function(C){return typeof C=="string"&&C.split("://")[0]==="https"}($)?M():x(P({message:"no redirect URL found",url:k,status:m.status}))}return x(P({message:"error during request",url:k,status:m.status}))}}function M(){m.onreadystatechange=function(){m.readyState===4&&N()},m.onload=function(){N()},m.ontimeout=function(){return x(P({message:"request timed out",url:k,status:m.status}))},m.open("GET",k,!0),m.timeout=p.config.request_timeout,m.setRequestHeader("Accept","application/jrd+json, application/json"),m.send()}return M()},h.prototype.__isValidJSON=function(k){try{JSON.parse(k)}catch{return!1}return!0},h.prototype.__isLocalhost=function(k){return/^localhost(\.localdomain)?(\:[0-9]+)?$/.test(k)},h.prototype.__processJRD=function(k,x,w,p){var _=JSON.parse(x);if(typeof _!="object"||typeof _.links!="object")return _.error!==void 0?w(P({message:_.error,request:k})):w(P({message:"unknown response from server",request:k}));var m=_.links;Array.isArray(m)||(m=[]);var N={object:_,json:x,idx:{}};N.idx.properties={name:void 0},N.idx.links=JSON.parse(JSON.stringify(b)),m.map(function(C,e){if(y.hasOwnProperty(C.rel)&&N.idx.links[y[C.rel]]){var c={};Object.keys(C).map(function(a,S){c[a]=C[a]}),N.idx.links[y[C.rel]].push(c)}});var M=JSON.parse(x).properties;for(var $ in M)M.hasOwnProperty($)&&$==="http://packetizer.com/ns/name"&&(N.idx.properties.name=M[$]);return p(N)},h.prototype.lookup=function(k,x){if(typeof k!="string")throw new Error("first parameter must be a user address");if(typeof x!="function")throw new Error("second parameter must be a callback");var w=this,p="";p=k.indexOf("://")>-1?k.replace(/ /g,"").split("/")[2]:k.replace(/ /g,"").split("@")[1];var _=0,m="https";function N(){var C="";return k.split("://")[1]||(C="acct:"),m+"://"+p+"/.well-known/"+A[_]+"?resource="+C+k}function M(C){if(w.config.uri_fallback&&p!=="webfist.org"&&_!==A.length-1)return _+=1,$();if(!w.config.tls_only&&m==="https")return _=0,m="http",$();if(!w.config.webfist_fallback||p==="webfist.org")return x(C);_=0,m="http",p="webfist.org";var e=N();w.__fetchJRD(e,x,function(c){w.__processJRD(e,c,x,function(a){typeof a.idx.links.webfist=="object"&&typeof a.idx.links.webfist[0].href=="string"&&w.__fetchJRD(a.idx.links.webfist[0].href,x,function(S){w.__processJRD(e,S,x,function(v){return x(null,x)})})})})}function $(){var C=N();w.__fetchJRD(C,M,function(e){w.__processJRD(C,e,x,function(c){x(null,c)})})}return w.__isLocalhost(p)&&(m="http"),setTimeout($,0)},h.prototype.lookupLink=function(k,x,w){if(!b.hasOwnProperty(x))return w("unsupported rel "+x);this.lookup(k,function(p,_){var m=_.idx.links[x];return p?w(p):m.length===0?w('no links found with rel="'+x+'"'):w(null,m[0])})},(l=function(){return h}.apply(u,[]))===void 0||(i.exports=l)}()},function(i,u){i.exports=XMLHttpRequest},function(i,u,d){var l=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};const g=l(d(3)),y=l(d(16)),b=l(d(1)),A=d(0),P=l(d(30)),h=l(d(11)),k=l(d(6)),x=l(d(15)),w=l(d(7)),p=l(d(13)),_=l(d(14)),m=l(d(8)),N=l(d(31)),M=l(d(12)),$=l(d(32)),C=l(d(33)),e=l(d(34)),c={features:[],featuresDone:0,readyFired:!1,loadFeatures(){this.features=[],this.featuresDone=0,this.readyFired=!1,this.featureModules={WireClient:m.default,Dropbox:_.default,GoogleDrive:p.default,Access:h.default,Discover:x.default,Authorize:k.default,BaseClient:w.default,Env:y.default},g.default.cache&&A.extend(this.featureModules,{Caching:M.default,IndexedDB:$.default,LocalStorage:C.default,InMemoryStorage:e.default,Sync:N.default}),g.default.disableFeatures.forEach(a=>{this.featureModules[a]&&delete this.featureModules[a]}),this._allLoaded=!1;for(const a in this.featureModules)this.loadFeature(a)},hasFeature(a){for(let S=this.features.length-1;S>=0;S--)if(this.features[S].name===a)return this.features[S].supported;return!1},loadFeature(a){const S=this.featureModules[a],v=!S._rs_supported||S._rs_supported();b.default(`[RemoteStorage] [FEATURE ${a}] initializing ...`),typeof v=="object"?v.then(()=>{this.featureSupported(a,!0),this.initFeature(a)},()=>{this.featureSupported(a,!1)}):typeof v=="boolean"?(this.featureSupported(a,v),v&&this.initFeature(a)):this.featureSupported(a,!1)},initFeature(a){const S=this.featureModules[a];let v;try{v=S._rs_init(this)}catch(O){return void this.featureFailed(a,O)}typeof v=="object"&&typeof v.then=="function"?v.then(()=>{this.featureInitialized(a)},O=>{this.featureFailed(a,O)}):this.featureInitialized(a)},featureFailed(a,S){b.default(`[RemoteStorage] [FEATURE ${a}] initialization failed (${S})`),this.featureDone()},featureSupported(a,S){b.default(`[RemoteStorage] [FEATURE ${a}]${S?"":"not "} supported`),S||this.featureDone()},featureInitialized(a){b.default(`[RemoteStorage] [FEATURE ${a}] initialized`),this.features.push({name:a,init:this.featureModules[a]._rs_init,supported:!0,cleanup:this.featureModules[a]._rs_cleanup}),this.featureDone()},featureDone(){this.featuresDone++,this.featuresDone===Object.keys(this.featureModules).length&&setTimeout(this.featuresLoaded.bind(this),0)},_setCachingModule(){["IndexedDB","LocalStorage","InMemoryStorage"].some(a=>{if(this.features.some(S=>S.name===a))return this.features.local=this.featureModules[a],!0})},_fireReady(){try{this.readyFired||(this._emit("ready"),this.readyFired=!0)}catch(a){console.error("'ready' failed: ",a,a.stack),this._emit("error",a)}},featuresLoaded(){b.default("[RemoteStorage] All features loaded"),this._setCachingModule(),this.local=g.default.cache&&this.features.local&&new this.features.local,this.local&&this.remote?(this._setGPD(P.default,this),this._bindChange(this.local)):this.remote&&this._setGPD(this.remote,this.remote),this.remote&&(this.remote.on("connected",()=>{this._fireReady(),this._emit("connected")}),this.remote.on("not-connected",()=>{this._fireReady(),this._emit("not-connected")}),this.remote.connected&&(this._fireReady(),this._emit("connected")),this.hasFeature("Authorize")||this.remote.stopWaitingForToken()),this._collectCleanupFunctions();try{this._allLoaded=!0,this._emit("features-loaded")}catch(a){A.logError(a),this._emit("error",a)}this._processPending()},_collectCleanupFunctions(){this._cleanups=[];for(let a=0;a<this.features.length;a++){const S=this.features[a].cleanup;typeof S=="function"&&this._cleanups.push(S)}}};i.exports=c},function(i,u,d){var l=this&&this.__awaiter||function(A,P,h,k){return new(h||(h=Promise))(function(x,w){function p(N){try{m(k.next(N))}catch(M){w(M)}}function _(N){try{m(k.throw(N))}catch(M){w(M)}}function m(N){var M;N.done?x(N.value):(M=N.value,M instanceof h?M:new h(function($){$(M)})).then(p,_)}m((k=k.apply(A,P||[])).next())})};const g=(this&&this.__importDefault||function(A){return A&&A.__esModule?A:{default:A}})(d(1));function y(A){return this.backend==="dropbox"&&!!A.match(/^\/public\/.*[^\/]$/)}const b={get:function(A,P){if(this.local){if(P===void 0)P=typeof(h=this).remote=="object"&&h.remote.connected&&h.remote.online?2*h.getSyncInterval():(g.default("Not setting default maxAge, because remote is offline or not connected"),!1);else if(typeof P!="number"&&P!==!1)return Promise.reject("Argument 'maxAge' must be 'false' or a number");return this.local.get(A,P,this.sync.queueGetRequest.bind(this.sync))}return this.remote.get(A);var h},put:function(A,P,h){return y.bind(this)(A)?b._wrapBusyDone.call(this,this.remote.put(A,P,h)):this.local?this.local.put(A,P,h):b._wrapBusyDone.call(this,this.remote.put(A,P,h))},delete:function(A){return this.local?this.local.delete(A):b._wrapBusyDone.call(this,this.remote.delete(A))},_wrapBusyDone:function(A){return l(this,void 0,void 0,function*(){return this._emit("wire-busy"),A.then(P=>(this._emit("wire-done",{success:!0}),Promise.resolve(P)),P=>(this._emit("wire-done",{success:!1}),Promise.reject(P)))})}};i.exports=b},function(i,u,d){var l=this&&this.__awaiter||function(C,e,c,a){return new(c||(c=Promise))(function(S,v){function O(B){try{J(a.next(B))}catch(R){v(R)}}function q(B){try{J(a.throw(B))}catch(R){v(R)}}function J(B){var R;B.done?S(B.value):(R=B.value,R instanceof c?R:new c(function(F){F(R)})).then(O,q)}J((a=a.apply(C,e||[])).next())})},g=this&&this.__importDefault||function(C){return C&&C.__esModule?C:{default:C}};const y=g(d(3)),b=g(d(16)),A=g(d(2)),P=g(d(1)),h=g(d(6)),k=g(d(9)),x=g(d(4)),w=d(0);let p,_;function m(C,e,c){return{action:C,path:e,promise:c}}function N(C,e){return C.common.revision!==e&&(!C.remote||C.remote.revision!==e)}function M(C){return C.common&&C.common.revision}class ${constructor(e){this.rs=e,this._tasks={},this._running={},this._timeStarted={},this.numThreads=10,this.rs.local.onDiff(c=>{this.addTask(c),this.doTasks()}),this.rs.caching.onActivate(c=>{this.addTask(c),this.doTasks()}),this.addEvents(["done","req-done"])}now(){return new Date().getTime()}queueGetRequest(e){return new Promise((c,a)=>{this.rs.remote.connected?this.rs.remote.online?(this.addTask(e,function(){this.rs.local.get(e).then(S=>c(S))}.bind(this)),this.doTasks()):a("cannot fulfill maxAge requirement - remote is not online"):a("cannot fulfill maxAge requirement - remote is not connected")})}corruptServerItemsMap(e,c){if(typeof e!="object"||Array.isArray(e))return!0;for(const a in e){const S=e[a];if(typeof S!="object"||typeof S.ETag!="string")return!0;if(w.isFolder(a)){if(a.substring(0,a.length-1).indexOf("/")!==-1)return!0}else if(a.indexOf("/")!==-1||c&&(typeof S["Content-Type"]!="string"||typeof S["Content-Length"]!="number"))return!0}return!1}corruptItemsMap(e){if(typeof e!="object"||Array.isArray(e))return!0;for(const c in e)if(typeof e[c]!="boolean")return!0;return!1}corruptRevision(e){return typeof e!="object"||Array.isArray(e)||e.revision&&typeof e.revision!="string"||e.body&&typeof e.body!="string"&&typeof e.body!="object"||e.contentType&&typeof e.contentType!="string"||e.contentLength&&typeof e.contentLength!="number"||e.timestamp&&typeof e.timestamp!="number"||e.itemsMap&&this.corruptItemsMap(e.itemsMap)}isCorrupt(e){return typeof e!="object"||Array.isArray(e)||typeof e.path!="string"||this.corruptRevision(e.common)||e.local&&this.corruptRevision(e.local)||e.remote&&this.corruptRevision(e.remote)||e.push&&this.corruptRevision(e.push)}hasTasks(){return Object.getOwnPropertyNames(this._tasks).length>0}collectDiffTasks(){return l(this,void 0,void 0,function*(){let e=0;return this.rs.local.forAllNodes(c=>{e>100||(this.isCorrupt(c)?(P.default("[Sync] WARNING: corrupt node in local cache",c),typeof c=="object"&&c.path&&(this.addTask(c.path),e++)):(this.needsFetch(c)&&this.rs.access.checkPathPermission(c.path,"r")||w.isDocument(c.path)&&this.needsPush(c)&&this.rs.access.checkPathPermission(c.path,"rw"))&&(this.addTask(c.path),e++))}).then(()=>e).catch(c=>{throw c})})}inConflict(e){return e.local&&e.remote&&(e.remote.body!==void 0||e.remote.itemsMap)}needsRefresh(e){return!!e.common&&(!e.common.timestamp||this.now()-e.common.timestamp>y.default.syncInterval)}needsFetch(e){return!!this.inConflict(e)||!(!e.common||e.common.itemsMap!==void 0||e.common.body!==void 0)||!(!e.remote||e.remote.itemsMap!==void 0||e.remote.body!==void 0)}needsPush(e){return!this.inConflict(e)&&(!(!e.local||e.push)||void 0)}needsRemotePut(e){return e.local&&e.local.body}needsRemoteDelete(e){return e.local&&e.local.body===!1}getParentPath(e){const c=e.match(/^(.*\/)([^\/]+\/?)$/);if(c)return c[1];throw new Error('Not a valid path: "'+e+'"')}deleteChildPathsFromTasks(){for(const e in this._tasks){const c=w.pathsFromRoot(e);for(let a=1;a<c.length;a++)this._tasks[c[a]]&&(Array.isArray(this._tasks[e])&&this._tasks[e].length&&Array.prototype.push.apply(this._tasks[c[a]],this._tasks[e]),delete this._tasks[e])}}collectRefreshTasks(){return l(this,void 0,void 0,function*(){return this.rs.local.forAllNodes(e=>{let c;if(this.needsRefresh(e)){try{c=this.getParentPath(e.path)}catch{}c&&this.rs.access.checkPathPermission(c,"r")?this.addTask(c):this.rs.access.checkPathPermission(e.path,"r")&&this.addTask(e.path)}}).then(()=>this.deleteChildPathsFromTasks()).catch(e=>{throw e})})}flush(e){for(const c in e)this.rs.caching.checkPath(c)==="FLUSH"&&e[c]&&!e[c].local&&(P.default("[Sync] Flushing",c),e[c]=void 0);return e}doTask(e){return this.rs.local.getNodes([e]).then(c=>{const a=c[e];return a===void 0||function(S){return S.remote&&S.remote.revision&&!S.remote.itemsMap&&!S.remote.body}(a)?m("get",e,this.rs.remote.get(e)):this.needsRemotePut(a)?(a.push=w.deepClone(a.local),a.push.timestamp=this.now(),this.rs.local.setNodes(this.flush(c)).then(()=>{let S;return S=M(a)?{ifMatch:a.common.revision}:{ifNoneMatch:"*"},m("put",e,this.rs.remote.put(e,a.push.body,a.push.contentType,S))})):this.needsRemoteDelete(a)?(a.push={body:!1,timestamp:this.now()},this.rs.local.setNodes(this.flush(c)).then(()=>M(a)?m("delete",e,this.rs.remote.delete(e,{ifMatch:a.common.revision})):m("get",e,this.rs.remote.get(e)))):M(a)?m("get",e,this.rs.remote.get(e,{ifNoneMatch:a.common.revision})):m("get",e,this.rs.remote.get(e))})}autoMergeFolder(e){if(e.remote.itemsMap&&(e.common=e.remote,delete e.remote,e.common.itemsMap)){for(const c in e.common.itemsMap)e.local.itemsMap[c]||(e.local.itemsMap[c]=!1);w.equal(e.local.itemsMap,e.common.itemsMap)&&delete e.local}return e}autoMergeDocument(e){return function(c){return(!c.remote||!c.remote.revision||c.remote.revision===c.common.revision)&&(c.common.body===void 0&&c.remote.body===!1||c.remote.body===c.common.body&&c.remote.contentType===c.common.contentType)}(e)?delete(e=function(c){return c.remote&&c.remote.body===!1&&c.local&&c.local.body===!1&&delete c.local,c}(e)).remote:e.remote.body!==void 0&&(P.default("[Sync] Emitting keep/revert"),this.rs.local._emitChange({origin:"conflict",path:e.path,oldValue:e.local.body,newValue:e.remote.body,lastCommonValue:e.common.body,oldContentType:e.local.contentType,newContentType:e.remote.contentType,lastCommonContentType:e.common.contentType}),e.remote.body?e.common=e.remote:e.common={},delete e.remote,delete e.local),e}autoMerge(e){if(e.remote){if(e.local)return w.isFolder(e.path)?this.autoMergeFolder(e):this.autoMergeDocument(e);if(w.isFolder(e.path))e.remote.itemsMap!==void 0&&(e.common=e.remote,delete e.remote);else if(e.remote.body!==void 0){const c={origin:"remote",path:e.path,oldValue:e.common.body===!1?void 0:e.common.body,newValue:e.remote.body===!1?void 0:e.remote.body,oldContentType:e.common.contentType,newContentType:e.remote.contentType};if((c.oldValue||c.newValue)&&this.rs.local._emitChange(c),!e.remote.body)return;e.common=e.remote,delete e.remote}return e}e.common.body&&this.rs.local._emitChange({origin:"remote",path:e.path,oldValue:e.common.body,newValue:void 0,oldContentType:e.common.contentType,newContentType:void 0})}updateCommonTimestamp(e,c){return l(this,void 0,void 0,function*(){return this.rs.local.getNodes([e]).then(a=>(a[e]&&a[e].common&&a[e].common.revision===c&&(a[e].common.timestamp=this.now()),this.rs.local.setNodes(this.flush(a))))})}markChildren(e,c,a,S){return l(this,void 0,void 0,function*(){const v=[],O={},q={};for(const J in c)v.push(e+J),O[e+J]=c[J];for(const J in S)v.push(e+J);return this.rs.local.getNodes(v).then(J=>{let B,R;for(const F in J)if(R=J[F],O[F])R&&R.common?N(R,O[F].ETag)&&(a[F]=w.deepClone(R),a[F].remote={revision:O[F].ETag,timestamp:this.now()},a[F]=this.autoMerge(a[F])):(B=this.rs.caching.checkPath(F),B==="ALL"&&(a[F]={path:F,common:{timestamp:this.now()},remote:{revision:O[F].ETag,timestamp:this.now()}})),a[F]&&O[F]["Content-Type"]&&(a[F].remote.contentType=O[F]["Content-Type"]),a[F]&&O[F]["Content-Length"]&&(a[F].remote.contentLength=O[F]["Content-Length"]);else if(S[F.substring(e.length)]&&R&&R.common){if(R.common.itemsMap)for(const n in R.common.itemsMap)q[F+n]=!0;if(R.local&&R.local.itemsMap)for(const n in R.local.itemsMap)q[F+n]=!0;if(R.remote||w.isFolder(F))a[F]=void 0;else if(a[F]=this.autoMerge(R),a[F]===void 0){const n=this.getParentPath(F),s=a[n],T=F.substring(e.length);s&&s.local&&(delete s.local.itemsMap[T],w.equal(s.local.itemsMap,s.common.itemsMap)&&delete s.local)}}return this.deleteRemoteTrees(Object.keys(q),a).then(F=>this.rs.local.setNodes(this.flush(F)))})})}deleteRemoteTrees(e,c){return l(this,void 0,void 0,function*(){return e.length===0?Promise.resolve(c):this.rs.local.getNodes(e).then(a=>l(this,void 0,void 0,function*(){const S={};function v(O,q){if(O&&O.itemsMap)for(const J in O.itemsMap)S[q+J]=!0}for(const O in a){const q=a[O];q&&(w.isFolder(O)?(v(q.common,O),v(q.local,O)):q.common&&typeof q.common.body!==void 0&&(c[O]=w.deepClone(q),c[O].remote={body:!1,timestamp:this.now()},c[O]=this.autoMerge(c[O])))}return this.deleteRemoteTrees(Object.keys(S),c).then(O=>this.rs.local.setNodes(this.flush(O)))}))})}completeFetch(e,c,a,S){return l(this,void 0,void 0,function*(){let v,O;const q=w.pathsFromRoot(e);return w.isFolder(e)?v=[e]:(O=q[1],v=[e,O]),this.rs.local.getNodes(v).then(J=>{let B,R,F=J[e];const n={};function s(T){if(T&&T.itemsMap)for(B in T.itemsMap)c[B]||(n[B]=!0)}if(typeof F=="object"&&F.path===e&&typeof F.common=="object"||(F={path:e,common:{}},J[e]=F),F.remote={revision:S,timestamp:this.now()},w.isFolder(e))for(B in s(F.common),s(F.remote),F.remote.itemsMap={},c)F.remote.itemsMap[B]=!0;else F.remote.body=c,F.remote.contentType=a,R=J[O],R&&R.local&&R.local.itemsMap&&(B=e.substring(O.length),R.local.itemsMap[B]=!0,w.equal(R.local.itemsMap,R.common.itemsMap)&&delete R.local);return J[e]=this.autoMerge(F),{toBeSaved:J,missingChildren:n}})})}completePush(e,c,a,S){return l(this,void 0,void 0,function*(){return this.rs.local.getNodes([e]).then(v=>{const O=v[e];if(!O.push)throw this.stopped=!0,new Error("completePush called but no push version!");return a?(P.default("[Sync] We have a conflict"),O.remote&&O.remote.revision===S||(O.remote={revision:S||"conflict",timestamp:this.now()},delete O.push),v[e]=this.autoMerge(O)):(O.common={revision:S,timestamp:this.now()},c==="put"?(O.common.body=O.push.body,O.common.contentType=O.push.contentType,w.equal(O.local.body,O.push.body)&&O.local.contentType===O.push.contentType&&delete O.local,delete O.push):c==="delete"&&(O.local.body===!1?v[e]=void 0:delete O.push)),this.rs.local.setNodes(this.flush(v))})})}dealWithFailure(e){return l(this,void 0,void 0,function*(){return this.rs.local.getNodes([e]).then(c=>{if(c[e])return delete c[e].push,this.rs.local.setNodes(this.flush(c))})})}interpretStatus(e){const c={statusCode:e,successful:void 0,conflict:void 0,unAuth:void 0,notFound:void 0,changed:void 0,networkProblems:void 0};if(typeof e=="string"&&(e==="offline"||e==="timeout"))return c.successful=!1,c.networkProblems=!0,c;if(typeof e=="number"){const a=Math.floor(e/100);return c.successful=a===2||e===304||e===412||e===404,c.conflict=e===412,c.unAuth=e===401&&this.rs.remote.token!==h.default.IMPLIED_FAKE_TOKEN||e===402||e===403,c.notFound=e===404,c.changed=e!==304,c}}handleGetResponse(e,c,a,S,v){return l(this,void 0,void 0,function*(){return c.notFound&&(a=!!w.isFolder(e)&&{}),c.changed?this.completeFetch(e,a,S,v).then(O=>w.isFolder(e)?this.corruptServerItemsMap(a)?(P.default("[Sync] WARNING: Discarding corrupt folder description from server for "+e),!1):this.markChildren(e,a,O.toBeSaved,O.missingChildren).then(()=>!0):this.rs.local.setNodes(this.flush(O.toBeSaved)).then(()=>!0)):this.updateCommonTimestamp(e,v).then(()=>!0)})}handleResponse(e,c,a){const S=this.interpretStatus(a.statusCode);if(S.successful){if(c==="get")return this.handleGetResponse(e,S,a.body,a.contentType,a.revision);if(c==="put"||c==="delete")return this.completePush(e,c,S.conflict,a.revision).then(function(){return!0});throw new Error("cannot handle response for unknown action "+c)}{let v;return v=S.unAuth?new x.default:S.networkProblems?new k.default("Network request failed."):new Error("HTTP response code "+S.statusCode+" received."),this.dealWithFailure(e).then(()=>{throw this.rs._emit("error",v),v})}}finishTask(e){if(e.action!==void 0)return e.promise.then(c=>this.handleResponse(e.path,e.action,c),c=>(P.default("[Sync] wireclient rejects its promise!",e.path,e.action,c),this.handleResponse(e.path,e.action,{statusCode:"offline"}))).then(c=>{if(delete this._timeStarted[e.path],delete this._running[e.path],c&&this._tasks[e.path]){for(let a=0;a<this._tasks[e.path].length;a++)this._tasks[e.path][a]();delete this._tasks[e.path]}this.rs._emit("sync-req-done"),this.collectTasks(!1).then(()=>{!this.hasTasks()||this.stopped?(P.default("[Sync] Sync is done! Reschedule?",Object.getOwnPropertyNames(this._tasks).length,this.stopped),this.done||(this.done=!0,this.rs._emit("sync-done"))):setTimeout(()=>{this.doTasks()},10)})},c=>{P.default("[Sync] Error",c),delete this._timeStarted[e.path],delete this._running[e.path],this.rs._emit("sync-req-done"),this.done||(this.done=!0,this.rs._emit("sync-done"))});delete this._running[e.path]}doTasks(){let e,c,a=0;e=this.rs.remote.connected?this.rs.remote.online?this.numThreads:1:0;const S=e-Object.getOwnPropertyNames(this._running).length;if(S<=0)return!0;for(c in this._tasks)if(!this._running[c]&&(this._timeStarted[c]=this.now(),this._running[c]=this.doTask(c),this._running[c].then(this.finishTask.bind(this)),a++,a>=S))return!0;return a>=S}collectTasks(e){return l(this,void 0,void 0,function*(){return this.hasTasks()||this.stopped?Promise.resolve():this.collectDiffTasks().then(c=>c||e===!1?Promise.resolve():this.collectRefreshTasks(),function(c){throw c})})}addTask(e,c){this._tasks[e]||(this._tasks[e]=[]),typeof c=="function"&&this._tasks[e].push(c)}sync(){return this.done=!1,this.doTasks()?Promise.resolve():this.collectTasks().then(()=>{try{this.doTasks()}catch(e){P.default("[Sync] doTasks error",e)}},function(e){throw P.default("[Sync] Sync error",e),new Error("Local cache unavailable")})}static _rs_init(e){p=function(){P.default("[Sync] syncCycleCb calling syncCycle");const c=new b.default;c.isBrowser()&&function(a,S){function v(O){const q=S.getCurrentSyncInterval();y.default.isBackground=!O;const J=S.getCurrentSyncInterval();S._emit("sync-interval-change",{oldValue:q,newValue:J})}a.on("background",()=>v(!1)),a.on("foreground",()=>v(!0))}(c,e),e.sync||(e.sync=new $(e),e.syncStopped&&(P.default("[Sync] Instantiating sync stopped"),e.sync.stopped=!0,delete e.syncStopped)),P.default("[Sync] syncCycleCb calling syncCycle"),e.syncCycle()},_=function(){e.removeEventListener("connected",_),e.startSync()},e.on("ready",p),e.on("connected",_)}static _rs_cleanup(e){e.stopSync(),e.removeEventListener("ready",p),e.removeEventListener("connected",_),e.sync=void 0,delete e.sync}}w.applyMixins($,[A.default]),i.exports=$},function(i,u,d){(function(l){var g=this&&this.__awaiter||function(w,p,_,m){return new(_||(_=Promise))(function(N,M){function $(c){try{e(m.next(c))}catch(a){M(a)}}function C(c){try{e(m.throw(c))}catch(a){M(a)}}function e(c){var a;c.done?N(c.value):(a=c.value,a instanceof _?a:new _(function(S){S(a)})).then($,C)}e((m=m.apply(w,p||[])).next())})},y=this&&this.__importDefault||function(w){return w&&w.__esModule?w:{default:w}};const b=y(d(2)),A=y(d(10)),P=y(d(1)),h=d(0);let k;class x extends A.default{constructor(p){super(),this.addEvents(["change","local-events-done"]),this.db=p||k,this.db?(this.getsRunning=0,this.putsRunning=0,this.changesQueued={},this.changesRunning={},this.commitSlownessWarning=null):P.default("[IndexedDB] Failed to open DB")}getNodes(p){return g(this,void 0,void 0,function*(){const _=[],m={};for(let N=0,M=p.length;N<M;N++)this.changesQueued[p[N]]!==void 0?m[p[N]]=h.deepClone(this.changesQueued[p[N]]||void 0):this.changesRunning[p[N]]!==void 0?m[p[N]]=h.deepClone(this.changesRunning[p[N]]||void 0):_.push(p[N]);return _.length>0?this.getNodesFromDb(_).then(function(N){for(const M in m)N[M]=m[M];return N}):Promise.resolve(m)})}setNodes(p){return g(this,void 0,void 0,function*(){for(const _ in p)this.changesQueued[_]=p[_]||!1;return this.maybeFlush(),Promise.resolve()})}maybeFlush(){this.putsRunning===0?this.flushChangesQueued():this.commitSlownessWarning||(this.commitSlownessWarning=l.setInterval(function(){console.warn("WARNING: waited more than 10 seconds for previous commit to finish")},1e4))}flushChangesQueued(){this.commitSlownessWarning&&(clearInterval(this.commitSlownessWarning),this.commitSlownessWarning=null),Object.keys(this.changesQueued).length>0&&(this.changesRunning=this.changesQueued,this.changesQueued={},this.setNodesInDb(this.changesRunning).then(this.flushChangesQueued.bind(this)))}getNodesFromDb(p){return new Promise((_,m)=>{const N=this.db.transaction(["nodes"],"readonly"),M=N.objectStore("nodes"),$={};this.getsRunning++,p.map(C=>{M.get(C).onsuccess=e=>{$[C]=e.target.result}}),N.oncomplete=()=>{_($),this.getsRunning--},N.onerror=N.onabort=()=>{m("get transaction error/abort"),this.getsRunning--}})}setNodesInDb(p){return g(this,void 0,void 0,function*(){return new Promise((_,m)=>{const N=this.db.transaction(["nodes"],"readwrite"),M=N.objectStore("nodes"),$=new Date().getTime();this.putsRunning++,P.default("[IndexedDB] Starting put",p,this.putsRunning);for(const C in p){const e=p[C];if(typeof e=="object")try{M.put(e)}catch(c){throw P.default("[IndexedDB] Error while putting",e,c),c}else try{M.delete(C)}catch(c){throw P.default("[IndexedDB] Error while removing",M,e,c),c}}N.oncomplete=()=>{this.putsRunning--,P.default("[IndexedDB] Finished put",p,this.putsRunning,new Date().getTime()-$+"ms"),_()},N.onerror=()=>{this.putsRunning--,m("transaction error")},N.onabort=()=>{m("transaction abort"),this.putsRunning--}})})}reset(p){const _=this.db.name;this.db.close(),x.clean(this.db.name,()=>{x.open(_,(m,N)=>{m?P.default("[IndexedDB] Error while resetting local storage",m):this.db=N,typeof p=="function"&&p(self)})})}forAllNodes(p){return g(this,void 0,void 0,function*(){return new Promise(_=>{this.db.transaction(["nodes"],"readonly").objectStore("nodes").openCursor().onsuccess=m=>{const N=m.target.result;N?(p(this.migrate(N.value)),N.continue()):_()}})})}closeDB(){this.putsRunning===0?this.db.close():setTimeout(this.closeDB.bind(this),100)}static open(p,_){const m=setTimeout(function(){_("timeout trying to open db")},1e4);try{const N=indexedDB.open(p,2);N.onerror=function(){P.default("[IndexedDB] Opening DB failed",N),clearTimeout(m),_(N.error)},N.onupgradeneeded=function(M){const $=N.result;P.default("[IndexedDB] Upgrade: from ",M.oldVersion," to ",M.newVersion),M.oldVersion!==1&&(P.default("[IndexedDB] Creating object store: nodes"),$.createObjectStore("nodes",{keyPath:"path"})),P.default("[IndexedDB] Creating object store: changes"),$.createObjectStore("changes",{keyPath:"path"})},N.onsuccess=function(){clearTimeout(m);const M=N.result;if(!M.objectStoreNames.contains("nodes")||!M.objectStoreNames.contains("changes"))return P.default("[IndexedDB] Missing object store. Resetting the database."),void x.clean(p,function(){x.open(p,_)});_(null,N.result)}}catch(N){P.default("[IndexedDB] Failed to open database: "+N),P.default("[IndexedDB] Resetting database and trying again."),clearTimeout(m),x.clean(p,function(){x.open(p,_)})}}static clean(p,_){const m=indexedDB.deleteDatabase(p);m.onsuccess=function(){P.default("[IndexedDB] Done removing DB"),_()},m.onerror=m.onabort=function(N){console.error('Failed to remove database "'+p+'"',N)}}static _rs_init(p){return new Promise((_,m)=>{x.open("remotestorage",function(N,M){N?m(N):(k=M,M.onerror=()=>{p._emit("error",N)},_())})})}static _rs_supported(){return new Promise((p,_)=>{const m=h.getGlobalContext();let N=!1;if(typeof navigator<"u"&&navigator.userAgent.match(/Android (2|3|4\.[0-3])/)&&(navigator.userAgent.match(/Chrome|Firefox/)||(N=!0)),"indexedDB"in m&&!N)try{const M=indexedDB.open("rs-check");M.onerror=function(){_()},M.onsuccess=function(){M.result.close(),indexedDB.deleteDatabase("rs-check"),p()}}catch{_()}else _()})}static _rs_cleanup(p){return new Promise(_=>{p.local&&p.local.closeDB(),x.clean("remotestorage",_)})}diffHandler(){}}h.applyMixins(x,[b.default]),i.exports=x}).call(this,d(5))},function(i,u,d){var l=this&&this.__importDefault||function(x){return x&&x.__esModule?x:{default:x}};const g=l(d(10)),y=l(d(2)),b=l(d(1)),A=d(0),P="remotestorage:cache:nodes:";function h(x){return x.substr(0,P.length)===P||x.substr(0,28)==="remotestorage:cache:changes:"}class k extends g.default{constructor(){super(),this.addEvents(["change","local-events-done"])}diffHandler(...w){}getNodes(w){const p={};for(let _=0,m=w.length;_<m;_++)try{p[w[_]]=JSON.parse(localStorage[P+w[_]])}catch{p[w[_]]=void 0}return Promise.resolve(p)}setNodes(w){for(const p in w)localStorage[P+p]=JSON.stringify(w[p]);return Promise.resolve()}forAllNodes(w){let p;for(let _=0,m=localStorage.length;_<m;_++)if(localStorage.key(_).substr(0,P.length)===P){try{p=this.migrate(JSON.parse(localStorage[localStorage.key(_)]))}catch{p=void 0}p&&w(p)}return Promise.resolve()}static _rs_init(){}static _rs_supported(){return A.localStorageAvailable()}static _rs_cleanup(){const w=[];for(let p=0,_=localStorage.length;p<_;p++){const m=localStorage.key(p);h(m)&&w.push(m)}w.forEach(p=>{b.default("[LocalStorage] Removing",p),delete localStorage[p]})}}A.applyMixins(k,[y.default]),i.exports=k},function(i,u,d){var l=this&&this.__importDefault||function(P){return P&&P.__esModule?P:{default:P}};const g=l(d(2)),y=l(d(10)),b=d(0);class A extends y.default{constructor(){super(),this._storage={},this.addEvents(["change","local-events-done"])}getNodes(h){const k={};for(let x=0,w=h.length;x<w;x++)k[h[x]]=this._storage[h[x]];return Promise.resolve(k)}setNodes(h){for(const k in h)h[k]===void 0?delete this._storage[k]:this._storage[k]=h[k];return Promise.resolve()}forAllNodes(h){for(const k in this._storage)h(this.migrate(this._storage[k]));return Promise.resolve()}diffHandler(){}static _rs_init(){}static _rs_supported(){return!0}static _rs_cleanup(){}}b.applyMixins(A,[g.default]),i.exports=A}])})})(xe);const Sr=Ar(xe.exports),Wt=new Sr;Wt.setApiKeys({dropbox:Pr,googledrive:xr});const oe=be([]),Rr=oe;typeof window<"u"&&(window.createNotification=kr);function kr(E,t="error",i=5e3){const u=Er();return oe.update(d=>[...d,{id:u,message:E,type:t}]),setTimeout(()=>Te(u),i),u}function Te(E){oe.update(t=>{const i=t.findIndex(u=>u.id===E);return i===-1||(t=t.slice(),t.splice(i,1)),t})}const se=be(!1),Ir=Le(se,E=>E);Wt.addEventListener("sync-req-done",()=>{se.set(!0)});Wt.addEventListener("sync-done",()=>{se.set(!1)});function Or(E){let t;return{c(){t=ut("div"),this.h()},l(i){t=lt(i,"DIV",{id:!0}),st(t).forEach(X),this.h()},h(){K(t,"id",Ae)},m(i,u){pt(i,t,u)},p:Et,i:Et,o:Et,d(i){i&&X(t)}}}const Ae="remote-storage-widget";let Qt;function Mr(E,t,i){let{element:u=void 0}=t,{widget:d=void 0}=t;return Re(()=>{Be(()=>import("./widget-e39ea803.js").then(l=>l.w),[]).then(({default:l})=>{var y;Qt&&((y=Qt.rsWidget)==null||y.remove());const g=new l(Wt);g.attach(Ae),Qt=g,function b(){g.rsWidget?(i(1,d=g),i(0,u=g.rsWidget)):setTimeout(b,300)}()})}),E.$$set=l=>{"element"in l&&i(0,u=l.element),"widget"in l&&i(1,d=l.widget)},[u,d]}class Cr extends Pt{constructor(t){super(),xt(this,t,Mr,Or,Bt,{element:0,widget:1})}}function Nr(E){let t,i,u,d;return{c(){t=ut("div"),i=Rt("svg"),u=Rt("circle"),d=Rt("path"),this.h()},l(l){t=lt(l,"DIV",{class:!0});var g=st(t);i=kt(g,"svg",{class:!0,xmlns:!0,fill:!0,viewBox:!0});var y=st(i);u=kt(y,"circle",{class:!0,cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0}),st(u).forEach(X),d=kt(y,"path",{class:!0,fill:!0,d:!0}),st(d).forEach(X),y.forEach(X),g.forEach(X),this.h()},h(){K(u,"class","opacity-25"),K(u,"cx","12"),K(u,"cy","12"),K(u,"r","10"),K(u,"stroke","currentColor"),K(u,"stroke-width","4"),K(d,"class","opacity-75"),K(d,"fill","currentColor"),K(d,"d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"),K(i,"class","animate-spin text-black"),K(i,"xmlns","http://www.w3.org/2000/svg"),K(i,"fill","none"),K(i,"viewBox","0 0 24 24"),K(t,"class","w-8 h-8")},m(l,g){pt(l,t,g),et(t,i),et(i,u),et(i,d)},p:Et,i:Et,o:Et,d(l){l&&X(t)}}}class jr extends Pt{constructor(t){super(),xt(this,t,null,Nr,Ut,{})}}function ce(E){let t,i;return t=new jr({}),{c(){gt(t.$$.fragment)},l(u){yt(t.$$.fragment,u)},m(u,d){vt(t,u,d),i=!0},i(u){i||(ct(t.$$.fragment,u),i=!0)},o(u){ht(t.$$.fragment,u),i=!1},d(u){_t(t,u)}}}function Ur(E){let t,i,u,d,l=new Date().getFullYear()+"",g,y,b,A,P,h,k,x,w,p,_,m,N,M,$,C,e,c,a,S;e=new Cr({});let v=E[0]&&ce();return{c(){t=ut("div"),i=ut("div"),u=ut("div"),d=At("\xA9 "),g=At(l),y=Ot(),b=ut("a"),A=At("aicacia.github.io/journal"),P=Ot(),h=ut("div"),k=ut("a"),x=At("Source Code"),w=At(`
			|
			`),p=ut("a"),_=At("Privacy Policy"),m=At(`
			|
			`),N=ut("a"),M=At("Terms of Service"),$=Ot(),C=ut("div"),gt(e.$$.fragment),c=Ot(),a=ut("div"),v&&v.c(),this.h()},l(O){t=lt(O,"DIV",{class:!0});var q=st(t);i=lt(q,"DIV",{class:!0});var J=st(i);u=lt(J,"DIV",{class:!0});var B=st(u);d=St(B,"\xA9 "),g=St(B,l),y=Mt(B),b=lt(B,"A",{href:!0});var R=st(b);A=St(R,"aicacia.github.io/journal"),R.forEach(X),B.forEach(X),P=Mt(J),h=lt(J,"DIV",{class:!0});var F=st(h);k=lt(F,"A",{target:!0,href:!0});var n=st(k);x=St(n,"Source Code"),n.forEach(X),w=St(F,`
			|
			`),p=lt(F,"A",{target:!0,href:!0});var s=st(p);_=St(s,"Privacy Policy"),s.forEach(X),m=St(F,`
			|
			`),N=lt(F,"A",{target:!0,href:!0});var T=st(N);M=St(T,"Terms of Service"),T.forEach(X),F.forEach(X),J.forEach(X),$=Mt(q),C=lt(q,"DIV",{class:!0});var I=st(C);yt(e.$$.fragment,I),I.forEach(X),c=Mt(q),a=lt(q,"DIV",{class:!0});var D=st(a);v&&v.l(D),D.forEach(X),q.forEach(X),this.h()},h(){K(b,"href",Xt),K(u,"class","text-center text-xs mt-8"),K(k,"target","_blank"),K(k,"href","https://github.com/aicacia/journal"),K(p,"target","_blank"),K(p,"href",`${Xt}/privacy-policy`),K(N,"target","_blank"),K(N,"href",`${Xt}/terms-of-service`),K(h,"class","text-center text-xs my-2"),K(i,"class","absolute bottom-0 w-full"),K(C,"class","absolute left-0 bottom-0"),K(a,"class","absolute right-4 bottom-4"),K(t,"class","absolute bottom-0 w-full flex z-[1000]")},m(O,q){pt(O,t,q),et(t,i),et(i,u),et(u,d),et(u,g),et(u,y),et(u,b),et(b,A),et(i,P),et(i,h),et(h,k),et(k,x),et(h,w),et(h,p),et(p,_),et(h,m),et(h,N),et(N,M),et(t,$),et(t,C),vt(e,C,null),et(t,c),et(t,a),v&&v.m(a,null),S=!0},p(O,[q]){O[0]?v?q&1&&ct(v,1):(v=ce(),v.c(),ct(v,1),v.m(a,null)):v&&(te(),ht(v,1,1,()=>{v=null}),ee())},i(O){S||(ct(e.$$.fragment,O),ct(v),S=!0)},o(O){ht(e.$$.fragment,O),ht(v),S=!1},d(O){O&&X(t),_t(e),v&&v.d()}}}function Dr(E,t,i){let u;return _e(E,Ir,d=>i(0,u=d)),[u]}class Fr extends Pt{constructor(t){super(),xt(this,t,Dr,Ur,Bt,{})}}function Se(E){const t=E-1;return t*t*t+1}function he(E,{delay:t=0,duration:i=400,easing:u=Se,x:d=0,y:l=0,opacity:g=0}={}){const y=getComputedStyle(E),b=+y.opacity,A=y.transform==="none"?"":y.transform,P=b*(1-g);return{delay:t,duration:i,easing:u,css:(h,k)=>`
			transform: ${A} translate(${(1-h)*d}px, ${(1-h)*l}px);
			opacity: ${b-P*k}`}}function Lr(E,{from:t,to:i},u={}){const d=getComputedStyle(E),l=d.transform==="none"?"":d.transform,[g,y]=d.transformOrigin.split(" ").map(parseFloat),b=t.left+t.width*g/i.width-(i.left+g),A=t.top+t.height*y/i.height-(i.top+y),{delay:P=0,duration:h=x=>Math.sqrt(x)*120,easing:k=Se}=u;return{delay:P,duration:ke(h)?h(Math.sqrt(b*b+A*A)):h,easing:k,css:(x,w)=>{const p=w*b,_=w*A,m=x+w*t.width/i.width,N=x+w*t.height/i.height;return`transform: ${l} translate(${p}px, ${_}px) scale(${m}, ${N});`}}}function Br(E){let t;return{c(){t=Rt("path"),this.h()},l(i){t=kt(i,"path",{d:!0}),st(t).forEach(X),this.h()},h(){K(t,"d","M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z")},m(i,u){pt(i,t,u)},p:Et,d(i){i&&X(t)}}}function $r(E){let t,i;const u=[{viewBox:"0 0 24 24"},E[0]];let d={$$slots:{default:[Br]},$$scope:{ctx:E}};for(let l=0;l<u.length;l+=1)d=bt(d,u[l]);return t=new Vt({props:d}),{c(){gt(t.$$.fragment)},l(l){yt(t.$$.fragment,l)},m(l,g){vt(t,l,g),i=!0},p(l,[g]){const y=g&1?Jt(u,[u[0],Gt(l[0])]):{};g&2&&(y.$$scope={dirty:g,ctx:l}),t.$set(y)},i(l){i||(ct(t.$$.fragment,l),i=!0)},o(l){ht(t.$$.fragment,l),i=!1},d(l){_t(t,l)}}}function qr(E,t,i){return E.$$set=u=>{i(0,t=bt(bt({},t),Ct(u)))},t=Ct(t),[t]}class Jr extends Pt{constructor(t){super(),xt(this,t,qr,$r,Ut,{})}}function Gr(E){let t;return{c(){t=Rt("path"),this.h()},l(i){t=kt(i,"path",{d:!0}),st(t).forEach(X),this.h()},h(){K(t,"d","M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z")},m(i,u){pt(i,t,u)},p:Et,d(i){i&&X(t)}}}function Vr(E){let t,i;const u=[{viewBox:"0 0 24 24"},E[0]];let d={$$slots:{default:[Gr]},$$scope:{ctx:E}};for(let l=0;l<u.length;l+=1)d=bt(d,u[l]);return t=new Vt({props:d}),{c(){gt(t.$$.fragment)},l(l){yt(t.$$.fragment,l)},m(l,g){vt(t,l,g),i=!0},p(l,[g]){const y=g&1?Jt(u,[u[0],Gt(l[0])]):{};g&2&&(y.$$scope={dirty:g,ctx:l}),t.$set(y)},i(l){i||(ct(t.$$.fragment,l),i=!0)},o(l){ht(t.$$.fragment,l),i=!1},d(l){_t(t,l)}}}function Yr(E,t,i){return E.$$set=u=>{i(0,t=bt(bt({},t),Ct(u)))},t=Ct(t),[t]}class zr extends Pt{constructor(t){super(),xt(this,t,Yr,Vr,Ut,{})}}function Hr(E){let t;return{c(){t=Rt("path"),this.h()},l(i){t=kt(i,"path",{d:!0}),st(t).forEach(X),this.h()},h(){K(t,"d","M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z")},m(i,u){pt(i,t,u)},p:Et,d(i){i&&X(t)}}}function Wr(E){let t,i;const u=[{viewBox:"0 0 24 24"},E[0]];let d={$$slots:{default:[Hr]},$$scope:{ctx:E}};for(let l=0;l<u.length;l+=1)d=bt(d,u[l]);return t=new Vt({props:d}),{c(){gt(t.$$.fragment)},l(l){yt(t.$$.fragment,l)},m(l,g){vt(t,l,g),i=!0},p(l,[g]){const y=g&1?Jt(u,[u[0],Gt(l[0])]):{};g&2&&(y.$$scope={dirty:g,ctx:l}),t.$set(y)},i(l){i||(ct(t.$$.fragment,l),i=!0)},o(l){ht(t.$$.fragment,l),i=!1},d(l){_t(t,l)}}}function Kr(E,t,i){return E.$$set=u=>{i(0,t=bt(bt({},t),Ct(u)))},t=Ct(t),[t]}class Xr extends Pt{constructor(t){super(),xt(this,t,Kr,Wr,Ut,{})}}function Qr(E){let t;return{c(){t=Rt("path"),this.h()},l(i){t=kt(i,"path",{d:!0}),st(t).forEach(X),this.h()},h(){K(t,"d","M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z")},m(i,u){pt(i,t,u)},p:Et,d(i){i&&X(t)}}}function Zr(E){let t,i;const u=[{viewBox:"0 0 24 24"},E[0]];let d={$$slots:{default:[Qr]},$$scope:{ctx:E}};for(let l=0;l<u.length;l+=1)d=bt(d,u[l]);return t=new Vt({props:d}),{c(){gt(t.$$.fragment)},l(l){yt(t.$$.fragment,l)},m(l,g){vt(t,l,g),i=!0},p(l,[g]){const y=g&1?Jt(u,[u[0],Gt(l[0])]):{};g&2&&(y.$$scope={dirty:g,ctx:l}),t.$set(y)},i(l){i||(ct(t.$$.fragment,l),i=!0)},o(l){ht(t.$$.fragment,l),i=!1},d(l){_t(t,l)}}}function tn(E,t,i){return E.$$set=u=>{i(0,t=bt(bt({},t),Ct(u)))},t=Ct(t),[t]}class en extends Pt{constructor(t){super(),xt(this,t,tn,Zr,Ut,{})}}function rn(E){let t,i;return t=new en({}),{c(){gt(t.$$.fragment)},l(u){yt(t.$$.fragment,u)},m(u,d){vt(t,u,d),i=!0},i(u){i||(ct(t.$$.fragment,u),i=!0)},o(u){ht(t.$$.fragment,u),i=!1},d(u){_t(t,u)}}}function nn(E){let t,i;return t=new Xr({}),{c(){gt(t.$$.fragment)},l(u){yt(t.$$.fragment,u)},m(u,d){vt(t,u,d),i=!0},i(u){i||(ct(t.$$.fragment,u),i=!0)},o(u){ht(t.$$.fragment,u),i=!1},d(u){_t(t,u)}}}function on(E){let t,i;return t=new zr({}),{c(){gt(t.$$.fragment)},l(u){yt(t.$$.fragment,u)},m(u,d){vt(t,u,d),i=!0},i(u){i||(ct(t.$$.fragment,u),i=!0)},o(u){ht(t.$$.fragment,u),i=!1},d(u){_t(t,u)}}}function sn(E){let t,i;return t=new Jr({}),{c(){gt(t.$$.fragment)},l(u){yt(t.$$.fragment,u)},m(u,d){vt(t,u,d),i=!0},i(u){i||(ct(t.$$.fragment,u),i=!0)},o(u){ht(t.$$.fragment,u),i=!1},d(u){_t(t,u)}}}function an(E){let t,i,u,d,l,g,y=E[0].message+"",b,A,P,h;const k=[sn,on,nn,rn],x=[];function w(p,_){return p[0].type==="error"?0:p[0].type==="success"?1:p[0].type==="info"?2:p[0].type==="warning"?3:-1}return~(u=w(E))&&(d=x[u]=k[u](E)),{c(){t=ut("div"),i=ut("div"),d&&d.c(),l=Ot(),g=ut("div"),b=At(y),this.h()},l(p){t=lt(p,"DIV",{class:!0});var _=st(t);i=lt(_,"DIV",{class:!0});var m=st(i);d&&d.l(m),m.forEach(X),l=Mt(_),g=lt(_,"DIV",{class:!0});var N=st(g);b=St(N,y),N.forEach(X),_.forEach(X),this.h()},h(){K(i,"class","as-w-6 as-h-6 as-mr-2 as-text-white"),K(g,"class","as-text-white as-max-w-xs "),K(t,"class","as-flex as-items-center as-py-2 as-px-3 as-m-1 as-cursor-pointer as-shadow"),It(t,"as-bg-green-500",E[0].type==="success"),It(t,"as-bg-red-500",E[0].type==="error"),It(t,"as-bg-blue-500",E[0].type==="info"),It(t,"as-bg-yellow-500",E[0].type==="warning")},m(p,_){pt(p,t,_),et(t,i),~u&&x[u].m(i,null),et(t,l),et(t,g),et(g,b),A=!0,P||(h=Ie(t,"click",E[1]),P=!0)},p(p,[_]){let m=u;u=w(p),u!==m&&(d&&(te(),ht(x[m],1,1,()=>{x[m]=null}),ee()),~u?(d=x[u],d||(d=x[u]=k[u](p),d.c()),ct(d,1),d.m(i,null)):d=null),(!A||_&1)&&y!==(y=p[0].message+"")&&ve(b,y),_&1&&It(t,"as-bg-green-500",p[0].type==="success"),_&1&&It(t,"as-bg-red-500",p[0].type==="error"),_&1&&It(t,"as-bg-blue-500",p[0].type==="info"),_&1&&It(t,"as-bg-yellow-500",p[0].type==="warning")},i(p){A||(ct(d),A=!0)},o(p){ht(d),A=!1},d(p){p&&X(t),~u&&x[u].d(),P=!1,h()}}}function un(E,t,i){let{notification:u}=t;function d(){Te(u.id)}return E.$$set=l=>{"notification"in l&&i(0,u=l.notification)},[u,d]}class ln extends Pt{constructor(t){super(),xt(this,t,un,an,Bt,{notification:0})}}function fe(E,t,i){const u=E.slice();return u[1]=t[i],u}function de(E,t){let i,u,d,l,g,y,b=Et,A;return u=new ln({props:{notification:t[1]}}),{key:E,first:null,c(){i=ut("div"),gt(u.$$.fragment),d=Ot(),this.h()},l(P){i=lt(P,"DIV",{class:!0});var h=st(i);yt(u.$$.fragment,h),d=Mt(h),h.forEach(X),this.h()},h(){K(i,"class","as-w-full"),this.first=i},m(P,h){pt(P,i,h),vt(u,i,null),et(i,d),A=!0},p(P,h){t=P;const k={};h&1&&(k.notification=t[1]),u.$set(k)},r(){y=i.getBoundingClientRect()},f(){Me(i),b(),Ce(i,y)},a(){b(),b=Ne(i,y,Lr,{})},i(P){A||(ct(u.$$.fragment,P),je(()=>{g&&g.end(1),l=Ue(i,he,{y:-64,duration:300}),l.start()}),A=!0)},o(P){ht(u.$$.fragment,P),l&&l.invalidate(),g=De(i,he,{y:-64,duration:300}),A=!1},d(P){P&&X(i),_t(u),P&&g&&g.end()}}}function cn(E){let t,i,u=[],d=new Map,l,g=E[0];const y=b=>b[1].id;for(let b=0;b<g.length;b+=1){let A=fe(E,g,b),P=y(A);d.set(P,u[b]=de(P,A))}return{c(){t=ut("div"),i=ut("div");for(let b=0;b<u.length;b+=1)u[b].c();this.h()},l(b){t=lt(b,"DIV",{class:!0});var A=st(t);i=lt(A,"DIV",{class:!0});var P=st(i);for(let h=0;h<u.length;h+=1)u[h].l(P);P.forEach(X),A.forEach(X),this.h()},h(){K(i,"class","as-container as-mx-auto"),K(t,"class","as-fixed as-top-0 as-left-0 z-20 as-w-full")},m(b,A){pt(b,t,A),et(t,i);for(let P=0;P<u.length;P+=1)u[P].m(i,null);l=!0},p(b,[A]){if(A&1){g=b[0],te();for(let P=0;P<u.length;P+=1)u[P].r();u=Oe(u,A,y,1,b,g,d,i,Fe,de,null,fe);for(let P=0;P<u.length;P+=1)u[P].a();ee()}},i(b){if(!l){for(let A=0;A<g.length;A+=1)ct(u[A]);l=!0}},o(b){for(let A=0;A<u.length;A+=1)ht(u[A]);l=!1},d(b){b&&X(t);for(let A=0;A<u.length;A+=1)u[A].d()}}}function hn(E,t,i){let u;return _e(E,Rr,d=>i(0,u=d)),[u]}class fn extends Pt{constructor(t){super(),xt(this,t,hn,cn,Bt,{})}}function dn(E){let t,i,u,d,l,g,y,b;const A=E[1].default,P=pe(A,E,E[0],null);return l=new Fr({}),y=new fn({}),{c(){t=ut("div"),i=ut("div"),u=ut("div"),P&&P.c(),d=Ot(),gt(l.$$.fragment),g=Ot(),gt(y.$$.fragment),this.h()},l(h){t=lt(h,"DIV",{class:!0});var k=st(t);i=lt(k,"DIV",{class:!0});var x=st(i);u=lt(x,"DIV",{class:!0});var w=st(u);P&&P.l(w),w.forEach(X),x.forEach(X),k.forEach(X),d=Mt(h),yt(l.$$.fragment,h),g=Mt(h),yt(y.$$.fragment,h),this.h()},h(){K(u,"class","flex flex-col w-full h-full overflow-hidden"),K(i,"class","flex flex-col w-full h-full"),K(t,"class","relative flex w-full h-full")},m(h,k){pt(h,t,k),et(t,i),et(i,u),P&&P.m(u,null),pt(h,d,k),vt(l,h,k),pt(h,g,k),vt(y,h,k),b=!0},p(h,[k]){P&&P.p&&(!b||k&1)&&me(P,A,h,h[0],b?ye(A,h[0],k,null):ge(h[0]),null)},i(h){b||(ct(P,h),ct(l.$$.fragment,h),ct(y.$$.fragment,h),b=!0)},o(h){ht(P,h),ht(l.$$.fragment,h),ht(y.$$.fragment,h),b=!1},d(h){h&&X(t),P&&P.d(h),h&&X(d),_t(l,h),h&&X(g),_t(y,h)}}}function pn(E,t,i){let{$$slots:u={},$$scope:d}=t;return E.$$set=l=>{"$$scope"in l&&i(0,d=l.$$scope)},[d,u]}class Sn extends Pt{constructor(t){super(),xt(this,t,pn,dn,Bt,{})}}export{Vt as I,Sn as L,_n as a,yn as b,Er as c,Tr as d,xn as e,Tn as f,bn as g,kr as h,rt as i,wn as j,En as k,Ir as l,Pn as m,vn as n,Wt as r,An as s};
