import{S as W,i as q,N as Z,l as V,m as I,n as O,h,p as B,b as P,E,o as F,O as j,W as G,P as C,w as z,a as H,x as L,c as Q,M as U,y as M,V as K,Q as A,f as w,t as k,B as D,U as T,s as X,e as R,g as Y,d as v,r as $,u as tt}from"../chunks/index-8e1ea7fc.js";import{C as et,U as nt,c as ot,j as rt,s as at,r as it}from"../chunks/remoteStorageState-59ce5716.js";import{_ as st,b as lt}from"../chunks/preload-helper-b6d3926a.js";import{s as ut,L as ct}from"../chunks/Layout-6f72e75c.js";function ft(r){let e;return{c(){e=V("div"),this.h()},l(t){e=I(t,"DIV",{class:!0}),O(e).forEach(h),this.h()},h(){B(e,"class","w-full h-full")},m(t,n){P(t,e,n),r[11](e)},p:E,i:E,o:E,d(t){t&&h(e),r[11](null)}}}function dt(r,e,t){let{latitude:n=39}=e,{longitude:a=-98}=e,{altitude:s=void 0}=e,{zoom:f=13}=e,{map:c=void 0}=e,{entries:l=[]}=e,u,d,_,p=n,b=a;F(async()=>{t(7,u=await st(()=>import("../chunks/leaflet-src-eb3fcef6.js").then(g=>g.l),["internal/immutable/chunks/leaflet-src-eb3fcef6.js","internal/immutable/chunks/Layout-6f72e75c.js","internal/immutable/assets/Layout-6bf551a2.css","internal/immutable/chunks/index-8e1ea7fc.js","internal/immutable/chunks/preload-helper-b6d3926a.js"]));const o=t(3,c=u.map(_,{zoomControl:!1}).setView([n,a],f));u.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:"\xA9 OpenStreetMap"}).addTo(o),o.addEventListener("moveend",()=>{const g=o.getCenter();t(1,n=t(9,p=g.lat)),t(2,a=t(10,b=g.lng)),t(4,s=g.alt)}),t(8,d=u.icon({iconUrl:`${lt}/icon.png`,iconSize:[48,48],iconAnchor:[24,24],popupAnchor:[0,0]}))});function S(o){j[o?"unshift":"push"](()=>{_=o,t(0,_)})}return r.$$set=o=>{"latitude"in o&&t(1,n=o.latitude),"longitude"in o&&t(2,a=o.longitude),"altitude"in o&&t(4,s=o.altitude),"zoom"in o&&t(5,f=o.zoom),"map"in o&&t(3,c=o.map),"entries"in o&&t(6,l=o.entries)},r.$$.update=()=>{r.$$.dirty&1582&&(c&&p!==n||b!==a)&&(c==null||c.setView([n,a],f)),r.$$.dirty&456&&d&&c&&l.forEach(o=>{o.geolocation&&u.marker([o.geolocation.latitude,o.geolocation.longitude],{icon:d}).addTo(c).bindPopup(o.createdAt.toLocaleDateString())})},[_,n,a,c,s,f,l,u,d,p,b,S]}class mt extends W{constructor(e){super(),q(this,e,dt,ft,Z,{latitude:1,longitude:2,altitude:4,zoom:5,map:3,entries:6})}}function _t(r){let e,t,n,a,s,f,c,l,u,d,_,p,b;G(r[8]),n=new et({});function S(i){r[9](i)}function o(i){r[10](i)}let g={entries:r[0]};r[3]!==void 0&&(g.latitude=r[3]),r[4]!==void 0&&(g.longitude=r[4]),s=new mt({props:g}),j.push(()=>C(s,"latitude",S)),j.push(()=>C(s,"longitude",o));function x(i){r[11](i)}let J={journalEntry:r[5]};return r[1]!==void 0&&(J.open=r[1]),u=new nt({props:J}),j.push(()=>C(u,"open",x)),{c(){e=V("div"),t=V("div"),z(n.$$.fragment),a=H(),z(s.$$.fragment),l=H(),z(u.$$.fragment),this.h()},l(i){e=I(i,"DIV",{class:!0});var m=O(e);t=I(m,"DIV",{class:!0});var y=O(t);L(n.$$.fragment,y),y.forEach(h),a=Q(m),L(s.$$.fragment,m),m.forEach(h),l=Q(i),L(u.$$.fragment,i),this.h()},h(){B(t,"class","absolute top-0 left-0 w-full z-[1000]"),B(e,"class","flex flex-col flex-grow")},m(i,m){P(i,e,m),U(e,t),M(n,t,null),U(e,a),M(s,e,null),P(i,l,m),M(u,i,m),_=!0,p||(b=K(window,"resize",r[8]),p=!0)},p(i,[m]){const y={};m&1&&(y.entries=i[0]),!f&&m&8&&(f=!0,y.latitude=i[3],A(()=>f=!1)),!c&&m&16&&(c=!0,y.longitude=i[4],A(()=>c=!1)),s.$set(y);const N={};!d&&m&2&&(d=!0,N.open=i[1],A(()=>d=!1)),u.$set(N)},i(i){_||(w(n.$$.fragment,i),w(s.$$.fragment,i),w(u.$$.fragment,i),_=!0)},o(i){k(n.$$.fragment,i),k(s.$$.fragment,i),k(u.$$.fragment,i),_=!1},d(i){i&&h(e),D(n),D(s),i&&h(l),D(u,i),p=!1,b()}}}function gt(r,e,t){let n,a,s;T(r,ot,o=>t(6,a=o)),T(r,rt,o=>t(7,s=o));let f,c=!1,l=1024,u=39,d=-98;function _(){t(2,l=window.innerWidth)}function p(o){u=o,t(3,u),t(0,n),t(7,s),t(6,a)}function b(o){d=o,t(4,d),t(0,n),t(7,s),t(6,a)}function S(o){c=o,t(1,c)}return r.$$.update=()=>{if(r.$$.dirty&192&&t(0,n=Object.values(s[a.toISOString().substring(0,7)]||{}).flat(1)),r.$$.dirty&1&&n.length){const o=n.sort(ut).find(g=>g.geolocation);o!=null&&o.geolocation&&(t(3,u=o.geolocation.latitude),t(4,d=o.geolocation.longitude))}r.$$.dirty&64&&at(a)},[n,c,l,u,d,f,a,s,_,p,b,S]}class pt extends W{constructor(e){super(),q(this,e,gt,_t,Z,{})}}function ht(r){let e,t;return{c(){e=V("h3"),t=$("Please connect to a Storage Provider"),this.h()},l(n){e=I(n,"H3",{class:!0});var a=O(e);t=tt(a,"Please connect to a Storage Provider"),a.forEach(h),this.h()},h(){B(e,"class","text-center py-8 text-lg")},m(n,a){P(n,e,a),U(e,t)},i:E,o:E,d(n){n&&h(e)}}}function bt(r){let e,t;return e=new pt({}),{c(){z(e.$$.fragment)},l(n){L(e.$$.fragment,n)},m(n,a){M(e,n,a),t=!0},i(n){t||(w(e.$$.fragment,n),t=!0)},o(n){k(e.$$.fragment,n),t=!1},d(n){D(e,n)}}}function yt(r){let e,t,n,a;const s=[bt,ht],f=[];function c(l,u){return l[0].storage==="connected"?0:1}return e=c(r),t=f[e]=s[e](r),{c(){t.c(),n=R()},l(l){t.l(l),n=R()},m(l,u){f[e].m(l,u),P(l,n,u),a=!0},p(l,u){let d=e;e=c(l),e!==d&&(Y(),k(f[d],1,1,()=>{f[d]=null}),v(),t=f[e],t||(t=f[e]=s[e](l),t.c()),w(t,1),t.m(n.parentNode,n))},i(l){a||(w(t),a=!0)},o(l){k(t),a=!1},d(l){f[e].d(l),l&&h(n)}}}function wt(r){let e,t;return e=new ct({props:{$$slots:{default:[yt]},$$scope:{ctx:r}}}),{c(){z(e.$$.fragment)},l(n){L(e.$$.fragment,n)},m(n,a){M(e,n,a),t=!0},p(n,[a]){const s={};a&3&&(s.$$scope={dirty:a,ctx:n}),e.$set(s)},i(n){t||(w(e.$$.fragment,n),t=!0)},o(n){k(e.$$.fragment,n),t=!1},d(n){D(e,n)}}}function kt(r,e,t){let n;return T(r,it,a=>t(0,n=a)),[n]}class Mt extends W{constructor(e){super(),q(this,e,kt,wt,X,{})}}export{Mt as default};
