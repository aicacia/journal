import{S as W,i as q,N as Z,l as V,m as I,n as O,h,p as B,b as P,E,o as F,O as j,W as G,P as C,w as z,a as H,x as L,c as Q,M as U,y as M,V as K,Q as A,f as w,t as k,B as D,U as T,s as X,e as R,g as Y,d as v,r as $,u as tt}from"../chunks/index-8e1ea7fc.js";import{C as et,U as nt,c as ot,j as rt,s as it,r as at}from"../chunks/remoteStorageState-59ce5716.js";import{_ as lt}from"../chunks/preload-helper-b6d3926a.js";import{s as st,L as ut}from"../chunks/Layout-6f72e75c.js";function ct(r){let e;return{c(){e=V("div"),this.h()},l(t){e=I(t,"DIV",{class:!0}),O(e).forEach(h),this.h()},h(){B(e,"class","w-full h-full")},m(t,n){P(t,e,n),r[11](e)},p:E,i:E,o:E,d(t){t&&h(e),r[11](null)}}}function ft(r,e,t){let{latitude:n=39}=e,{longitude:i=-98}=e,{altitude:l=void 0}=e,{zoom:f=13}=e,{map:c=void 0}=e,{entries:s=[]}=e,u,d,_,p=n,b=i;F(async()=>{t(7,u=await lt(()=>import("../chunks/leaflet-src-eb3fcef6.js").then(g=>g.l),["internal/immutable/chunks/leaflet-src-eb3fcef6.js","internal/immutable/chunks/Layout-6f72e75c.js","internal/immutable/assets/Layout-6bf551a2.css","internal/immutable/chunks/index-8e1ea7fc.js","internal/immutable/chunks/preload-helper-b6d3926a.js"]));const o=t(3,c=u.map(_,{zoomControl:!1}).setView([n,i],f));u.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:"\xA9 OpenStreetMap"}).addTo(o),o.addEventListener("moveend",()=>{const g=o.getCenter();t(1,n=t(9,p=g.lat)),t(2,i=t(10,b=g.lng)),t(4,l=g.alt)}),t(8,d=u.icon({iconUrl:"/icon.png",iconSize:[48,48],iconAnchor:[24,24],popupAnchor:[0,0]}))});function S(o){j[o?"unshift":"push"](()=>{_=o,t(0,_)})}return r.$$set=o=>{"latitude"in o&&t(1,n=o.latitude),"longitude"in o&&t(2,i=o.longitude),"altitude"in o&&t(4,l=o.altitude),"zoom"in o&&t(5,f=o.zoom),"map"in o&&t(3,c=o.map),"entries"in o&&t(6,s=o.entries)},r.$$.update=()=>{r.$$.dirty&1582&&(c&&p!==n||b!==i)&&(c==null||c.setView([n,i],f)),r.$$.dirty&456&&d&&c&&s.forEach(o=>{o.geolocation&&u.marker([o.geolocation.latitude,o.geolocation.longitude],{icon:d}).addTo(c).bindPopup(o.createdAt.toLocaleDateString())})},[_,n,i,c,l,f,s,u,d,p,b,S]}class dt extends W{constructor(e){super(),q(this,e,ft,ct,Z,{latitude:1,longitude:2,altitude:4,zoom:5,map:3,entries:6})}}function mt(r){let e,t,n,i,l,f,c,s,u,d,_,p,b;G(r[8]),n=new et({});function S(a){r[9](a)}function o(a){r[10](a)}let g={entries:r[0]};r[3]!==void 0&&(g.latitude=r[3]),r[4]!==void 0&&(g.longitude=r[4]),l=new dt({props:g}),j.push(()=>C(l,"latitude",S)),j.push(()=>C(l,"longitude",o));function x(a){r[11](a)}let J={journalEntry:r[5]};return r[1]!==void 0&&(J.open=r[1]),u=new nt({props:J}),j.push(()=>C(u,"open",x)),{c(){e=V("div"),t=V("div"),z(n.$$.fragment),i=H(),z(l.$$.fragment),s=H(),z(u.$$.fragment),this.h()},l(a){e=I(a,"DIV",{class:!0});var m=O(e);t=I(m,"DIV",{class:!0});var y=O(t);L(n.$$.fragment,y),y.forEach(h),i=Q(m),L(l.$$.fragment,m),m.forEach(h),s=Q(a),L(u.$$.fragment,a),this.h()},h(){B(t,"class","absolute top-0 left-0 w-full z-[1000]"),B(e,"class","flex flex-col flex-grow")},m(a,m){P(a,e,m),U(e,t),M(n,t,null),U(e,i),M(l,e,null),P(a,s,m),M(u,a,m),_=!0,p||(b=K(window,"resize",r[8]),p=!0)},p(a,[m]){const y={};m&1&&(y.entries=a[0]),!f&&m&8&&(f=!0,y.latitude=a[3],A(()=>f=!1)),!c&&m&16&&(c=!0,y.longitude=a[4],A(()=>c=!1)),l.$set(y);const N={};!d&&m&2&&(d=!0,N.open=a[1],A(()=>d=!1)),u.$set(N)},i(a){_||(w(n.$$.fragment,a),w(l.$$.fragment,a),w(u.$$.fragment,a),_=!0)},o(a){k(n.$$.fragment,a),k(l.$$.fragment,a),k(u.$$.fragment,a),_=!1},d(a){a&&h(e),D(n),D(l),a&&h(s),D(u,a),p=!1,b()}}}function _t(r,e,t){let n,i,l;T(r,ot,o=>t(6,i=o)),T(r,rt,o=>t(7,l=o));let f,c=!1,s=1024,u=39,d=-98;function _(){t(2,s=window.innerWidth)}function p(o){u=o,t(3,u),t(0,n),t(7,l),t(6,i)}function b(o){d=o,t(4,d),t(0,n),t(7,l),t(6,i)}function S(o){c=o,t(1,c)}return r.$$.update=()=>{if(r.$$.dirty&192&&t(0,n=Object.values(l[i.toISOString().substring(0,7)]||{}).flat(1)),r.$$.dirty&1&&n.length){const o=n.sort(st).find(g=>g.geolocation);o!=null&&o.geolocation&&(t(3,u=o.geolocation.latitude),t(4,d=o.geolocation.longitude))}r.$$.dirty&64&&it(i)},[n,c,s,u,d,f,i,l,_,p,b,S]}class gt extends W{constructor(e){super(),q(this,e,_t,mt,Z,{})}}function pt(r){let e,t;return{c(){e=V("h3"),t=$("Please connect to a Storage Provider"),this.h()},l(n){e=I(n,"H3",{class:!0});var i=O(e);t=tt(i,"Please connect to a Storage Provider"),i.forEach(h),this.h()},h(){B(e,"class","text-center py-8 text-lg")},m(n,i){P(n,e,i),U(e,t)},i:E,o:E,d(n){n&&h(e)}}}function ht(r){let e,t;return e=new gt({}),{c(){z(e.$$.fragment)},l(n){L(e.$$.fragment,n)},m(n,i){M(e,n,i),t=!0},i(n){t||(w(e.$$.fragment,n),t=!0)},o(n){k(e.$$.fragment,n),t=!1},d(n){D(e,n)}}}function bt(r){let e,t,n,i;const l=[ht,pt],f=[];function c(s,u){return s[0].storage==="connected"?0:1}return e=c(r),t=f[e]=l[e](r),{c(){t.c(),n=R()},l(s){t.l(s),n=R()},m(s,u){f[e].m(s,u),P(s,n,u),i=!0},p(s,u){let d=e;e=c(s),e!==d&&(Y(),k(f[d],1,1,()=>{f[d]=null}),v(),t=f[e],t||(t=f[e]=l[e](s),t.c()),w(t,1),t.m(n.parentNode,n))},i(s){i||(w(t),i=!0)},o(s){k(t),i=!1},d(s){f[e].d(s),s&&h(n)}}}function yt(r){let e,t;return e=new ut({props:{$$slots:{default:[bt]},$$scope:{ctx:r}}}),{c(){z(e.$$.fragment)},l(n){L(e.$$.fragment,n)},m(n,i){M(e,n,i),t=!0},p(n,[i]){const l={};i&3&&(l.$$scope={dirty:i,ctx:n}),e.$set(l)},i(n){t||(w(e.$$.fragment,n),t=!0)},o(n){k(e.$$.fragment,n),t=!1},d(n){D(e,n)}}}function wt(r,e,t){let n;return T(r,at,i=>t(0,n=i)),[n]}class Lt extends W{constructor(e){super(),q(this,e,wt,yt,X,{})}}export{Lt as default};
